var map,tlpoint,brpoint,drawnItems,geojsonLayer,activeFigure,imageHeight,imageWidth,resetMap=function(){map.fitBounds(new L.LatLngBounds(tlpoint,brpoint))},zoomToGlobal=function(g){window.appModel.zoomTo(g)},highlightMapGlobal=function(g){window.appModel.highlightMap(g)},moveItemUpGlobal=function(g){window.appModel.moveItemUp(g)},moveItemDownGlobal=function(g){window.appModel.moveItemDown(g)},clearHighLightsGlobal=function(){geojsonLayer.clearLayers()},deleteViewAtIndexGlobal=function(g){window.appModel.deleteViewAtIndex(g)};
$(window).resize(function(){$("#map").height(window.innerHeight-100);$("#viewContainer").height(window.innerHeight-540)});
var loadMapFromFigureObject=function(g){L.TileLayer.Common=L.TileLayer.extend({initialize:function(a){L.TileLayer.prototype.initialize.call(this,this.url,a)}});L.Projection.NoWrap={project:function(a){return new L.Point(a.lng,a.lat)},unproject:function(a){return new L.LatLng(a.y,a.x,!0)}};L.CRS.Direct=L.Util.extend({},L.CRS,{code:"Direct",projection:L.Projection.NoWrap,transformation:new L.Transformation(1,0,1,0)});var b,h;b=g.get("imagePropertiesLocation");h=g.get("tileLocation");$.ajax({type:"GET",
url:b,dataType:"xml",success:function(a){$imgxml=$(a).find("IMAGE_PROPERTIES");var a=$imgxml.attr("HEIGHT"),c=$imgxml.attr("WIDTH");imageHeight=a;imageWidth=c;var b=Math.ceil(Math.log(Math.max(c,a)/256)/Math.log(2));$("#map").height(window.innerHeight-100);$("#viewContainer").height(window.innerHeight-540);map=new L.Map("map",{crs:L.CRS.Direct,center:new L.LatLng(0,0),zoom:b,minZoom:1,worldCopyJump:!1,attributionControl:!1});$("#activityView").hide().ajaxStart(function(){$(this).show()}).ajaxStop(function(){$(this).hide()});
var e=new L.Control.FullScreen;map.addControl(e);e=L.Control.extend({options:{position:"topright"},_createButton:function(a,c,b,d,e){c=L.DomUtil.create("a",c,b);c.href="#";c.title=a;L.DomEvent.addListener(c,"click",L.DomEvent.stopPropagation).addListener(c,"click",L.DomEvent.preventDefault).addListener(c,"click",d,e);return c},onAdd:function(){var a=L.DomUtil.create("div","leaflet-control-draw");this._createButton("reset zoom","leaflet-control-draw-zoom",a,resetMap,window);return a}});map.addControl(new e);
e=new L.Control.Draw({position:"topleft",rectangle:{shapeOptions:{color:"#0099ff",opacity:0.5,weight:2,fillColor:"#0099ff",fillOpacity:0.2,dashArray:"5, 5"}},polyline:!1,circle:!1,polygon:!1,marker:!1});map.addControl(e);map.setView(map.layerPointToLatLng(new L.Point($("#map").width(),$("#map").height())),b,!0);L.TileLayer.FigureZero=L.TileLayer.Common.extend({url:h+"TileGroup0/{z}-{x}-{y}.jpg",options:{noWrap:!0,maxZoom:b}});b=new L.TileLayer.FigureZero;map.addLayer(b);tlpoint=map.layerPointToLatLng(new L.Point(0,
a));tlpoint.lat*=0.1;brpoint=map.layerPointToLatLng(new L.Point(c,0));brpoint.lng*=0.1;map.fitBounds(new L.LatLngBounds(tlpoint,brpoint));drawnItems=new L.LayerGroup;map.on("draw:rectangle-created",function(a){drawnItems.clearLayers();drawnItems.addLayer(a.rect)});map.addLayer(drawnItems);window.appModel.addAllView()}})},layerToGeometry=function(g){var b,h=[];if(L.Marker&&g instanceof L.Marker)return b="Point",g=LatLngToCoords(g._latlng),{type:b,coordinates:g};if(L.Polygon&&g instanceof L.Polygon)return b=
"Polygon",h=LatLngsToCoords(g._latlngs,1),{type:b,coordinates:[h]};if(L.Polyline&&g instanceof L.Polyline)return b="LineString",h=LatLngsToCoords(g._latlngs),{type:b,coordinates:h}},LatLngToCoords=function(g,b){var h=parseFloat(b?g.lng:g.lat);return[parseFloat(b?g.lat:g.lng),h]},LatLngsToCoords=function(g,b,h){var a,c=[],d,e;d=0;for(e=g.length;d<e;d++)a=b?LatLngToCoords(g[d],b-1,h):LatLngToCoords(g[d],h),c.push(a);return c};
function onEachRectFeature(g){g.properties&&g.properties.title&&(new L.LatLng(g.geometry.coordinates[0][3][1],g.geometry.coordinates[0][3][0]),new L.LatLng(g.geometry.coordinates[0][1][1],g.geometry.coordinates[0][1][0]))}
$(function(){Parse.$=jQuery;Parse.initialize("nY5yXtyaq5zJ1TnCfGOBDa6vu9IX9WwhDJTxx6eu","2HnPlp2kBNpS66dsPdVHRlec1b8BVzKnbZc5XknC");var g=Parse.Object.extend("UploadObject",{initialize:function(){},toggle:function(){}});Parse.Collection.extend({model:g});var b=Parse.Object.extend("AppState",{defaults:{filter:"all"}}),h=Parse.View.extend({tagName:"div",template:_.template($("#view-template").html()),events:{},initialize:function(){_.bindAll(this,"render")},render:function(){$(this.el).html(this.template(this.model));
return this}}),a=Parse.View.extend({events:{"click #logoutButton":"logOut","click #resetviewbutton":"reloadImageView","click #save-model-button":"saveModelButtonClick","click #save-next-button":"nextViewButton","click #add-view-button":"saveCurrentView","click #reload-model-button":"reloadActiveFigure"},el:".content",initialize:function(){var a=this;_.bindAll(this,"render","logOut","moveItemUp","moveItemDown","reloadImageView","reloadActiveFigure","deleteViewAtIndex","zoomTo","highlightMap","saveCurrentView",
"addAllView","saveModelButtonClick","nextViewButton");this.$el.html(_.template($("#manage-todos-template").html()));this.activeFigureID=$("#parseID").html();this.query=new Parse.Query(g);this.query.get(this.activeFigureID,{success:function(c){activeFigure=$.extend(!0,{},c);7<=c.toJSON().stat&&(loadMapFromFigureObject(c),a.addAllView())},error:function(a,c){alert("figure not available - it may not be public");console.log(c)}})},reloadActiveFigure:function(){var a=this;this.query.get(this.activeFigureID,
{success:function(c){activeFigure=$.extend(!0,{},c);7<=c.toJSON().stat&&a.addAllView()},error:function(){window.location="/library"}})},zoomTo:function(a){var c=activeFigure.get("viewArray")[a],a=new L.LatLng(c.geometry.coordinates[1][3][1],c.geometry.coordinates[1][3][0]),c=new L.LatLng(c.geometry.coordinates[1][1][1],c.geometry.coordinates[1][1][0]);map.fitBounds(new L.LatLngBounds(a,c))},highlightMap:function(a){geojsonLayer=L.geoJson(activeFigure.get("viewArray")[a],{style:{color:"#000000",weight:2,
opacity:0.8,fillColor:"#000000",fillOpacity:0.75},onEachFeature:onEachRectFeature}).addTo(map)},moveItemUp:function(a){0<a&&(activeFigure.get("viewArray")[a-1]=activeFigure.get("viewArray").splice(a,1,activeFigure.get("viewArray")[a-1])[0],geojsonLayer.clearLayers(),this.addAllView(),$("#save-model-button").removeClass("disabled"))},moveItemDown:function(a){a<activeFigure.get("viewArray").length-1&&(activeFigure.get("viewArray")[a]=activeFigure.get("viewArray").splice(a+1,1,activeFigure.get("viewArray")[a])[0],
geojsonLayer.clearLayers(),this.addAllView(),$("#save-model-button").removeClass("disabled"))},deleteViewAtIndex:function(a){!0==confirm("Confirm delete of ROI #"+a)&&(activeFigure.get("viewArray").splice(a,1),geojsonLayer.clearLayers(),activeFigure.save({success:function(){console.log("save successful");$("#save-model-button").addClass("disabled")},error:function(){}}),this.addAllView())},nextViewButton:function(){},saveModelButtonClick:function(){$("#save-model-button").hasClass("disabled")||($("#activityView").show(),
activeFigure.save({success:function(){$("#activityView").fadeOut(500);$("#save-model-button").addClass("disabled")},error:function(){$("#activityView").fadeOut(500)}}))},saveCurrentView:function(){var a=this,c=this.$("#view-title").val(),b=this.$("#view-description").val(),d={};0<c.length?(drawnItems.eachLayer(function(e){var i=new L.LatLngBounds(brpoint,tlpoint),h=[];h.push([i._southWest.lat,i._southWest.lng]);h.push([i._southWest.lat,i._northEast.lat]);h.push([i._northEast.lng,i._northEast.lat]);
h.push([i._northEast.lng,i._southWest.lng]);h.push([i._southWest.lat,i._southWest.lng]);d.geometry=layerToGeometry(e);d.geometry.coordinates.unshift(h);var i=tlpoint.lat-brpoint.lat,g=brpoint.lng-tlpoint.lng,h=d.geometry.coordinates[1][0],t=d.geometry.coordinates[1][2],e=imageWidth*((t[0]-h[0])/g),t=imageHeight*((t[1]-h[1])/i),g=imageWidth*h[0]/g;g>imageWidth?g=imageWidth:0>g&&(g=0);i=imageHeight*h[1]/i;i>imageHeight?i=imageHeight:0>i&&(i=0);var u=[g,i,e,t];cutDict={ipxml:activeFigure.get("imagePropertiesLocation"),
path:activeFigure.get("localPath"),origin:[g,i],size:[e,t],output:[512,512]};$.ajax({type:"POST",url:"/cut/",data:JSON.stringify(cutDict),contentType:"application/json; charset=utf-8",dataType:"json",success:function(e){propertyDict={title:c,description:b,nativeCoords:u,thumburl:e.thumburl,viewurl:e.viewurl,qrURL:e.qrURL,bitlyurl:e.bitlyurl};d.properties=propertyDict;d.type="Feature";activeFigure.get("viewArray").push(d);activeFigure.save({success:function(){console.log("save successful");a.addAllView()},
error:function(){console.log("error saving figure object, verify connectivity")}})},failure:function(a){console.log(a);alert("Something went wrong on our end. Please try again. ")}})}),drawnItems.clearLayers(),this.$("#view-title").val(""),this.$("#view-description").val("")):a.$("#saveViewError").html("Title cannot be blank.").show().fadeOut(5E3);return!1},addAllView:function(){map&&(this.$("#viewContainer").html(""),_.each(activeFigure.get("viewArray"),function(a,c){a.index=c;var b=new h({model:a});
this.$("#viewContainer").append(b.render().el)}))},reloadImageView:function(){resetMap()},logOut:function(){Parse.User.logOut();new c;this.undelegateEvents();delete this},render:function(){this.delegateEvents()}}),c=Parse.View.extend({events:{"submit form.login-form":"logIn","submit form.signup-form":"signUp"},el:".content",initialize:function(){_.bindAll(this,"logIn","signUp");this.render()},logIn:function(){var a=this,c=this.$("#signup-username").val().toLowerCase(),b=this.$("#signup-email").val(),
d=this.$("#signup-password").val(),e=new Parse.User;e.set("username",c);e.set("password",d);e.set("email",b);e.set("ACL",new Parse.ACL);e.signUp(null,{success:function(){window.appModel=new MainApplicationView;a.undelegateEvents();delete a},error:function(c,b){a.$(".signup-form .error").html(b.message).show();this.$(".signup-form button").removeAttr("disabled")}});this.$(".login-form button").attr("disabled","disabled");return!1},signUp:function(){var c=this,b=this.$("#signup-username").val(),d=this.$("#signup-password").val();
Parse.User.signUp(b,d,{ACL:new Parse.ACL},{success:function(){window.appModel=new a;c.undelegateEvents();delete c},error:function(a,b){c.$(".signup-form .error").html(b.message).show();this.$(".signup-form button").removeAttr("disabled")}});this.$(".signup-form button").attr("disabled","disabled");return!1},render:function(){this.$el.html(_.template($("#login-template").html()));$("#login-username").focus();this.delegateEvents()}}),d=Parse.View.extend({el:$("#todoapp"),initialize:function(){this.render()},
render:function(){Parse.User.current()?window.appModel=new a:new c}}),e=Parse.Router.extend({routes:{all:"all",active:"active",completed:"completed"},initialize:function(){},all:function(){i.set({filter:"all"})},active:function(){i.set({filter:"active"})},completed:function(){i.set({filter:"completed"})}}),i=new b;new e;new d;Parse.history.start()});(function(){function g(a,c,b){if(a===c)return 0!==a||1/a==1/c;if(null==a||null==c)return a===c;a._chain&&(a=a._wrapped);c._chain&&(c=c._wrapped);if(a.isEqual&&f.isFunction(a.isEqual))return a.isEqual(c);if(c.isEqual&&f.isFunction(c.isEqual))return c.isEqual(a);var d=k.call(a);if(d!=k.call(c))return!1;switch(d){case "[object String]":return a==""+c;case "[object Number]":return a!=+a?c!=+c:0==a?1/a==1/c:a==+c;case "[object Date]":case "[object Boolean]":return+a==+c;case "[object RegExp]":return a.source==
c.source&&a.global==c.global&&a.multiline==c.multiline&&a.ignoreCase==c.ignoreCase}if("object"!=typeof a||"object"!=typeof c)return!1;for(var e=b.length;e--;)if(b[e]==a)return!0;b.push(a);var e=0,i=!0;if("[object Array]"==d){if(e=a.length,i=e==c.length)for(;e--&&(i=e in a==e in c&&g(a[e],c[e],b)););}else{if("constructor"in a!="constructor"in c||a.constructor!=c.constructor)return!1;for(var h in a)if(f.has(a,h)&&(e++,!(i=f.has(c,h)&&g(a[h],c[h],b))))break;if(i){for(h in c)if(f.has(c,h)&&!e--)break;
i=!e}}b.pop();return i}var b=this,h=b._,a={},c=Array.prototype,d=Object.prototype,e=c.slice,i=c.unshift,k=d.toString,j=d.hasOwnProperty,n=c.forEach,q=c.map,r=c.reduce,p=c.reduceRight,B=c.filter,C=c.every,t=c.some,u=c.indexOf,D=c.lastIndexOf,d=Array.isArray,G=Object.keys,w=Function.prototype.bind,f=function(a){return new s(a)};"undefined"!==typeof exports?("undefined"!==typeof module&&module.exports&&(exports=module.exports=f),exports._=f):b._=f;f.VERSION="1.3.3";var m=f.each=f.forEach=function(c,
b,d){if(null!=c)if(n&&c.forEach===n)c.forEach(b,d);else if(c.length===+c.length)for(var e=0,i=c.length;e<i&&!(e in c&&b.call(d,c[e],e,c)===a);e++);else for(e in c)if(f.has(c,e)&&b.call(d,c[e],e,c)===a)break};f.map=f.collect=function(a,c,b){var d=[];if(null==a)return d;if(q&&a.map===q)return a.map(c,b);m(a,function(a,l,e){d[d.length]=c.call(b,a,l,e)});a.length===+a.length&&(d.length=a.length);return d};f.reduce=f.foldl=f.inject=function(a,c,b,d){var e=2<arguments.length;null==a&&(a=[]);if(r&&a.reduce===
r)return d&&(c=f.bind(c,d)),e?a.reduce(c,b):a.reduce(c);m(a,function(a,l,f){e?b=c.call(d,b,a,l,f):(b=a,e=!0)});if(!e)throw new TypeError("Reduce of empty array with no initial value");return b};f.reduceRight=f.foldr=function(a,c,b,d){var e=2<arguments.length;null==a&&(a=[]);if(p&&a.reduceRight===p)return d&&(c=f.bind(c,d)),e?a.reduceRight(c,b):a.reduceRight(c);var i=f.toArray(a).reverse();d&&!e&&(c=f.bind(c,d));return e?f.reduce(i,c,b,d):f.reduce(i,c)};f.find=f.detect=function(a,c,b){var d;E(a,function(a,
l,e){if(c.call(b,a,l,e))return d=a,!0});return d};f.filter=f.select=function(a,c,b){var d=[];if(null==a)return d;if(B&&a.filter===B)return a.filter(c,b);m(a,function(a,l,e){c.call(b,a,l,e)&&(d[d.length]=a)});return d};f.reject=function(a,c,b){var d=[];if(null==a)return d;m(a,function(a,l,e){c.call(b,a,l,e)||(d[d.length]=a)});return d};f.every=f.all=function(c,b,d){var e=!0;if(null==c)return e;if(C&&c.every===C)return c.every(b,d);m(c,function(c,l,f){if(!(e=e&&b.call(d,c,l,f)))return a});return!!e};
var E=f.some=f.any=function(c,b,d){b||(b=f.identity);var e=!1;if(null==c)return e;if(t&&c.some===t)return c.some(b,d);m(c,function(c,l,f){if(e||(e=b.call(d,c,l,f)))return a});return!!e};f.include=f.contains=function(a,c){return null==a?!1:u&&a.indexOf===u?-1!=a.indexOf(c):E(a,function(a){return a===c})};f.invoke=function(a,c){var b=e.call(arguments,2);return f.map(a,function(a){return(f.isFunction(c)?c||a:a[c]).apply(a,b)})};f.pluck=function(a,c){return f.map(a,function(a){return a[c]})};f.max=function(a,
c,b){if(!c&&f.isArray(a)&&a[0]===+a[0])return Math.max.apply(Math,a);if(!c&&f.isEmpty(a))return-Infinity;var d={computed:-Infinity};m(a,function(a,l,e){l=c?c.call(b,a,l,e):a;l>=d.computed&&(d={value:a,computed:l})});return d.value};f.min=function(a,c,b){if(!c&&f.isArray(a)&&a[0]===+a[0])return Math.min.apply(Math,a);if(!c&&f.isEmpty(a))return Infinity;var d={computed:Infinity};m(a,function(a,l,e){l=c?c.call(b,a,l,e):a;l<d.computed&&(d={value:a,computed:l})});return d.value};f.shuffle=function(a){var c=
[],b;m(a,function(a,l){b=Math.floor(Math.random()*(l+1));c[l]=c[b];c[b]=a});return c};f.sortBy=function(a,c,b){var d=f.isFunction(c)?c:function(a){return a[c]};return f.pluck(f.map(a,function(a,c,l){return{value:a,criteria:d.call(b,a,c,l)}}).sort(function(a,c){var b=a.criteria,l=c.criteria;return void 0===b?1:void 0===l?-1:b<l?-1:b>l?1:0}),"value")};f.groupBy=function(a,c){var b={},d=f.isFunction(c)?c:function(a){return a[c]};m(a,function(a,c){var l=d(a,c);(b[l]||(b[l]=[])).push(a)});return b};f.sortedIndex=
function(a,c,b){b||(b=f.identity);for(var d=0,e=a.length;d<e;){var i=d+e>>1;b(a[i])<b(c)?d=i+1:e=i}return d};f.toArray=function(a){return!a?[]:f.isArray(a)||f.isArguments(a)?e.call(a):a.toArray&&f.isFunction(a.toArray)?a.toArray():f.values(a)};f.size=function(a){return f.isArray(a)?a.length:f.keys(a).length};f.first=f.head=f.take=function(a,c,b){return null!=c&&!b?e.call(a,0,c):a[0]};f.initial=function(a,c,b){return e.call(a,0,a.length-(null==c||b?1:c))};f.last=function(a,c,b){return null!=c&&!b?
e.call(a,Math.max(a.length-c,0)):a[a.length-1]};f.rest=f.tail=function(a,c,b){return e.call(a,null==c||b?1:c)};f.compact=function(a){return f.filter(a,function(a){return!!a})};f.flatten=function(a,c){return f.reduce(a,function(a,b){if(f.isArray(b))return a.concat(c?b:f.flatten(b));a[a.length]=b;return a},[])};f.without=function(a){return f.difference(a,e.call(arguments,1))};f.uniq=f.unique=function(a,c,b){var b=b?f.map(a,b):a,d=[];3>a.length&&(c=!0);f.reduce(b,function(b,e,i){if(c?f.last(b)!==e||
!b.length:!f.include(b,e))b.push(e),d.push(a[i]);return b},[]);return d};f.union=function(){return f.uniq(f.flatten(arguments,!0))};f.intersection=f.intersect=function(a){var c=e.call(arguments,1);return f.filter(f.uniq(a),function(a){return f.every(c,function(c){return 0<=f.indexOf(c,a)})})};f.difference=function(a){var c=f.flatten(e.call(arguments,1),!0);return f.filter(a,function(a){return!f.include(c,a)})};f.zip=function(){for(var a=e.call(arguments),c=f.max(f.pluck(a,"length")),b=Array(c),d=
0;d<c;d++)b[d]=f.pluck(a,""+d);return b};f.indexOf=function(a,c,b){if(null==a)return-1;var d;if(b)return b=f.sortedIndex(a,c),a[b]===c?b:-1;if(u&&a.indexOf===u)return a.indexOf(c);b=0;for(d=a.length;b<d;b++)if(b in a&&a[b]===c)return b;return-1};f.lastIndexOf=function(a,c){if(null==a)return-1;if(D&&a.lastIndexOf===D)return a.lastIndexOf(c);for(var b=a.length;b--;)if(b in a&&a[b]===c)return b;return-1};f.range=function(a,c,b){1>=arguments.length&&(c=a||0,a=0);for(var b=arguments[2]||1,d=Math.max(Math.ceil((c-
a)/b),0),e=0,f=Array(d);e<d;)f[e++]=a,a+=b;return f};var F=function(){};f.bind=function(a,c){var b,d;if(a.bind===w&&w)return w.apply(a,e.call(arguments,1));if(!f.isFunction(a))throw new TypeError;d=e.call(arguments,2);return b=function(){if(!(this instanceof b))return a.apply(c,d.concat(e.call(arguments)));F.prototype=a.prototype;var f=new F,i=a.apply(f,d.concat(e.call(arguments)));return Object(i)===i?i:f}};f.bindAll=function(a){var c=e.call(arguments,1);0==c.length&&(c=f.functions(a));m(c,function(c){a[c]=
f.bind(a[c],a)});return a};f.memoize=function(a,c){var b={};c||(c=f.identity);return function(){var d=c.apply(this,arguments);return f.has(b,d)?b[d]:b[d]=a.apply(this,arguments)}};f.delay=function(a,c){var b=e.call(arguments,2);return setTimeout(function(){return a.apply(null,b)},c)};f.defer=function(a){return f.delay.apply(f,[a,1].concat(e.call(arguments,1)))};f.throttle=function(a,c){var b,d,e,i,h,g,k=f.debounce(function(){h=i=!1},c);return function(){b=this;d=arguments;e||(e=setTimeout(function(){e=
null;h&&a.apply(b,d);k()},c));i?h=!0:g=a.apply(b,d);k();i=!0;return g}};f.debounce=function(a,c,b){var d;return function(){var e=this,f=arguments;b&&!d&&a.apply(e,f);clearTimeout(d);d=setTimeout(function(){d=null;b||a.apply(e,f)},c)}};f.once=function(a){var c=!1,b;return function(){if(c)return b;c=!0;return b=a.apply(this,arguments)}};f.wrap=function(a,c){return function(){var b=[a].concat(e.call(arguments,0));return c.apply(this,b)}};f.compose=function(){var a=arguments;return function(){for(var c=
arguments,b=a.length-1;0<=b;b--)c=[a[b].apply(this,c)];return c[0]}};f.after=function(a,c){return 0>=a?c():function(){if(1>--a)return c.apply(this,arguments)}};f.keys=G||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var c=[],b;for(b in a)f.has(a,b)&&(c[c.length]=b);return c};f.values=function(a){return f.map(a,f.identity)};f.functions=f.methods=function(a){var c=[],b;for(b in a)f.isFunction(a[b])&&c.push(b);return c.sort()};f.extend=function(a){m(e.call(arguments,1),function(c){for(var b in c)a[b]=
c[b]});return a};f.pick=function(a){var c={};m(f.flatten(e.call(arguments,1)),function(b){b in a&&(c[b]=a[b])});return c};f.defaults=function(a){m(e.call(arguments,1),function(c){for(var b in c)null==a[b]&&(a[b]=c[b])});return a};f.clone=function(a){return!f.isObject(a)?a:f.isArray(a)?a.slice():f.extend({},a)};f.tap=function(a,c){c(a);return a};f.isEqual=function(a,c){return g(a,c,[])};f.isEmpty=function(a){if(null==a)return!0;if(f.isArray(a)||f.isString(a))return 0===a.length;for(var c in a)if(f.has(a,
c))return!1;return!0};f.isElement=function(a){return!!(a&&1==a.nodeType)};f.isArray=d||function(a){return"[object Array]"==k.call(a)};f.isObject=function(a){return a===Object(a)};f.isArguments=function(a){return"[object Arguments]"==k.call(a)};f.isArguments(arguments)||(f.isArguments=function(a){return!(!a||!f.has(a,"callee"))});f.isFunction=function(a){return"[object Function]"==k.call(a)};f.isString=function(a){return"[object String]"==k.call(a)};f.isNumber=function(a){return"[object Number]"==
k.call(a)};f.isFinite=function(a){return f.isNumber(a)&&isFinite(a)};f.isNaN=function(a){return a!==a};f.isBoolean=function(a){return!0===a||!1===a||"[object Boolean]"==k.call(a)};f.isDate=function(a){return"[object Date]"==k.call(a)};f.isRegExp=function(a){return"[object RegExp]"==k.call(a)};f.isNull=function(a){return null===a};f.isUndefined=function(a){return void 0===a};f.has=function(a,c){return j.call(a,c)};f.noConflict=function(){b._=h;return this};f.identity=function(a){return a};f.times=
function(a,c,b){for(var d=0;d<a;d++)c.call(b,d)};f.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};f.result=function(a,c){if(null==a)return null;var b=a[c];return f.isFunction(b)?b.call(a):b};f.mixin=function(a){m(f.functions(a),function(c){var b=f[c]=a[c];s.prototype[c]=function(){var a=e.call(arguments);i.call(a,this._wrapped);return x(b.apply(f,a),this._chain)}})};var H=0;f.uniqueId=
function(a){var c=H++;return a?a+c:c};f.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var y=/.^/,v={"\\":"\\","'":"'",r:"\r",n:"\n",t:"\t",u2028:"\u2028",u2029:"\u2029"},z;for(z in v)v[v[z]]=z;var I=/\\|'|\r|\n|\t|\u2028|\u2029/g,J=/\\(\\|'|r|n|t|u2028|u2029)/g,A=function(a){return a.replace(J,function(a,c){return v[c]})};f.template=function(a,c,b){b=f.defaults(b||{},f.templateSettings);a="__p+='"+a.replace(I,function(a){return"\\"+v[a]}).replace(b.escape||
y,function(a,c){return"'+\n_.escape("+A(c)+")+\n'"}).replace(b.interpolate||y,function(a,c){return"'+\n("+A(c)+")+\n'"}).replace(b.evaluate||y,function(a,c){return"';\n"+A(c)+"\n;__p+='"})+"';\n";b.variable||(a="with(obj||{}){\n"+a+"}\n");var a="var __p='';var print=function(){__p+=Array.prototype.join.call(arguments, '')};\n"+a+"return __p;\n",d=new Function(b.variable||"obj","_",a);if(c)return d(c,f);c=function(a){return d.call(this,a,f)};c.source="function("+(b.variable||"obj")+"){\n"+a+"}";return c};
f.chain=function(a){return f(a).chain()};var s=function(a){this._wrapped=a};f.prototype=s.prototype;var x=function(a,c){return c?f(a).chain():a};f.mixin(f);m("pop push reverse shift sort splice unshift".split(" "),function(a){var b=c[a];s.prototype[a]=function(){var c=this._wrapped;b.apply(c,arguments);var d=c.length;("shift"==a||"splice"==a)&&0===d&&delete c[0];return x(c,this._chain)}});m(["concat","join","slice"],function(a){var b=c[a];s.prototype[a]=function(){return x(b.apply(this._wrapped,arguments),
this._chain)}});s.prototype.chain=function(){this._chain=!0;return this};s.prototype.value=function(){return this._wrapped}}).call(this);(function(g){g.Parse=g.Parse||{};g.Parse.VERSION="1.0.18"})(this);
(function(){function g(a,c,b){if(a===c)return 0!==a||1/a==1/c;if(null==a||null==c)return a===c;a._chain&&(a=a._wrapped);c._chain&&(c=c._wrapped);if(a.isEqual&&f.isFunction(a.isEqual))return a.isEqual(c);if(c.isEqual&&f.isFunction(c.isEqual))return c.isEqual(a);var d=k.call(a);if(d!=k.call(c))return!1;switch(d){case "[object String]":return a==String(c);case "[object Number]":return a!=+a?c!=+c:0==a?1/a==1/c:a==+c;case "[object Date]":case "[object Boolean]":return+a==+c;case "[object RegExp]":return a.source==
c.source&&a.global==c.global&&a.multiline==c.multiline&&a.ignoreCase==c.ignoreCase}if("object"!=typeof a||"object"!=typeof c)return!1;for(var e=b.length;e--;)if(b[e]==a)return!0;b.push(a);var e=0,i=!0;if("[object Array]"==d){if(e=a.length,i=e==c.length)for(;e--&&(i=e in a==e in c&&g(a[e],c[e],b)););}else{if("constructor"in a!="constructor"in c||a.constructor!=c.constructor)return!1;for(var h in a)if(f.has(a,h)&&(e++,!(i=f.has(c,h)&&g(a[h],c[h],b))))break;if(i){for(h in c)if(f.has(c,h)&&!e--)break;
i=!e}}return b.pop(),i}var b=this,h=b._,a={},c=Array.prototype,d=Object.prototype,e=c.slice,i=c.unshift,k=d.toString,j=d.hasOwnProperty,n=c.forEach,q=c.map,r=c.reduce,p=c.reduceRight,B=c.filter,C=c.every,t=c.some,u=c.indexOf,D=c.lastIndexOf,d=Array.isArray,G=Object.keys,w=Function.prototype.bind,f=function(a){return new s(a)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=f),exports._=f):b._=f;f.VERSION="1.3.3";var m=f.each=f.forEach=function(c,b,
d){if(null!=c)if(n&&c.forEach===n)c.forEach(b,d);else if(c.length===+c.length)for(var e=0,i=c.length;e<i&&!(e in c&&b.call(d,c[e],e,c)===a);e++);else for(e in c)if(f.has(c,e)&&b.call(d,c[e],e,c)===a)break};f.map=f.collect=function(a,c,b){var d=[];return null==a?d:q&&a.map===q?a.map(c,b):(m(a,function(a,e,f){d[d.length]=c.call(b,a,e,f)}),a.length===+a.length&&(d.length=a.length),d)};f.reduce=f.foldl=f.inject=function(a,c,b,d){var e=2<arguments.length;null==a&&(a=[]);if(r&&a.reduce===r)return d&&(c=
f.bind(c,d)),e?a.reduce(c,b):a.reduce(c);m(a,function(a,f,i){e?b=c.call(d,b,a,f,i):(b=a,e=!0)});if(!e)throw new TypeError("Reduce of empty array with no initial value");return b};f.reduceRight=f.foldr=function(a,c,b,d){var e=2<arguments.length;null==a&&(a=[]);if(p&&a.reduceRight===p)return d&&(c=f.bind(c,d)),e?a.reduceRight(c,b):a.reduceRight(c);var i=f.toArray(a).reverse();return d&&!e&&(c=f.bind(c,d)),e?f.reduce(i,c,b,d):f.reduce(i,c)};f.find=f.detect=function(a,c,b){var d;return E(a,function(a,
e,f){if(c.call(b,a,e,f))return d=a,!0}),d};f.filter=f.select=function(a,c,b){var d=[];return null==a?d:B&&a.filter===B?a.filter(c,b):(m(a,function(a,e,f){c.call(b,a,e,f)&&(d[d.length]=a)}),d)};f.reject=function(a,c,b){var d=[];return null==a?d:(m(a,function(a,e,f){c.call(b,a,e,f)||(d[d.length]=a)}),d)};f.every=f.all=function(c,b,d){var e=!0;return null==c?e:C&&c.every===C?c.every(b,d):(m(c,function(c,f,i){if(!(e=e&&b.call(d,c,f,i)))return a}),!!e)};var E=f.some=f.any=function(c,b,d){b||(b=f.identity);
var e=!1;return null==c?e:t&&c.some===t?c.some(b,d):(m(c,function(c,f,i){if(e||(e=b.call(d,c,f,i)))return a}),!!e)};f.include=f.contains=function(a,c){var b=!1;return null==a?b:u&&a.indexOf===u?-1!=a.indexOf(c):(b=E(a,function(a){return a===c}),b)};f.invoke=function(a,c){var b=e.call(arguments,2);return f.map(a,function(a){return(f.isFunction(c)?c||a:a[c]).apply(a,b)})};f.pluck=function(a,c){return f.map(a,function(a){return a[c]})};f.max=function(a,c,b){if(!c&&f.isArray(a)&&a[0]===+a[0])return Math.max.apply(Math,
a);if(!c&&f.isEmpty(a))return-Infinity;var d={computed:-Infinity};return m(a,function(a,e,f){e=c?c.call(b,a,e,f):a;e>=d.computed&&(d={value:a,computed:e})}),d.value};f.min=function(a,c,b){if(!c&&f.isArray(a)&&a[0]===+a[0])return Math.min.apply(Math,a);if(!c&&f.isEmpty(a))return Infinity;var d={computed:Infinity};return m(a,function(a,e,f){e=c?c.call(b,a,e,f):a;e<d.computed&&(d={value:a,computed:e})}),d.value};f.shuffle=function(a){var c=[],b;return m(a,function(a,d){b=Math.floor(Math.random()*(d+
1));c[d]=c[b];c[b]=a}),c};f.sortBy=function(a,c,b){var d=f.isFunction(c)?c:function(a){return a[c]};return f.pluck(f.map(a,function(a,c,e){return{value:a,criteria:d.call(b,a,c,e)}}).sort(function(a,c){var b=a.criteria,d=c.criteria;return void 0===b?1:void 0===d?-1:b<d?-1:b>d?1:0}),"value")};f.groupBy=function(a,c){var b={},d=f.isFunction(c)?c:function(a){return a[c]};return m(a,function(a,c){var e=d(a,c);(b[e]||(b[e]=[])).push(a)}),b};f.sortedIndex=function(a,c,b){b||(b=f.identity);for(var d=0,e=
a.length;d<e;){var i=d+e>>1;b(a[i])<b(c)?d=i+1:e=i}return d};f.toArray=function(a){return a?f.isArray(a)?e.call(a):f.isArguments(a)?e.call(a):a.toArray&&f.isFunction(a.toArray)?a.toArray():f.values(a):[]};f.size=function(a){return f.isArray(a)?a.length:f.keys(a).length};f.first=f.head=f.take=function(a,c,b){return null!=c&&!b?e.call(a,0,c):a[0]};f.initial=function(a,c,b){return e.call(a,0,a.length-(null==c||b?1:c))};f.last=function(a,c,b){return null!=c&&!b?e.call(a,Math.max(a.length-c,0)):a[a.length-
1]};f.rest=f.tail=function(a,c,b){return e.call(a,null==c||b?1:c)};f.compact=function(a){return f.filter(a,function(a){return!!a})};f.flatten=function(a,c){return f.reduce(a,function(a,b){return f.isArray(b)?a.concat(c?b:f.flatten(b)):(a[a.length]=b,a)},[])};f.without=function(a){return f.difference(a,e.call(arguments,1))};f.uniq=f.unique=function(a,c,b){var b=b?f.map(a,b):a,d=[];return 3>a.length&&(c=!0),f.reduce(b,function(b,e,i){if(c?f.last(b)!==e||!b.length:!f.include(b,e))b.push(e),d.push(a[i]);
return b},[]),d};f.union=function(){return f.uniq(f.flatten(arguments,!0))};f.intersection=f.intersect=function(a){var c=e.call(arguments,1);return f.filter(f.uniq(a),function(a){return f.every(c,function(c){return 0<=f.indexOf(c,a)})})};f.difference=function(a){var c=f.flatten(e.call(arguments,1),!0);return f.filter(a,function(a){return!f.include(c,a)})};f.zip=function(){for(var a=e.call(arguments),c=f.max(f.pluck(a,"length")),b=Array(c),d=0;d<c;d++)b[d]=f.pluck(a,""+d);return b};f.indexOf=function(a,
c,b){if(null==a)return-1;var d;if(b)return d=f.sortedIndex(a,c),a[d]===c?d:-1;if(u&&a.indexOf===u)return a.indexOf(c);d=0;for(b=a.length;d<b;d++)if(d in a&&a[d]===c)return d;return-1};f.lastIndexOf=function(a,c){if(null==a)return-1;if(D&&a.lastIndexOf===D)return a.lastIndexOf(c);for(var b=a.length;b--;)if(b in a&&a[b]===c)return b;return-1};f.range=function(a,c,b){1>=arguments.length&&(c=a||0,a=0);for(var b=arguments[2]||1,d=Math.max(Math.ceil((c-a)/b),0),e=0,f=Array(d);e<d;)f[e++]=a,a+=b;return f};
var F=function(){};f.bind=function(a,c){var b,d;if(a.bind===w&&w)return w.apply(a,e.call(arguments,1));if(!f.isFunction(a))throw new TypeError;return d=e.call(arguments,2),b=function(){if(this instanceof b){F.prototype=a.prototype;var f=new F,i=a.apply(f,d.concat(e.call(arguments)));return Object(i)===i?i:f}return a.apply(c,d.concat(e.call(arguments)))}};f.bindAll=function(a){var c=e.call(arguments,1);return 0==c.length&&(c=f.functions(a)),m(c,function(c){a[c]=f.bind(a[c],a)}),a};f.memoize=function(a,
c){var b={};return c||(c=f.identity),function(){var d=c.apply(this,arguments);return f.has(b,d)?b[d]:b[d]=a.apply(this,arguments)}};f.delay=function(a,c){var b=e.call(arguments,2);return setTimeout(function(){return a.apply(null,b)},c)};f.defer=function(a){return f.delay.apply(f,[a,1].concat(e.call(arguments,1)))};f.throttle=function(a,c){var b,d,e,i,h,g,k=f.debounce(function(){h=i=!1},c);return function(){b=this;d=arguments;return e||(e=setTimeout(function(){e=null;h&&a.apply(b,d);k()},c)),i?h=!0:
g=a.apply(b,d),k(),i=!0,g}};f.debounce=function(a,c,b){var d;return function(){var e=this,f=arguments;b&&!d&&a.apply(e,f);clearTimeout(d);d=setTimeout(function(){d=null;b||a.apply(e,f)},c)}};f.once=function(a){var c=!1,b;return function(){return c?b:(c=!0,b=a.apply(this,arguments))}};f.wrap=function(a,c){return function(){var b=[a].concat(e.call(arguments,0));return c.apply(this,b)}};f.compose=function(){var a=arguments;return function(){for(var c=arguments,b=a.length-1;0<=b;b--)c=[a[b].apply(this,
c)];return c[0]}};f.after=function(a,c){return 0>=a?c():function(){if(1>--a)return c.apply(this,arguments)}};f.keys=G||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var c=[],b;for(b in a)f.has(a,b)&&(c[c.length]=b);return c};f.values=function(a){return f.map(a,f.identity)};f.functions=f.methods=function(a){var c=[],b;for(b in a)f.isFunction(a[b])&&c.push(b);return c.sort()};f.extend=function(a){return m(e.call(arguments,1),function(c){for(var b in c)a[b]=c[b]}),a};f.pick=function(a){var c=
{};return m(f.flatten(e.call(arguments,1)),function(b){b in a&&(c[b]=a[b])}),c};f.defaults=function(a){return m(e.call(arguments,1),function(c){for(var b in c)null==a[b]&&(a[b]=c[b])}),a};f.clone=function(a){return f.isObject(a)?f.isArray(a)?a.slice():f.extend({},a):a};f.tap=function(a,c){return c(a),a};f.isEqual=function(a,c){return g(a,c,[])};f.isEmpty=function(a){if(null==a)return!0;if(f.isArray(a)||f.isString(a))return 0===a.length;for(var c in a)if(f.has(a,c))return!1;return!0};f.isElement=function(a){return!!a&&
1==a.nodeType};f.isArray=d||function(a){return"[object Array]"==k.call(a)};f.isObject=function(a){return a===Object(a)};f.isArguments=function(a){return"[object Arguments]"==k.call(a)};f.isArguments(arguments)||(f.isArguments=function(a){return!!a&&!!f.has(a,"callee")});f.isFunction=function(a){return"[object Function]"==k.call(a)};f.isString=function(a){return"[object String]"==k.call(a)};f.isNumber=function(a){return"[object Number]"==k.call(a)};f.isFinite=function(a){return f.isNumber(a)&&isFinite(a)};
f.isNaN=function(a){return a!==a};f.isBoolean=function(a){return!0===a||!1===a||"[object Boolean]"==k.call(a)};f.isDate=function(a){return"[object Date]"==k.call(a)};f.isRegExp=function(a){return"[object RegExp]"==k.call(a)};f.isNull=function(a){return null===a};f.isUndefined=function(a){return void 0===a};f.has=function(a,c){return j.call(a,c)};f.noConflict=function(){return b._=h,this};f.identity=function(a){return a};f.times=function(a,c,b){for(var d=0;d<a;d++)c.call(b,d)};f.escape=function(a){return(""+
a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};f.result=function(a,c){if(null==a)return null;var b=a[c];return f.isFunction(b)?b.call(a):b};f.mixin=function(a){m(f.functions(a),function(c){var b=f[c]=a[c];s.prototype[c]=function(){var a=e.call(arguments);return i.call(a,this._wrapped),x(b.apply(f,a),this._chain)}})};var H=0;f.uniqueId=function(a){var c=H++;return a?a+c:c};f.templateSettings={evaluate:/<%([\s\S]+?)%>/g,
interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var y=/.^/,v={"\\":"\\","'":"'",r:"\r",n:"\n",t:"\t",u2028:"\u2028",u2029:"\u2029"},z;for(z in v)v[v[z]]=z;var I=/\\|'|\r|\n|\t|\u2028|\u2029/g,J=/\\(\\|'|r|n|t|u2028|u2029)/g,A=function(a){return a.replace(J,function(a,c){return v[c]})};f.template=function(a,c,b){b=f.defaults(b||{},f.templateSettings);a="__p+='"+a.replace(I,function(a){return"\\"+v[a]}).replace(b.escape||y,function(a,c){return"'+\n_.escape("+A(c)+")+\n'"}).replace(b.interpolate||
y,function(a,c){return"'+\n("+A(c)+")+\n'"}).replace(b.evaluate||y,function(a,c){return"';\n"+A(c)+"\n;__p+='"})+"';\n";b.variable||(a="with(obj||{}){\n"+a+"}\n");var a="var __p='';var print=function(){__p+=Array.prototype.join.call(arguments, '')};\n"+a+"return __p;\n",d=new Function(b.variable||"obj","_",a);if(c)return d(c,f);c=function(a){return d.call(this,a,f)};return c.source="function("+(b.variable||"obj")+"){\n"+a+"}",c};f.chain=function(a){return f(a).chain()};var s=function(a){this._wrapped=
a};f.prototype=s.prototype;var x=function(a,c){return c?f(a).chain():a};f.mixin(f);m("pop push reverse shift sort splice unshift".split(" "),function(a){var b=c[a];s.prototype[a]=function(){var c=this._wrapped;b.apply(c,arguments);var d=c.length;return("shift"==a||"splice"==a)&&0===d&&delete c[0],x(c,this._chain)}});m(["concat","join","slice"],function(a){var b=c[a];s.prototype[a]=function(){return x(b.apply(this._wrapped,arguments),this._chain)}});s.prototype.chain=function(){return this._chain=
!0,this};s.prototype.value=function(){return this._wrapped}}).call(this);
(function(g){g.Parse=g.Parse||{};var b=g.Parse;"undefined"!=typeof exports&&exports._?(b._=exports._.noConflict(),exports.Parse=b):b._=_.noConflict();"undefined"!=typeof $&&(b.$=$);var h=function(){};b.serverURL="https://api.parse.com";b.initialize=function(a,c){b._initialize(a,c)};b._initialize=function(a,c,d){b.applicationId=a;b.javaScriptKey=c;b.masterKey=d;b._useMasterKey=!1};b._getParsePath=function(a){if(!b.applicationId)throw"You need to call Parse.initialize before using Parse.";a||(a="");
if(!b._.isString(a))throw"Tried to get a localStorage path that wasn't a String.";return"/"===a[0]&&(a=a.substring(1)),"Parse/"+b.applicationId+"/"+a};b._installationId=null;b._getInstallationId=function(){if(b._installationId)return b._installationId;var a=b._getParsePath("installationId");b._installationId=localStorage.getItem(a);if(!b._installationId||""===b._installationId){var c=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)};b._installationId=c()+c()+"-"+c()+
"-"+c()+"-"+c()+"-"+c()+c()+c();localStorage.setItem(a,b._installationId)}return b._installationId};b._parseDate=function(a){a=/^([0-9]{1,4})-([0-9]{1,2})-([0-9]{1,2})T([0-9]{1,2}):([0-9]{1,2}):([0-9]{1,2})(.([0-9]+))?Z$/.exec(a);return!a?null:new Date(Date.UTC(a[1]||0,(a[2]||1)-1,a[3]||0,a[4]||0,a[5]||0,a[6]||0,a[8]||0))};b._ajaxIE8=function(a,c,b,e,i){var h=new XDomainRequest;h.onload=function(){var a;try{a=JSON.parse(h.responseText)}catch(c){i&&i(h)}a&&e&&e(a,h)};h.onerror=h.ontimeout=function(){i(h)};
h.onprogress=function(){};h.open(a,c);h.send(b)};b._ajax=function(a,c,d,e,i){if("undefined"!=typeof XDomainRequest)return b._ajaxIE8(a,c,d,e,i);var h=!1,g=new XMLHttpRequest;g.onreadystatechange=function(){if(4===g.readyState&&!h)if(h=!0,200<=g.status&&300>g.status){var a;try{a=JSON.parse(g.responseText)}catch(c){i&&i(g)}a&&e&&e(a,g)}else i&&i(g)};g.open(a,c,!0);g.setRequestHeader("Content-Type","text/plain");g.send(d)};b._extend=function(a,c){var d,e=this,i;d=(a&&a.hasOwnProperty("constructor")?
i=a.constructor:i=function(){e.apply(this,arguments)},b._.extend(i,e),h.prototype=e.prototype,i.prototype=new h,a&&b._.extend(i.prototype,a),c&&b._.extend(i,c),i.prototype.constructor=i,i.__super__=e.prototype,i);return d.extend=this.extend,d};b._request=function(a,c,d,e,i,h){if(!b.applicationId)throw"You must specify your applicationId using Parse.initialize";if(!b.javaScriptKey&&!b.masterKey)throw"You must specify a key using Parse.initialize";if("classes"!==a&&"users"!==a&&"login"!==a&&"requestPasswordReset"!==
a)throw"First argument must be one of classes, users, or login, not '"+a+"'.";a=b.serverURL+"/1/"+a;c&&(a+="/"+c);d&&(a+="/"+d);i=b._.clone(i||{});"POST"!==e&&(i._method=e,e="POST");i._ApplicationId=b.applicationId;b._useMasterKey?i._MasterKey=b.masterKey:i._JavaScriptKey=b.javaScriptKey;i._ClientVersion="js"+b.VERSION;i._InstallationId=b._getInstallationId();(c=b.User.current())&&c._sessionToken&&(i._SessionToken=c._sessionToken);i=JSON.stringify(i);b._ajax(e,a,i,h.success,h.error)};b._getValue=
function(a,c){return!a||!a[c]?null:b._.isFunction(a[c])?a[c]():a[c]};b._encode=function(a,c){var d=b._;if(a instanceof b.Object){if(!c||d.include(c,a)||!a._hasData)return a._toPointer();if(!a.dirty())return c=c.concat(a),b._encode(a._toFullJSON(c),c);throw"Can't fully embed a dirty object";}if(a instanceof b.ACL)return a.toJSON();if(a instanceof Date)return{__type:"Date",iso:a.toJSON()};if(a instanceof b.GeoPoint)return a.toJSON();if(d.isArray(a))return d.map(a,function(a){return b._encode(a,c)});
if(d.isRegExp(a))return a.source;if(a instanceof b.Relation||a instanceof b.Op)return a.toJSON();if(a instanceof Object){var e={};return b._each(a,function(a,d){e[d]=b._encode(a,c)}),e}return a};b._decode=function(a,c){var d=b._;return!d.isObject(c)?c:d.isArray(c)?(b._each(c,function(a,d){c[d]=b._decode(d,a)}),c):c instanceof b.Object||c instanceof b.Op?c:c.__op?b.Op._decode(c):c.objectId?"Pointer"===c.__type?(d=b.Object._create(c.className),d._finishFetch({objectId:c.objectId},!1),d):"Object"===
c.__type?(d=c.className,delete c.__type,delete c.className,d=b.Object._create(d),d._finishFetch(c,!0),d):(b._each(c,function(a,d){c[d]=b._decode(d,a)}),b.Object._create(c.className,c)):"Date"===c.__type?b._parseDate(c.iso):"GeoPoint"===c.__type?new b.GeoPoint({latitude:c.latitude,longitude:c.longitude}):"ACL"===a?c instanceof b.ACL?c:new b.ACL(c):"Relation"===c.__type?(d=new b.Relation(null,a),d.targetClassName=c.className,d):c};b._each=function(a,c){var d=b._;d.isObject(a)?d.each(d.keys(a),function(b){c(a[b],
b)}):d.each(a,c)};b._isNullOrUndefined=function(a){return b._.isNull(a)||b._.isUndefined(a)}})(this);
(function(g){g.Parse=g.Parse||{};var g=g.Parse,b=g._;g.Error=function(b,a){this.code=b;this.message=a};b.extend(g.Error,{OTHER_CAUSE:-1,INTERNAL_SERVER_ERROR:1,CONNECTION_FAILED:100,OBJECT_NOT_FOUND:101,INVALID_QUERY:102,INVALID_CLASS_NAME:103,MISSING_OBJECT_ID:104,INVALID_KEY_NAME:105,INVALID_POINTER:106,INVALID_JSON:107,COMMAND_UNAVAILABLE:108,NOT_INITIALIZED:109,INCORRECT_TYPE:111,INVALID_CHANNEL_NAME:112,PUSH_MISCONFIGURED:115,OBJECT_TOO_LARGE:116,OPERATION_FORBIDDEN:119,CACHE_MISS:120,INVALID_NESTED_KEY:121,
INVALID_FILE_NAME:122,INVALID_ACL:123,TIMEOUT:124,INVALID_EMAIL_ADDRESS:125,DUPLICATE_VALUE:137,INVALID_ROLE_NAME:139,EXCEEDED_QUOTA:140,USERNAME_MISSING:200,PASSWORD_MISSING:201,USERNAME_TAKEN:202,EMAIL_TAKEN:203,EMAIL_MISSING:204,EMAIL_NOT_FOUND:205,SESSION_MISSING:206,MUST_CREATE_USER_THROUGH_SIGNUP:207,ACCOUNT_ALREADY_LINKED:208,LINKED_ID_MISSING:250,INVALID_LINKED_SESSION:251,UNSUPPORTED_SERVICE:252})})(this);
(function(){var g=this.Parse||(this.Parse={}),b=/\s+/,h=Array.prototype.slice;g.Events={on:function(a,c,d){var e,i,h,g,n;if(!c)return this;a=a.split(b);e=this._callbacks||(this._callbacks={});for(i=a.shift();i;)h=(n=e[i])?n.tail:{},h.next=g={},h.context=d,h.callback=c,e[i]={tail:g,next:n?n.next:h},i=a.shift();return this},off:function(a,c,d){var e,i,h,g,n,q;if(i=this._callbacks){if(!a&&!c&&!d)return delete this._callbacks,this;a=a?a.split(b):_.keys(i);for(e=a.shift();e;)if(h=i[e],delete i[e],h&&(c||
d)){g=h.tail;for(h=h.next;h!==g;)n=h.callback,q=h.context,(c&&n!==c||d&&q!==d)&&this.on(e,n,q),h=h.next;e=a.shift()}return this}},trigger:function(a){var c,d,e,i,g,j;if(!(e=this._callbacks))return this;g=e.all;a=a.split(b);j=h.call(arguments,1);for(c=a.shift();c;){if(d=e[c])for(i=d.tail;(d=d.next)!==i;)d.callback.apply(d.context||this,j);if(d=g){i=d.tail;for(c=[c].concat(j);(d=d.next)!==i;)d.callback.apply(d.context||this,c)}c=a.shift()}return this}};g.Events.bind=g.Events.on;g.Events.unbind=g.Events.off}).call(this);
(function(g){g.Parse=g.Parse||{};var b=g.Parse,h=b._;b.GeoPoint=function(a,c){h.isArray(a)?(b.GeoPoint._validate(a[0],a[1]),this.latitude=a[0],this.longitude=a[1]):h.isObject(a)?(b.GeoPoint._validate(a.latitude,a.longitude),this.latitude=a.latitude,this.longitude=a.longitude):h.isNumber(a)&&h.isNumber(c)?(b.GeoPoint._validate(a,c),this.latitude=a,this.longitude=c):(this.latitude=0,this.longitude=0);var d=this;this.__defineGetter__&&this.__defineSetter__&&(this._latitude=this.latitude,this._longitude=
this.longitude,this.__defineGetter__("latitude",function(){return d._latitude}),this.__defineGetter__("longitude",function(){return d._longitude}),this.__defineSetter__("latitude",function(a){b.GeoPoint._validate(a,d.longitude);d._latitude=a}),this.__defineSetter__("longitude",function(a){b.GeoPoint._validate(d.latitude,a);d._longitude=a}))};b.GeoPoint._validate=function(a,c){if(-90>a)throw"Parse.GeoPoint latitude "+a+" < -90.0.";if(90<a)throw"Parse.GeoPoint latitude "+a+" > 90.0.";if(-180>c)throw"Parse.GeoPoint longitude "+
c+" < -180.0.";if(180<c)throw"Parse.GeoPoint longitude "+c+" > 180.0.";};b.GeoPoint.current=function(a){navigator.geolocation.getCurrentPosition(function(c){a.success&&a.success(new b.GeoPoint({latitude:c.coords.latitude,longitude:c.coords.longitude}))},function(c){a.error&&a.error(c)})};b.GeoPoint.prototype={toJSON:function(){return b.GeoPoint._validate(this.latitude,this.longitude),{__type:"GeoPoint",latitude:this.latitude,longitude:this.longitude}},radiansTo:function(a){var c=Math.PI/180,b=this.latitude*
c,e=a.latitude*c,c=this.longitude*c-a.longitude*c,a=Math.sin((b-e)/2),c=Math.sin(c/2),b=a*a+Math.cos(b)*Math.cos(e)*c*c;return b=Math.min(1,b),2*Math.asin(Math.sqrt(b))},kilometersTo:function(a){return 6371*this.radiansTo(a)},milesTo:function(a){return 3958.8*this.radiansTo(a)}}})(this);
(function(g){g.Parse=g.Parse||{};var b=g.Parse,h=b._;b.ACL=function(a){var c=this;c.permissionsById={};if(h.isObject(a))if(a instanceof b.User)c.setReadAccess(a,!0),c.setWriteAccess(a,!0);else{if(h.isFunction(a))throw"Parse.ACL() called with a function.  Did you forget ()?";b._each(a,function(a,e){if(!h.isString(e))throw"Tried to create an ACL with an invalid userId.";c.permissionsById[e]={};b._each(a,function(a,b){if("read"!==b&&"write"!==b)throw"Tried to create an ACL with an invalid permission type.";
if(!h.isBoolean(a))throw"Tried to create an ACL with an invalid permission value.";c.permissionsById[e][b]=a})})}};b.ACL.prototype.toJSON=function(){return h.clone(this.permissionsById)};b.ACL.prototype._setAccess=function(a,c,d){c instanceof b.User?c=c.id:c instanceof b.Role&&(c="role:"+c.getName());if(!h.isString(c))throw"userId must be a string.";if(!h.isBoolean(d))throw"allowed must be either true or false.";var e=this.permissionsById[c];if(!e){if(!d)return;e={};this.permissionsById[c]=e}d?this.permissionsById[c][a]=
!0:(delete e[a],h.isEmpty(e)&&delete e[c])};b.ACL.prototype._getAccess=function(a,c){c instanceof b.User?c=c.id:c instanceof b.Role&&(c="role:"+c.getName());var d=this.permissionsById[c];return d?d[a]?!0:!1:!1};b.ACL.prototype.setReadAccess=function(a,c){this._setAccess("read",a,c)};b.ACL.prototype.getReadAccess=function(a){return this._getAccess("read",a)};b.ACL.prototype.setWriteAccess=function(a,c){this._setAccess("write",a,c)};b.ACL.prototype.getWriteAccess=function(a){return this._getAccess("write",
a)};b.ACL.prototype.setPublicReadAccess=function(a){this.setReadAccess("*",a)};b.ACL.prototype.getPublicReadAccess=function(){return this.getReadAccess("*")};b.ACL.prototype.setPublicWriteAccess=function(a){this.setWriteAccess("*",a)};b.ACL.prototype.getPublicWriteAccess=function(){return this.getWriteAccess("*")};b.ACL.prototype.getRoleReadAccess=function(a){a instanceof b.Role&&(a=a.getName());if(h.isString(a))return this.getReadAccess("role:"+a);throw"role must be a Parse.Role or a String";};b.ACL.prototype.getRoleWriteAccess=
function(a){a instanceof b.Role&&(a=a.getName());if(h.isString(a))return this.getWriteAccess("role:"+a);throw"role must be a Parse.Role or a String";};b.ACL.prototype.setRoleReadAccess=function(a,c){a instanceof b.Role&&(a=a.getName());if(h.isString(a))this.setReadAccess("role:"+a,c);else throw"role must be a Parse.Role or a String";};b.ACL.prototype.setRoleWriteAccess=function(a,c){a instanceof b.Role&&(a=a.getName());if(h.isString(a))this.setWriteAccess("role:"+a,c);else throw"role must be a Parse.Role or a String";
}})(this);
(function(g){g.Parse=g.Parse||{};var b=g.Parse,h=b._;b.Op=function(){this._initialize.apply(this,arguments)};b.Op.prototype={_initialize:function(){}};h.extend(b.Op,{_extend:b._extend,_opDecoderMap:{},_registerDecoder:function(a,c){b.Op._opDecoderMap[a]=c},_decode:function(a){var c=b.Op._opDecoderMap[a.__op];return c?c(a):void 0}});b.Op._registerDecoder("Batch",function(a){var c=null;return h.each(a.ops,function(a){a=b.Op._decode(a);c=a._mergeWithPrevious(c)}),c});b.Op.Set=b.Op._extend({_initialize:function(a){this._value=a},
value:function(){return this._value},toJSON:function(){return b._encode(this.value())},_mergeWithPrevious:function(){return this},_estimate:function(){return this.value()}});b.Op._UNSET={};b.Op.Unset=b.Op._extend({toJSON:function(){return{__op:"Delete"}},_mergeWithPrevious:function(){return this},_estimate:function(){return b.Op._UNSET}});b.Op._registerDecoder("Delete",function(){return new b.Op.Unset});b.Op.Increment=b.Op._extend({_initialize:function(a){this._amount=a},amount:function(){return this._amount},
toJSON:function(){return{__op:"Increment",amount:this._amount}},_mergeWithPrevious:function(a){if(!a)return this;if(a instanceof b.Op.Unset)return new b.Op.Set(this.amount());if(a instanceof b.Op.Set)return new b.Op.Set(a.value()+this.amount());if(a instanceof b.Op.Increment)return new b.Op.Increment(this.amount()+a.amount());throw"Op is invalid after previous op.";},_estimate:function(a){return a?a+this.amount():this.amount()}});b.Op._registerDecoder("Increment",function(a){return new b.Op.Increment(a.amount)});
b.Op.Add=b.Op._extend({_initialize:function(a){this._objects=a},objects:function(){return this._objects},toJSON:function(){return{__op:"Add",objects:this.objects()}},_mergeWithPrevious:function(a){if(!a)return this;if(a instanceof b.Op.Unset)return new b.Op.Set(this.objects());if(a instanceof b.Op.Set)return new b.Op.Set(this._estimate(a.value()));if(a instanceof b.Op.Add)return new b.Op.Add(a.objects().concat(this.objects()));throw"Op is invalid after previous op.";},_estimate:function(a){return a?
a.concat(this.objects()):h.clone(this.objects())}});b.Op._registerDecoder("Add",function(a){return new b.Op.Add(b._decode(a.objects))});b.Op.AddUnique=b.Op._extend({_initialize:function(a){this._objects=h.uniq(a)},objects:function(){return this._objects},toJSON:function(){return{__op:"AddUnique",objects:this.objects()}},_mergeWithPrevious:function(a){if(!a)return this;if(a instanceof b.Op.Unset)return new b.Op.Set(this.objects());if(a instanceof b.Op.Set)return new b.Op.Set(this._estimate(a.value()));
if(a instanceof b.Op.AddUnique)return new b.Op.AddUnique(h.union(a.objects(),this.objects()));throw"Op is invalid after previous op.";},_estimate:function(a){return a?a.concat(h.difference(this.objects(),a)):h.clone(this.objects())}});b.Op._registerDecoder("AddUnique",function(a){return new b.Op.AddUnique(b._decode(a.objects))});b.Op.Remove=b.Op._extend({_initialize:function(a){this._objects=h.uniq(a)},objects:function(){return this._objects},toJSON:function(){return{__op:"Remove",objects:this.objects()}},
_mergeWithPrevious:function(a){if(!a)return this;if(a instanceof b.Op.Unset)return a;if(a instanceof b.Op.Set)return new b.Op.Set(this._estimate(a.value()));if(a instanceof b.Op.Remove)return new b.Op.Remove(h.union(a.objects(),this.objects()));throw"Op is invalid after previous op.";},_estimate:function(a){return a?h.difference(a,this.objects()):[]}});b.Op._registerDecoder("Remove",function(a){return new b.Op.Remove(b._decode(a.objects))});b.Op.Relation=b.Op._extend({_initialize:function(a,c){this._targetClassName=
null;var d=this,e=function(a){if(a instanceof b.Object){if(!a.id)throw"You can't add an unsaved Parse.Object to a relation.";d._targetClassName||(d._targetClassName=a.className);if(d._targetClassName!==a.className)throw"Tried to create a Parse.Relation with 2 different types: "+d._targetClassName+" and "+a.className+".";return a.id}return a};this.relationsToAdd=h.uniq(h.map(a,e));this.relationsToRemove=h.uniq(h.map(c,e))},added:function(){var a=this;return h.map(this.relationsToAdd,function(c){var d=
b.Object._create(a._targetClassName);return d.id=c,d})},removed:function(){var a=this;return h.map(this.relationsToRemove,function(c){var d=b.Object._create(a._targetClassName);return d.id=c,d})},toJSON:function(){var a=null,c=null,b=this,e=function(a){return{__type:"Pointer",className:b._targetClassName,objectId:a}},i=null;return 0<this.relationsToAdd.length&&(i=h.map(this.relationsToAdd,e),a={__op:"AddRelation",objects:i}),0<this.relationsToRemove.length&&(i=h.map(this.relationsToRemove,e),c={__op:"RemoveRelation",
objects:i}),a&&c?{__op:"Batch",ops:[a,c]}:a||c||{}},_mergeWithPrevious:function(a){if(!a)return this;if(a instanceof b.Op.Unset)throw"You can't modify a relation after deleting it.";if(a instanceof b.Op.Relation){if(a._targetClassName&&a._targetClassName!==this._targetClassName)throw"Related object must be of class "+a._targetClassName+", but "+this._targetClassName+" was passed in.";var c=h.union(h.difference(a.relationsToAdd,this.relationsToRemove),this.relationsToAdd),a=h.union(h.difference(a.relationsToRemove,
this.relationsToAdd),this.relationsToRemove),c=new b.Op.Relation(c,a);return c._targetClassName=this._targetClassName,c}throw"Op is invalid after previous op.";},_estimate:function(a,c,d){if(a){if(a instanceof b.Relation){if(this._targetClassName)if(a.targetClassName){if(a.targetClassName!==this._targetClassName)throw"Related object must be a "+a.targetClassName+", but a "+this._targetClassName+" was passed in.";}else a.targetClassName=this._targetClassName;return a}throw"Op is invalid after previous op.";
}(new b.Relation(c,d)).targetClassName=this._targetClassName}});b.Op._registerDecoder("AddRelation",function(a){return new b.Op.Relation(a.objects,[])});b.Op._registerDecoder("RemoveRelation",function(a){return new b.Op.Relation([],a.objects)})})(this);
(function(g){g.Parse=g.Parse||{};var b=g.Parse,h=b._;b.Relation=function(a,c){this.parent=a;this.key=c;this.targetClassName=null};b.Relation.prototype={_ensureParentAndKey:function(a,c){this.parent=this.parent||a;this.key=this.key||c;if(this.parent!==a)throw"Internal Error. Relation retrieved from two different Objects.";if(this.key!==c)throw"Internal Error. Relation retrieved from two different keys.";},add:function(a){h.isArray(a)||(a=[a]);a=new b.Op.Relation(a,[]);this.parent.set(this.key,a);this.targetClassName=
a._targetClassName},remove:function(a){h.isArray(a)||(a=[a]);a=new b.Op.Relation([],a);this.parent.set(this.key,a);this.targetClassName=a._targetClassName},toJSON:function(){return{__type:"Relation",className:this.targetClassName}},query:function(){var a=b.Object._getSubclass(this.targetClassName),a=new b.Query(a);return a._addCondition("$relatedTo","object",this.parent._toPointer()),a._addCondition("$relatedTo","key",this.key),a}}})(this);
(function(g){g.Parse=g.Parse||{};var b=g.Parse,h=b._;b.Object=function(a,d){if(h.isString(a))return b.Object._create.apply(this,arguments);a=a||{};d&&d.parse&&(a=this.parse(a));var e=b._getValue(this,"defaults");e&&(a=h.extend({},e,a));d&&d.collection&&(this.collection=d.collection);this._serverData={};this._opSetQueue=[{}];this.attributes={};this._hashedJSON={};this._escapedAttributes={};this.cid=h.uniqueId("c");this.changed={};this._silent={};this._pending={};if(!this.set(a,{silent:!0}))throw Error("Can't create an invalid Parse.Object");
this.changed={};this._silent={};this._pending={};this._hasData=!0;this._previousAttributes=h.clone(this.attributes);this.initialize.apply(this,arguments)};var a=function(c,b,e,i){var e=e||[],g;g=h.isFunction(i)?{success:function(a){i(a,null)},error:function(a){i(null,a)}}:i;if(c.length){var j=g?h.clone(g):{};j.success=function(i){e.push(i);a(h.rest(c),b,e,g)};b.call(this,h.first(c),j)}else g.success&&g.success(e)};b.Object.saveAll=function(c,b){a(c,function(a,c){a.save(null,c)},[],b)};b.Object._signUpAll=
function(c,b){a(c,function(a,c){a.signUp(null,c)},[],b)};h.extend(b.Object.prototype,b.Events,{_existed:!1,initialize:function(){},toJSON:function(){var a=this._toFullJSON();return h.each(["createdAt","objectId","updatedAt","__type","className"],function(b){delete a[b]}),a},_toFullJSON:function(a){var d=h.clone(this.attributes);return b._each(d,function(e,i){d[i]=b._encode(e,a)}),b._each(this._operations,function(a,c){d[c]=a}),d.objectId=this.id,d.createdAt=this.createdAt,d.updatedAt=this.updatedAt,
d.__type="Object",d.className=this.className,d},_refreshCache:function(){var a=this;b._each(this.attributes,function(d,e){d instanceof b.Object?d._refreshCache():h.isObject(d)&&a._resetCacheForKey(e)&&a.set(e,new b.Op.Set(d),{silent:!0})})},dirty:function(a){this._refreshCache();var b=h.last(this._opSetQueue);return a?b[a]?!0:!1:this.id?0<h.keys(b).length?!0:!1:!0},_toPointer:function(){if(!this.id)throw Error("Can't serialize an unsaved Parse.Object");return{__type:"Pointer",className:this.className,
objectId:this.id}},get:function(a){return this.attributes[a]},relation:function(a){var d=this.get(a);if(d){if(d instanceof b.Relation)return d._ensureParentAndKey(this,a),d;throw"Called relation() on non-relation field "+a;}return new b.Relation(this,a)},escape:function(a){var d=this._escapedAttributes[a];if(d)return d;var d=this.attributes[a],e;return b._isNullOrUndefined(d)?e="":e=h.escape(d.toString()),this._escapedAttributes[a]=e,e},has:function(a){return!b._isNullOrUndefined(this.attributes[a])},
_mergeMagicFields:function(a){var b=this;h.each(["id","objectId","createdAt","updatedAt"],function(e){a[e]&&("objectId"===e?b.id=a[e]:b[e]=a[e],delete a[e])})},_startSave:function(){this._opSetQueue.push({})},_processSaveQueue:function(){if(this._saveQueue&&0<this._saveQueue.length){var a=h.first(this._saveQueue);this._saveQueue=h.rest(this._saveQueue);a()}else this._saving=!1},_cancelSave:function(){var a=h.first(this._opSetQueue);this._opSetQueue=h.rest(this._opSetQueue);var d=h.first(this._opSetQueue);
b._each(a,function(b,i){var h=a[i],g=d[i];h&&g?d[i]=g._mergeWithPrevious(h):h&&(d[i]=h)});this._processSaveQueue()},_finishSave:function(a){var d=h.first(this._opSetQueue);this._opSetQueue=h.rest(this._opSetQueue);this._applyOpSet(d,this._serverData);this._mergeMagicFields(a);var e=this;b._each(a,function(a,c){e._serverData[c]=b._decode(c,a)});this._rebuildAllEstimatedData();this._processSaveQueue()},_finishFetch:function(a,d){this._mergeMagicFields(a);var e=this;b._each(a,function(a,c){e._serverData[c]=
b._decode(c,a)});this._refreshCache();this._hasData=d;this._opSetQueue=[{}];this._rebuildAllEstimatedData()},_applyOpSet:function(a,d){var e=this;b._.each(a,function(a,c){d[c]=a._estimate(d[c],e,c);d[c]===b.Op._UNSET&&delete d[c]})},_resetCacheForKey:function(a){var d=this.attributes[a];return h.isObject(d)&&!(d instanceof b.Object)&&(d=d.toJSON?d.toJSON():d,d=JSON.stringify(d),this._hashedJSON[a]!==d)?(this._hashedJSON[a]=d,!0):!1},_rebuildEstimatedDataForKey:function(a){var d=this;delete this.attributes[a];
this._serverData[a]&&(this.attributes[a]=this._serverData[a]);h.each(this._opSetQueue,function(e){(e=e[a])&&(d.attributes[a]=e._estimate(d.attributes[a],d,a),d.attributes[a]===b.Op._UNSET?delete d.attributes[a]:d._resetCacheForKey(a))})},_rebuildAllEstimatedData:function(){var a=this;this.attributes=h.clone(this._serverData);h.each(this._opSetQueue,function(b){a._applyOpSet(b,a.attributes);h.each(b,function(b,d){a._resetCacheForKey(d)})})},set:function(a,d,e){var i;h.isObject(a)||b._isNullOrUndefined(a)?
(i=a,b._each(i,function(a,c){i[c]=b._decode(c,a)}),e=d):(i={},i[a]=b._decode(a,d));e=e||{};if(!i)return this;i instanceof b.Object&&(i=i.attributes);e.unset&&b._each(i,function(a,c){i[c]=new b.Op.Unset});var g=h.clone(i),j=this;b._each(g,function(a,c){a instanceof b.Op&&(g[c]=a._estimate(j.attributes[c],j,c),g[c]===b.Op._UNSET&&delete g[c])});if(!this._validate(i,e))return!1;this._mergeMagicFields(i);e.changes={};var n=this._escapedAttributes;return b._each(h.keys(i),function(a){var c=i[a];c instanceof
b.Relation&&(c.parent=j);c instanceof b.Op||(c=new b.Op.Set(c));var d=!0;c instanceof b.Op.Set&&h.isEqual(j.attributes[a],c.value)&&(d=!1);d&&(delete n[a],e.silent?j._silent[a]=!0:e.changes[a]=!0);var g=h.last(j._opSetQueue);g[a]=c._mergeWithPrevious(g[a]);j._rebuildEstimatedDataForKey(a);d?(j.changed[a]=j.attributes[a],e.silent||(j._pending[a]=!0)):(delete j.changed[a],delete j._pending[a])}),e.silent||this.change(e),this},unset:function(a,b){return b=b||{},b.unset=!0,this.set(a,null,b)},increment:function(a,
d){if(h.isUndefined(d)||h.isNull(d))d=1;return this.set(a,new b.Op.Increment(d))},add:function(a,d){return this.set(a,new b.Op.Add([d]))},addUnique:function(a,d){return this.set(a,new b.Op.AddUnique([d]))},remove:function(a,d){return this.set(a,new b.Op.Remove([d]))},op:function(a){return h.last(this._opSetQueue)[a]},clear:function(a){a=a||{};a.unset=!0;var b=h.extend(this.attributes,this._operations);return this.set(b,a)},_getSaveJSON:function(){var a=h.clone(h.first(this._opSetQueue));return b._each(a,
function(b,e){a[e]=b.toJSON()}),a},fetch:function(a){var a=a?h.clone(a):{},d=this,e=a.success;a.success=function(a,c,b){d._finishFetch(d.parse(a,c,b),!0);e&&e(d,a)};a.error=b.Object._wrapError(a.error,d,a);b._request("classes",d.className,d.id,"GET",null,a)},save:function(a,d,e){var i,g,j;h.isObject(a)||b._isNullOrUndefined(a)?(i=a,j=d):(i={},i[a]=d,j=e);if(!j&&i&&0===h.reject(i,function(a,c){return h.include(["success","error","wait"],c)}).length&&(a=!0,h.has(i,"success")&&!h.isFunction(i.success)&&
(a=!1),h.has(i,"error")&&!h.isFunction(i.error)&&(a=!1),a))return this.save(null,i);j=j?h.clone(j):{};j.wait&&(g=h.clone(this.attributes));var n=h.extend({},j,{silent:!0});if(i&&!this.set(i,j.wait?n:j))return!1;var q=j,r=h.clone(j),p=this;p._refreshCache();a=b.Object._findUnsavedChildren(p.attributes);if(0<a.length)return b.Object.saveAll(a,{success:function(){p.save(null,q)},error:function(a){j.error&&j.error.apply(this,arguments)}}),this;r.success=function(a,c,b){c=p.parse(a,c,b);r.wait&&(c=h.extend(i||
{},c));p._finishSave(c);q.success?q.success(p,a):p.trigger("sync",p,a,r)};r.error=function(){p._cancelSave();q.error&&q.error.apply(this,arguments)};r.error=b.Object._wrapError(r.error,p,r);this._startSave();a=function(){var a=p.id?"PUT":"POST",c=p._getSaveJSON(),d="classes",e=p.className;"_User"===p.className&&!p.id&&(d="users",e=null);b._request(d,e,p.id,a,c,r);r.wait&&p.set(g,n)};return this._saving?(this._saveQueue=this._saveQueue||[],this._saveQueue.push(a)):(this._saving=!0,a()),this},destroy:function(a){var a=
a?h.clone(a):{},d=this,e=a.success,i=function(){d.trigger("destroy",d,d.collection,a)};if(!this.id)return i();a.success=function(b){a.wait&&i();e?e(d,b):d.trigger("sync",d,b,a)};a.error=b.Object._wrapError(a.error,d,a);b._request("classes",this.className,this.id,"DELETE",null,a);a.wait||i()},parse:function(a,d){var e=h.clone(a);return h(["createdAt","updatedAt"]).each(function(a){e[a]&&(e[a]=b._parseDate(e[a]))}),e.updatedAt||(e.updatedAt=e.createdAt),d&&(this._existed=201!==d.status),e},clone:function(){return new this.constructor(this.attributes)},
isNew:function(){return!this.id},change:function(a){var a=a||{},d=this._changing;this._changing=!0;var e=this;b._each(this._silent,function(a){e._pending[a]=!0});var i=h.extend({},a.changes,this._silent);this._silent={};b._each(i,function(b){e.trigger("change:"+b,e,e.get(b),a)});if(d)return this;for(d=function(a){!e._pending[a]&&!e._silent[a]&&delete e.changed[a]};!h.isEmpty(this._pending);)this._pending={},this.trigger("change",this,a),b._each(this.changed,d),e._previousAttributes=h.clone(this.attributes);
return this._changing=!1,this},existed:function(){return this._existed},hasChanged:function(a){return arguments.length?this._changed&&h.has(this._changed,a):!h.isEmpty(this._changed)},changedAttributes:function(a){if(!a)return this.hasChanged()?h.clone(this._changed):!1;var d={},e=this._previousAttributes;return b._each(a,function(a,c){h.isEqual(e[c],a)||(d[c]=a)}),d},previous:function(a){return!arguments.length||!this._previousAttributes?null:this._previousAttributes[a]},previousAttributes:function(){return h.clone(this._previousAttributes)},
isValid:function(){return!this.validate(this.attributes)},validate:function(a){return!h.has(a,"ACL")||a.ACL instanceof b.ACL?!1:new b.Error(b.Error.OTHER_CAUSE,"ACL must be a Parse.ACL.")},_validate:function(a,b){if(b.silent||!this.validate)return!0;var a=h.extend({},this.attributes,a),e=this.validate(a,b);return e?(b&&b.error?b.error(this,e,b):this.trigger("error",this,e,b),!1):!0},getACL:function(){return this.get("ACL")},setACL:function(a,b){return this.set("ACL",a,b)}});b.Object._getSubclass=
function(a){if(!h.isString(a))throw"Parse.Object._getSubclass requires a string argument.";var d=b.Object._classMap[a];return d||(d=b.Object.extend(a),b.Object._classMap[a]=d),d};b.Object._create=function(a,d,e){return new (b.Object._getSubclass(a))(d,e)};b.Object._classMap={};b.Object._extend=b._extend;b.Object.extend=function(a,d,e){if(!h.isString(a)){if(a&&h.has(a,"className"))return b.Object.extend(a.className,a,d);throw Error("Parse.Object.extend's first argument should be the className.");}"User"===
a&&(a="_User");var i=null;h.has(b.Object._classMap,a)?i=b.Object._classMap[a]._extend(d,e):(d=d||{},d.className=a,i=b.Object._extend(d,e));return i.extend=function(d){if(h.isString(d)||d&&h.has(d,"className"))return b.Object.extend.apply(i,arguments);var e=[a].concat(b._.toArray(arguments));return b.Object.extend.apply(i,e)},b.Object._classMap[a]=i,i};b.Object._wrapError=function(a,d,e){return function(h,g){h!==d&&(g=h);var j=new b.Error(-1,g.responseText);if(g.responseText){var n=JSON.parse(g.responseText);
n&&(j=new b.Error(n.code,n.error))}a?a(d,j,e):d.trigger("error",d,j,e)}};b.Object._findUnsavedChildren=function(a){var d=[];a instanceof b.Object?(a._refreshCache(),a.dirty()&&(d=[a]),d.push.apply(d,b.Object._findUnsavedChildren(a.attributes))):a instanceof b.Relation||(h.isArray(a)?h.each(a,function(a){d.push.apply(d,b.Object._findUnsavedChildren(a))}):h.isObject(a)&&b._each(a,function(a){d.push.apply(d,b.Object._findUnsavedChildren(a))}));return d}})(this);
(function(g){g.Parse=g.Parse||{};var b=g.Parse,h=b._;b.Role=b.Object.extend("_Role",{constructor:function(a,c){h.isString(a)&&c instanceof b.ACL?(b.Object.prototype.constructor.call(this,null,null),this.setName(a),this.setACL(c)):b.Object.prototype.constructor.call(this,a,c)},getName:function(){return this.get("name")},setName:function(a,c){return this.set("name",a,c)},getUsers:function(){return this.relation("users")},getRoles:function(){return this.relation("roles")},validate:function(a,c){if("name"in
a&&a.name!==this.getName()){var d=a.name;if(this.id&&this.id!==a.objectId)return new b.Error(b.Error.OTHER_CAUSE,"A role's name can only be set before it has been saved.");if(!h.isString(d))return new b.Error(b.Error.OTHER_CAUSE,"A role's name must be a String.");if(!/^[a-zA-Z\-_ ]+$/.test(d))return new b.Error(b.Error.OTHER_CAUSE,"A role's name can only contain alphanumeric characters, _, -, and spaces.")}return b.Object.prototype.validate?b.Object.prototype.validate.call(this,a,c):!1}})})(this);
(function(g){g.Parse=g.Parse||{};var b=g.Parse,h=b._;b.Collection=function(a,c){c=c||{};c.comparator&&(this.comparator=c.comparator);c.model&&(this.model=c.model);c.query&&(this.query=c.query);this._reset();this.initialize.apply(this,arguments);a&&this.reset(a,{silent:!0,parse:c.parse})};h.extend(b.Collection.prototype,b.Events,{model:b.Object,initialize:function(){},toJSON:function(){return this.map(function(a){return a.toJSON()})},add:function(a,c){var d,e,g,k,j,n={},q={},c=c||{},a=h.isArray(a)?
a.slice():[a];d=0;for(e=a.length;d<e;d++){a[d]=this._prepareModel(a[d],c);g=a[d];if(!g)throw Error("Can't add an invalid model to a collection");k=g.cid;if(n[k]||this._byCid[k])throw Error("Duplicate cid: can't add the same model to a collection twice");j=g.id;if(!b._isNullOrUndefined(j)&&(q[j]||this._byId[j]))throw Error("Duplicate id: can't add the same model to a collection twice");q[j]=g;n[k]=g}for(d=0;d<e;d++)(g=a[d]).on("all",this._onModelEvent,this),this._byCid[g.cid]=g,g.id&&(this._byId[g.id]=
g);this.length+=e;this.models.splice.apply(this.models,[c.at||this.models.length,0].concat(a));this.comparator&&this.sort({silent:!0});if(c.silent)return this;d=0;for(e=this.models.length;d<e;d++)g=this.models[d],n[g.cid]&&(c.index=d,g.trigger("add",g,this,c));return this},remove:function(a,c){var b,e,g,k,c=c||{},a=h.isArray(a)?a.slice():[a];b=0;for(e=a.length;b<e;b++)if(k=this.getByCid(a[b])||this.get(a[b]))delete this._byId[k.id],delete this._byCid[k.cid],g=this.indexOf(k),this.models.splice(g,
1),this.length--,c.silent||(c.index=g,k.trigger("remove",k,this,c)),this._removeReference(k);return this},get:function(a){return a&&this._byId[a.id||a]},getByCid:function(a){return a&&this._byCid[a.cid||a]},at:function(a){return this.models[a]},sort:function(a){a=a||{};if(!this.comparator)throw Error("Cannot sort a set without a comparator");var c=h.bind(this.comparator,this);return 1===this.comparator.length?this.models=this.sortBy(c):this.models.sort(c),a.silent||this.trigger("reset",this,a),this},
pluck:function(a){return h.map(this.models,function(c){return c.get(a)})},reset:function(a,c){var b=this;return a=a||[],c=c||{},h.each(this.models,function(a){b._removeReference(a)}),this._reset(),this.add(a,{silent:!0,parse:c.parse}),c.silent||this.trigger("reset",this,c),this},fetch:function(a){a=a?h.clone(a):{};void 0===a.parse&&(a.parse=!0);var c=this,d=a.success;a.success=function(b,g){a.add?c.add(b,a):c.reset(b,a);d&&d(c,g)};a.error=b.Object._wrapError(a.error,c,a);(this.query||new b.Query(this.model)).find(a)},
create:function(a,c){var b=this,c=c?h.clone(c):{},a=this._prepareModel(a,c);if(!a)return!1;c.wait||b.add(a,c);var e=c.success;return c.success=function(g,h){c.wait&&b.add(g,c);e?e(g,h):g.trigger("sync",a,h,c)},a.save(null,c),a},parse:function(a){return a},chain:function(){return h(this.models).chain()},_reset:function(){this.length=0;this.models=[];this._byId={};this._byCid={}},_prepareModel:function(a,c){a instanceof b.Object?a.collection||(a.collection=this):(c.collection=this,a=new this.model(a,
c),a._validate(a.attributes,c)||(a=!1));return a},_removeReference:function(a){this===a.collection&&delete a.collection;a.off("all",this._onModelEvent,this)},_onModelEvent:function(a,c,b,e){if("add"!==a&&"remove"!==a||b===this)"destroy"===a&&this.remove(c,e),c&&"change:objectId"===a&&(delete this._byId[c.previous("objectId")],this._byId[c.id]=c),this.trigger.apply(this,arguments)}});h.each("forEach each map reduce reduceRight find detect filter select reject every all some any include contains invoke max min sortBy sortedIndex toArray size first initial rest last without indexOf shuffle lastIndexOf isEmpty groupBy".split(" "),
function(a){b.Collection.prototype[a]=function(){return h[a].apply(h,[this.models].concat(h.toArray(arguments)))}});b.Collection.extend=b._extend})(this);
(function(g){g.Parse=g.Parse||{};var b=g.Parse,h=b._;b.View=function(a){this.cid=h.uniqueId("view");this._configure(a||{});this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents()};var a=/^(\S+)\s*(.*)$/,c="model collection el id attributes className tagName".split(" ");h.extend(b.View.prototype,b.Events,{tagName:"div",$:function(a){return this.$el.find(a)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this},make:function(a,
c,g){a=document.createElement(a);return c&&b.$(a).attr(c),g&&b.$(a).html(g),a},setElement:function(a,c){return this.$el=b.$(a),this.el=this.$el[0],!1!==c&&this.delegateEvents(),this},delegateEvents:function(c){if(c=c||b._getValue(this,"events")){this.undelegateEvents();var e=this;b._each(c,function(b,g){h.isFunction(b)||(b=e[c[g]]);if(!b)throw Error('Event "'+c[g]+'" does not exist');var j=g.match(a),n=j[1],j=j[2],b=h.bind(b,e),n=n+(".delegateEvents"+e.cid);""===j?e.$el.bind(n,b):e.$el.delegate(j,
n,b)})}},undelegateEvents:function(){this.$el.unbind(".delegateEvents"+this.cid)},_configure:function(a){this.options&&(a=h.extend({},this.options,a));var b=this;h.each(c,function(c){a[c]&&(b[c]=a[c])});this.options=a},_ensureElement:function(){if(this.el)this.setElement(this.el,!1);else{var a=b._getValue(this,"attributes")||{};this.id&&(a.id=this.id);this.className&&(a["class"]=this.className);this.setElement(this.make(this.tagName,a),!1)}}});b.View.extend=b._extend})(this);
(function(g){g.Parse=g.Parse||{};var b=g.Parse,h=b._;b.User=b.Object.extend("_User",{_isCurrentUser:!1,_mergeMagicFields:function(a){a.sessionToken&&(this._sessionToken=a.sessionToken,delete a.sessionToken);b.User.__super__._mergeMagicFields.call(this,a)},_cleanupAuthData:function(){if(this.isCurrent()){var a=this.get("authData");a&&h.each(this.get("authData"),function(c,b){a[b]||delete a[b]})}},_synchronizeAllAuthData:function(){if(this.get("authData")){var a=this;h.each(this.get("authData"),function(c,
b){a._synchronizeAuthData(b)})}},_synchronizeAuthData:function(a){if(this.isCurrent()){var c;h.isString(a)?(c=a,a=b.User._authProviders[c]):c=a.getAuthType();var d=this.get("authData");d&&a&&(a.restoreAuthentication(d[c])||this._unlinkFrom(a))}},_handleSaveResult:function(a){a&&(this._isCurrentUser=!0);this._cleanupAuthData();this._synchronizeAllAuthData();delete this._serverData.password;this._rebuildEstimatedDataForKey("password");this._refreshCache();(a||this.isCurrent())&&b.User._saveCurrentUser(this)},
_linkWith:function(a,c){var d;h.isString(a)?(d=a,a=b.User._authProviders[a]):d=a.getAuthType();if(h.has(c,"authData")){var e=this.get("authData")||{};e[d]=c.authData;this.set("authData",e);d=h.clone(c);return d.success=function(a){a._handleSaveResult(!0);c.success&&c.success.apply(this,arguments)},this.save({authData:e},d)}var g=this;return a.authenticate({success:function(a,b){g._linkWith(a,{authData:b,success:c.success,error:c.error})},error:function(a,b){c.error&&c.error(g,b)}})},_unlinkFrom:function(a,
c){h.isString(a)?a=b.User._authProviders[a]:a.getAuthType();var d=h.clone(c),e=this;return d.authData=null,d.success=function(b){e._synchronizeAuthData(a);c.success&&c.success.apply(this,arguments)},this._linkWith(a,d)},_isLinked:function(a){var c;h.isString(a)?c=a:c=a.getAuthType();return!!(this.get("authData")||{})[c]},_logOutWithAll:function(){if(this.get("authData")){var a=this;h.each(this.get("authData"),function(c,b){a._logOutWith(b)})}},_logOutWith:function(a){this.isCurrent()&&(h.isString(a)&&
(a=b.User._authProviders[a]),a&&a.deauthenticate&&a.deauthenticate())},signUp:function(a,c){var d,e=a&&a.username||this.get("username");if(!e||""===e)return c&&c.error&&(d=new b.Error(b.Error.OTHER_CAUSE,"Cannot sign up user with an empty name."),c.error(this,d)),!1;e=a&&a.password||this.get("password");if(!e||""===e)return c&&c.error&&(d=new b.Error(b.Error.OTHER_CAUSE,"Cannot sign up user with an empty password."),c.error(this,d)),!1;d=h.clone(c);return d.success=function(a){a._handleSaveResult(!0);
c.success&&c.success.apply(this,arguments)},this.save(a,d)},logIn:function(a){var c=this,d=h.clone(a);d.success=function(b,g,h){g=c.parse(b,g,h);c._finishFetch(g);c._handleSaveResult(!0);a.success?a.success(c,b):c.trigger("sync",c,b,d)};d.error=b.Object._wrapError(a.error,c,d);b._request("login",null,null,"GET",this.toJSON(),d)},save:function(a,c,d){var e,g;h.isObject(a)||h.isNull(a)||h.isUndefined(a)?(e=a,g=c):(e={},e[a]=c,g=d);a=h.clone(g);return a.success=function(a){a._handleSaveResult(!1);g.success&&
g.success.apply(this,arguments)},b.Object.prototype.save.call(this,e,a)},fetch:function(a){var c=h.clone(a);return c.success=function(c){c._handleSaveResult(!1);a.success&&a.success.apply(this,arguments)},b.Object.prototype.fetch.call(this,c)},isCurrent:function(){return this._isCurrentUser},getUsername:function(){return this.get("username")},setUsername:function(a,c){return this.set("username",a,c)},setPassword:function(a,c){return this.set("password",a,c)},getEmail:function(){return this.get("email")},
setEmail:function(a,c){return this.set("email",a,c)}},{_currentUser:null,_currentUserMatchesDisk:!1,_CURRENT_USER_KEY:"currentUser",_authProviders:{},signUp:function(a,c,d,e){d=d||{};d.username=a;d.password=c;return b.Object._create("_User").signUp(d,e)},logIn:function(a,c,d){var e=b.Object._create("_User");e._finishFetch({username:a,password:c});e.logIn(d)},logOut:function(){null!==b.User._currentUser&&(b.User._currentUser._logOutWithAll(),b.User._currentUser._isCurrentUser=!1);b.User._currentUserMatchesDisk=
!0;b.User._currentUser=null;localStorage.removeItem(b._getParsePath(b.User._CURRENT_USER_KEY))},requestPasswordReset:function(a,c){var d={email:a};c.error=b.Query._wrapError(c.error,c);b._request("requestPasswordReset",null,null,"POST",d,c)},current:function(){if(b.User._currentUser||b.User._currentUserMatchesDisk)return b.User._currentUser;b.User._currentUserMatchesDisk=!0;var a=localStorage.getItem(b._getParsePath(b.User._CURRENT_USER_KEY));if(!a)return null;b.User._currentUser=new b.Object._create("_User");
b.User._currentUser._isCurrentUser=!0;a=JSON.parse(a);return b.User._currentUser.id=a._id,delete a._id,b.User._currentUser._sessionToken=a._sessionToken,delete a._sessionToken,b.User._currentUser.set(a),b.User._currentUser._synchronizeAllAuthData(),b.User._currentUser._refreshCache(),b.User._currentUser._dirty={},b.User._currentUser},_saveCurrentUser:function(a){b.User._currentUser!==a&&b.User.logOut();a._isCurrentUser=!0;b.User._currentUser=a;b.User._currentUserMatchesDisk=!0;var c=a.toJSON();c._id=
a.id;c._sessionToken=a._sessionToken;localStorage.setItem(b._getParsePath(b.User._CURRENT_USER_KEY),JSON.stringify(c))},_registerAuthenticationProvider:function(a){b.User._authProviders[a.getAuthType()]=a;b.User.current()&&b.User.current()._synchronizeAuthData(a.getAuthType())},_logInWith:function(a,c){return(new b.User)._linkWith(a,c)}})})(this);
(function(g){g.Parse=g.Parse||{};var b=g.Parse,h=b._;b.Query=function(a){h.isString(a)&&(a=b.Object._getSubclass(a));this.objectClass=a;this.className=a.prototype.className;this._where={};this._include=[];this._limit=-1;this._skip=0};b.Query.prototype={get:function(a,c){var d=c.success||function(){},e=c.error||function(){};this.equalTo("objectId",a);this.first({error:function(a){e(null,a)},success:function(a){a?d(a):e(null,new b.Error(b.Error.OBJECT_NOT_FOUND,"Object not found."))}})},toJSON:function(){var a=
{where:this._where};return 0<this._include.length&&(a.include=this._include.join(",")),0<=this._limit&&(a.limit=this._limit),0<this._skip&&(a.skip=this._skip),void 0!==this._order&&(a.order=this._order),a},find:function(a){var c=this,d=a.success||function(){},e={error:a.error,success:function(a){d(h.map(a.results,function(a){var b=new c.objectClass;return b._finishFetch(a,!0),b}))}},g=this.toJSON();e.error=b.Query._wrapError(a.error,e);b._request("classes",this.className,null,"GET",g,e)},count:function(a){var c=
a.success||function(){},d={error:a.error,success:function(a){c(a.count)}},e=this.toJSON();e.limit=0;e.count=1;d.error=b.Query._wrapError(a.error,d);b._request("classes",this.className,null,"GET",e,d)},first:function(a){var c=this,d=a.success||function(){},e={error:a.error,success:function(a){d(h.map(a.results,function(a){var b=new c.objectClass;return b._finishFetch(a,!0),b})[0])}},g=this.toJSON();g.limit=1;e.error=b.Query._wrapError(a.error,e);b._request("classes",this.className,null,"GET",g,e)},
collection:function(a,c){return c=c||{},new b.Collection(a,h.extend(c,{model:this.objectClass,query:this}))},skip:function(a){return this._skip=a,this},limit:function(a){return this._limit=a,this},equalTo:function(a,c){return this._where[a]=b._encode(c),this},_addCondition:function(a,c,d){return this._where[a]||(this._where[a]={}),this._where[a][c]=b._encode(d),this},notEqualTo:function(a,c){return this._addCondition(a,"$ne",c),this},lessThan:function(a,c){return this._addCondition(a,"$lt",c),this},
greaterThan:function(a,c){return this._addCondition(a,"$gt",c),this},lessThanOrEqualTo:function(a,c){return this._addCondition(a,"$lte",c),this},greaterThanOrEqualTo:function(a,c){return this._addCondition(a,"$gte",c),this},containedIn:function(a,c){return this._addCondition(a,"$in",c),this},notContainedIn:function(a,c){return this._addCondition(a,"$nin",c),this},exists:function(a){return this._addCondition(a,"$exists",!0),this},doesNotExist:function(a){return this._addCondition(a,"$exists",!1),this},
matches:function(a,c,b){return this._addCondition(a,"$regex",c),b||(b=""),c.ignoreCase&&(b+="i"),c.multiline&&(b+="m"),b&&b.length&&this._addCondition(a,"$options",b),this},matchesQuery:function(a,b){var d=b.toJSON();return d.className=b.className,this._addCondition(a,"$inQuery",d),this},doesNotMatchQuery:function(a,b){var d=b.toJSON();return d.className=b.className,this._addCondition(a,"$notInQuery",d),this},matchesKeyInQuery:function(a,b,d){var e=d.toJSON();return e.className=d.className,this._addCondition(a,
"$select",{key:b,query:e}),this},_quote:function(a){return"\\Q"+a.replace("\\E","\\E\\\\E\\Q")+"\\E"},contains:function(a,b){return this._addCondition(a,"$regex",this._quote(b)),this},startsWith:function(a,b){return this._addCondition(a,"$regex","^"+this._quote(b)),this},endsWith:function(a,b){return this._addCondition(a,"$regex",this._quote(b)+"$"),this},ascending:function(a){return this._order=a,this},descending:function(a){return this._order="-"+a,this},near:function(a,c){return c instanceof b.GeoPoint||
(c=new b.GeoPoint(c)),this._addCondition(a,"$nearSphere",c),this},withinRadians:function(a,b,d){return this.near(a,b),this._addCondition(a,"$maxDistance",d),this},withinMiles:function(a,b,d){return this.withinRadians(a,b,d/3958.8)},withinKilometers:function(a,b,d){return this.withinRadians(a,b,d/6371)},withinGeoBox:function(a,c,d){return c instanceof b.GeoPoint||(c=new b.GeoPoint(c)),d instanceof b.GeoPoint||(d=new b.GeoPoint(d)),this._addCondition(a,"$within",{$box:[c,d]}),this},include:function(a){return h.isArray(a)?
this._include=this._include.concat(a):this._include.push(a),this}};b.Query._wrapError=function(a,c){return function(d){if(a){var e=new b.Error(-1,d.responseText);d.responseText&&(d=JSON.parse(d.responseText))&&(e=new b.Error(d.code,d.error));a(e,c)}}}})(this);
(function(g){g.Parse=g.Parse||{};var b=g.Parse,h=!1,a,c={authenticate:function(b){var c=this;FB.login(function(a){a.authResponse?b.success&&b.success(c,{id:a.authResponse.userID,access_token:a.authResponse.accessToken,expiration_date:(new Date(1E3*a.authResponse.expiresIn+(new Date).getTime())).toJSON()}):b.error&&b.error(c,a)},{scope:a})},restoreAuthentication:function(a){var c;return a?c={userID:a.id,accessToken:a.access_token,expiresIn:(b._parseDate(a.expiration_date).getTime()-(new Date).getTime())/
1E3}:c={userID:null,accessToken:null,expiresIn:null},FB.Auth.setAuthResponse(c),a||FB.logout(),!0},getAuthType:function(){return"facebook"},deauthenticate:function(){this.restoreAuthentication(null)}};b.FacebookUtils={init:function(a){if("undefined"==typeof FB)throw"The Javascript Facebook SDK must be loaded before calling init.";FB.init(a);b.User._registerAuthenticationProvider(c);h=!0},isLinked:function(a){return a._isLinked("facebook")},logIn:function(c,e){if(!h)throw"You must initialize FacebookUtils before calling logIn.";
return a=c,b.User._logInWith("facebook",e)},link:function(b,c,g){if(!h)throw"You must initialize FacebookUtils before calling link.";return a=c,b._linkWith("facebook",g)},unlink:function(a,b){if(!h)throw"You must initialize FacebookUtils before calling unlink.";return a._unlinkFrom("facebook",b)}}})(this);
(function(g){g.Parse=g.Parse||{};var b=g.Parse,h=b._;b.History=function(){this.handlers=[];h.bindAll(this,"checkUrl")};var a=/^[#\/]/,c=/msie [\w.]+/;b.History.started=!1;h.extend(b.History.prototype,b.Events,{interval:50,getHash:function(a){return(a=(a?a.location:window.location).href.match(/#(.*)$/))?a[1]:""},getFragment:function(c,e){if(b._isNullOrUndefined(c))if(this._hasPushState||e){var c=window.location.pathname,g=window.location.search;g&&(c+=g)}else c=this.getHash();return c.indexOf(this.options.root)||
(c=c.substr(this.options.root.length)),c.replace(a,"")},start:function(d){if(b.History.started)throw Error("Parse.history has already been started");b.History.started=!0;this.options=h.extend({},{root:"/"},this.options,d);this._wantsHashChange=!1!==this.options.hashChange;this._wantsPushState=!!this.options.pushState;this._hasPushState=!(!this.options.pushState||!window.history||!window.history.pushState);var d=this.getFragment(),e=document.documentMode;(e=c.exec(navigator.userAgent.toLowerCase())&&
(!e||7>=e))&&(this.iframe=b.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(d));this._hasPushState?b.$(window).bind("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!e?b.$(window).bind("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=window.setInterval(this.checkUrl,this.interval));this.fragment=d;d=window.location;e=d.pathname===this.options.root;if(this._wantsHashChange&&this._wantsPushState&&
!this._hasPushState&&!e)return this.fragment=this.getFragment(null,!0),window.location.replace(this.options.root+"#"+this.fragment),!0;this._wantsPushState&&this._hasPushState&&e&&d.hash&&(this.fragment=this.getHash().replace(a,""),window.history.replaceState({},document.title,d.protocol+"//"+d.host+this.options.root+this.fragment));if(!this.options.silent)return this.loadUrl()},stop:function(){b.$(window).unbind("popstate",this.checkUrl).unbind("hashchange",this.checkUrl);window.clearInterval(this._checkUrlInterval);
b.History.started=!1},route:function(a,b){this.handlers.unshift({route:a,callback:b})},checkUrl:function(){var a=this.getFragment();a===this.fragment&&this.iframe&&(a=this.getFragment(this.getHash(this.iframe)));if(a===this.fragment)return!1;this.iframe&&this.navigate(a);this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(a){var b=this.fragment=this.getFragment(a);return h.any(this.handlers,function(a){if(a.route.test(b))return a.callback(b),!0})},navigate:function(c,e){if(!b.History.started)return!1;
if(!e||!0===e)e={trigger:e};var g=(c||"").replace(a,"");this.fragment!==g&&(this._hasPushState?(0!==g.indexOf(this.options.root)&&(g=this.options.root+g),this.fragment=g,window.history[e.replace?"replaceState":"pushState"]({},document.title,g)):this._wantsHashChange?(this.fragment=g,this._updateHash(window.location,g,e.replace),this.iframe&&g!==this.getFragment(this.getHash(this.iframe))&&(e.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,g,e.replace))):window.location.assign(this.options.root+
c),e.trigger&&this.loadUrl(c))},_updateHash:function(a,b,c){c?(c=a.toString().replace(/(javascript:|#).*$/,""),a.replace(c+"#"+b)):a.hash=b}})})(this);
(function(g){g.Parse=g.Parse||{};var b=g.Parse,h=b._;b.Router=function(a){a=a||{};a.routes&&(this.routes=a.routes);this._bindRoutes();this.initialize.apply(this,arguments)};var a=/:\w+/g,c=/\*\w+/g,d=/[\-\[\]{}()+?.,\\\^\$\|#\s]/g;h.extend(b.Router.prototype,b.Events,{initialize:function(){},route:function(a,c,d){return b.history=b.history||new b.History,h.isRegExp(a)||(a=this._routeToRegExp(a)),d||(d=this[c]),b.history.route(a,h.bind(function(g){g=this._extractParameters(a,g);d&&d.apply(this,g);
this.trigger.apply(this,["route:"+c].concat(g));b.history.trigger("route",this,c,g)},this)),this},navigate:function(a,c){b.history.navigate(a,c)},_bindRoutes:function(){if(this.routes){var a=[],b;for(b in this.routes)this.routes.hasOwnProperty(b)&&a.unshift([b,this.routes[b]]);b=0;for(var c=a.length;b<c;b++)this.route(a[b][0],a[b][1],this[a[b][1]])}},_routeToRegExp:function(b){return b=b.replace(d,"\\$&").replace(a,"([^/]+)").replace(c,"(.*?)"),RegExp("^"+b+"$")},_extractParameters:function(a,b){return a.exec(b).slice(1)}});
b.Router.extend=b._extend})(this);(function(){L.Util.extend(L.LineUtil,{segmentsIntersect:function(g,b,h,a){return this._checkCounterclockwise(g,h,a)!==this._checkCounterclockwise(b,h,a)&&this._checkCounterclockwise(g,b,h)!==this._checkCounterclockwise(g,b,a)},_checkCounterclockwise:function(g,b,h){return(h.y-g.y)*(b.x-g.x)>(b.y-g.y)*(h.x-g.x)}});L.Polyline.include({intersects:function(){var g=this._originalPoints,b=g?g.length:0,h,a;if(this._tooFewPointsForIntersection())return!1;for(b-=1;3<=b;b--)if(h=g[b-1],a=g[b],this._lineSegmentsIntersectsRange(h,
a,b-2))return!0;return!1},newLatLngIntersects:function(g){return this._map?this.newPointIntersects(this._map.latLngToLayerPoint(g)):!1},newPointIntersects:function(g){var b=this._originalPoints,h=b?b.length:0,b=b?b[h-1]:null,h=h-2;return this._tooFewPointsForIntersection(1)?!1:this._lineSegmentsIntersectsRange(b,g,h)},_tooFewPointsForIntersection:function(g){var b=this._originalPoints,b=b?b.length:0;return b+=g||0,!this._originalPoints||3>=b},_lineSegmentsIntersectsRange:function(g,b,h,a){for(var c=
this._originalPoints,d,a=a||0,e=h;e>a;e--)if(h=c[e-1],d=c[e],L.LineUtil.segmentsIntersect(g,b,h,d))return!0;return!1}});L.Polygon.include({intersects:function(){var g,b=this._originalPoints,h,a,c,d;return this._tooFewPointsForIntersection()?!1:(g=L.Polyline.prototype.intersects.call(this),g?!0:(h=b.length,a=b[0],c=b[h-1],d=h-2,this._lineSegmentsIntersectsRange(c,a,d,1)))}});L.Handler.Draw=L.Handler.extend({includes:L.Mixin.Events,initialize:function(g,b){this._map=g;this._container=g._container;this._pane=
g._panes.overlayPane;b&&b.shapeOptions&&(b.shapeOptions=L.Util.extend({},this.options.shapeOptions,b.shapeOptions));L.Util.extend(this.options,b)},enable:function(){this.fire("activated");L.Handler.prototype.enable.call(this)},addHooks:function(){this._map&&(L.DomUtil.disableTextSelection(),this._label=L.DomUtil.create("div","leaflet-draw-label",this._pane),this._singleLineLabel=!1,L.DomEvent.addListener(window,"keyup",this._cancelDrawing,this))},removeHooks:function(){this._map&&(L.DomUtil.enableTextSelection(),
this._pane.removeChild(this._label),delete this._label,L.DomEvent.removeListener(window,"keyup",this._cancelDrawing))},_updateLabelText:function(g){g.subtext=g.subtext||"";0===g.subtext.length&&!this._singleLineLabel?(L.DomUtil.addClass(this._label,"leaflet-draw-label-single"),this._singleLineLabel=!0):0<g.subtext.length&&this._singleLineLabel&&(L.DomUtil.removeClass(this._label,"leaflet-draw-label-single"),this._singleLineLabel=!1);this._label.innerHTML=(0<g.subtext.length?'<span class="leaflet-draw-label-subtext">'+
g.subtext+"</span><br />":"")+"<span>"+g.text+"</span>"},_updateLabelPosition:function(g){L.DomUtil.setPosition(this._label,g)},_cancelDrawing:function(g){27===g.keyCode&&this.disable()}});L.Polyline.Draw=L.Handler.Draw.extend({Poly:L.Polyline,options:{allowIntersection:!0,drawError:{color:"#b00b00",message:"<strong>Error:</strong> shape edges cannot cross!",timeout:2500},icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),guidelineDistance:20,shapeOptions:{stroke:!0,
color:"#f06eaa",weight:4,opacity:0.5,fill:!1,clickable:!0}},initialize:function(g,b){b&&b.drawError&&(b.drawError=L.Util.extend({},this.options.drawError,b.drawError));L.Handler.Draw.prototype.initialize.call(this,g,b)},addHooks:function(){L.Handler.Draw.prototype.addHooks.call(this);this._map&&(this._markers=[],this._markerGroup=new L.LayerGroup,this._map.addLayer(this._markerGroup),this._poly=new L.Polyline([],this.options.shapeOptions),this._container.style.cursor="crosshair",this._updateLabelText(this._getLabelText()),
this._map.on("mousemove",this._onMouseMove,this).on("click",this._onClick,this))},removeHooks:function(){L.Handler.Draw.prototype.removeHooks.call(this);this._clearHideErrorTimeout();this._cleanUpShape();this._map.removeLayer(this._markerGroup);delete this._markerGroup;delete this._markers;this._map.removeLayer(this._poly);delete this._poly;this._clearGuides();this._container.style.cursor="";this._map.off("mousemove",this._onMouseMove).off("click",this._onClick)},_finishShape:function(){this._map.fire("draw:poly-created",
{poly:new this.Poly(this._poly.getLatLngs(),this.options.shapeOptions)});this.disable()},_onMouseMove:function(g){var b=g.layerPoint,h=this._markers.length;this._currentLatLng=g.latlng;this._updateLabelPosition(b);0<h&&(this._updateLabelText(this._getLabelText()),this._clearGuides(),this._drawGuide(this._map.latLngToLayerPoint(this._markers[h-1].getLatLng()),b));L.DomEvent.preventDefault(g)},_onClick:function(g){g=g.latlng;0<this._markers.length&&!this.options.allowIntersection&&this._poly.newLatLngIntersects(g)?
this._showErrorLabel():(this._errorShown&&this._hideErrorLabel(),this._markers.push(this._createMarker(g)),this._poly.addLatLng(g),2===this._poly.getLatLngs().length&&this._map.addLayer(this._poly),this._updateMarkerHandler(),this._vertexAdded(g))},_updateMarkerHandler:function(){1<this._markers.length&&this._markers[this._markers.length-1].on("click",this._finishShape,this);2<this._markers.length&&this._markers[this._markers.length-2].off("click",this._finishShape)},_createMarker:function(g){g=new L.Marker(g,
{icon:this.options.icon});return this._markerGroup.addLayer(g),g},_drawGuide:function(g,b){var h=Math.floor(Math.sqrt(Math.pow(b.x-g.x,2)+Math.pow(b.y-g.y,2))),a,c,d;this._guidesContainer||(this._guidesContainer=L.DomUtil.create("div","leaflet-draw-guides",this._pane));for(a=this.options.guidelineDistance;a<h;a+=this.options.guidelineDistance)c=a/h,c={x:Math.floor(g.x*(1-c)+c*b.x),y:Math.floor(g.y*(1-c)+c*b.y)},d=L.DomUtil.create("div","leaflet-draw-guide-dash",this._guidesContainer),d.style.backgroundColor=
this._errorShown?this.options.drawError.color:this.options.shapeOptions.color,L.DomUtil.setPosition(d,c)},_updateGuideColor:function(g){if(this._guidesContainer)for(var b=0,h=this._guidesContainer.childNodes.length;b<h;b++)this._guidesContainer.childNodes[b].style.backgroundColor=g},_clearGuides:function(){if(this._guidesContainer)for(;this._guidesContainer.firstChild;)this._guidesContainer.removeChild(this._guidesContainer.firstChild)},_updateLabelText:function(g){this._errorShown||L.Handler.Draw.prototype._updateLabelText.call(this,
g)},_getLabelText:function(){var g,b,h;return 0===this._markers.length?g={text:"Click to start drawing line."}:(b=this._measurementRunningTotal+this._currentLatLng.distanceTo(this._markers[this._markers.length-1].getLatLng()),h=1E3<b?(b/1E3).toFixed(2)+" km":Math.ceil(b)+" m",1===this._markers.length?g={text:"Click to continue drawing line.",subtext:h}:g={text:"Click last point to finish line.",subtext:h}),g},_showErrorLabel:function(){this._errorShown=!0;L.DomUtil.addClass(this._label,"leaflet-error-draw-label");
L.DomUtil.addClass(this._label,"leaflet-flash-anim");L.Handler.Draw.prototype._updateLabelText.call(this,{text:this.options.drawError.message});this._updateGuideColor(this.options.drawError.color);this._poly.setStyle({color:this.options.drawError.color});this._clearHideErrorTimeout();this._hideErrorTimeout=setTimeout(L.Util.bind(this._hideErrorLabel,this),this.options.drawError.timeout)},_hideErrorLabel:function(){this._errorShown=!1;this._clearHideErrorTimeout();L.DomUtil.removeClass(this._label,
"leaflet-error-draw-label");L.DomUtil.removeClass(this._label,"leaflet-flash-anim");this._updateLabelText(this._getLabelText());this._updateGuideColor(this.options.shapeOptions.color);this._poly.setStyle({color:this.options.shapeOptions.color})},_clearHideErrorTimeout:function(){this._hideErrorTimeout&&(clearTimeout(this._hideErrorTimeout),this._hideErrorTimeout=null)},_vertexAdded:function(g){1===this._markers.length?this._measurementRunningTotal=0:this._measurementRunningTotal+=g.distanceTo(this._markers[this._markers.length-
2].getLatLng())},_cleanUpShape:function(){0<this._markers.length&&this._markers[this._markers.length-1].off("click",this._finishShape)}});L.Polygon.Draw=L.Polyline.Draw.extend({Poly:L.Polygon,options:{shapeOptions:{stroke:!0,color:"#f06eaa",weight:4,opacity:0.5,fill:!0,fillColor:null,fillOpacity:0.2,clickable:!1}},_updateMarkerHandler:function(){1===this._markers.length&&this._markers[0].on("click",this._finishShape,this)},_getLabelText:function(){var g;return 0===this._markers.length?g="Click to start drawing shape.":
3>this._markers.length?g="Click to continue drawing shape.":g="Click first point to close this shape.",{text:g}},_vertexAdded:function(){},_cleanUpShape:function(){0<this._markers.length&&this._markers[0].off("click",this._finishShape)}});L.SimpleShape={};L.SimpleShape.Draw=L.Handler.Draw.extend({addHooks:function(){L.Handler.Draw.prototype.addHooks.call(this);this._map&&(this._map.dragging.disable(),this._container.style.cursor="crosshair",this._updateLabelText({text:this._initialLabelText}),this._map.on("mousedown",
this._onMouseDown,this).on("mousemove",this._onMouseMove,this))},removeHooks:function(){L.Handler.Draw.prototype.removeHooks.call(this);this._map&&(this._map.dragging.enable(),this._container.style.cursor="",this._map.off("mousedown",this._onMouseDown,this).off("mousemove",this._onMouseMove,this),L.DomEvent.off(document,"mouseup",this._onMouseUp),this._shape&&(this._map.removeLayer(this._shape),delete this._shape));this._isDrawing=!1},_onMouseDown:function(g){this._isDrawing=!0;this._startLatLng=
g.latlng;this._updateLabelText({text:"Release mouse to finish drawing."});L.DomEvent.on(document,"mouseup",this._onMouseUp,this).preventDefault(g)},_onMouseMove:function(g){var b=g.layerPoint,g=g.latlng;this._updateLabelPosition(b);this._isDrawing&&(this._updateLabelPosition(b),this._drawShape(g))},_onMouseUp:function(){this._fireCreatedEvent();this.disable()}});L.Circle.Draw=L.SimpleShape.Draw.extend({options:{shapeOptions:{stroke:!0,color:"#f06eaa",weight:4,opacity:0.5,fill:!0,fillColor:null,fillOpacity:0.2,
clickable:!0}},_initialLabelText:"Click and drag to draw circle.",_drawShape:function(g){this._shape?this._shape.setRadius(this._startLatLng.distanceTo(g)):(this._shape=new L.Circle(this._startLatLng,this._startLatLng.distanceTo(g),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){this._map.fire("draw:circle-created",{circ:new L.Circle(this._startLatLng,this._shape.getRadius(),this.options.shapeOptions)})}});L.Rectangle.Draw=L.SimpleShape.Draw.extend({options:{shapeOptions:{stroke:!0,
color:"#f06eaa",weight:4,opacity:0.5,fill:!0,fillColor:null,fillOpacity:0.2,clickable:!0}},_initialLabelText:"Click and drag to draw rectangle.",_drawShape:function(g){this._shape?this._shape.setBounds(new L.LatLngBounds(this._startLatLng,g)):(this._shape=new L.Rectangle(new L.LatLngBounds(this._startLatLng,g),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){this._map.fire("draw:rectangle-created",{rect:new L.Rectangle(this._shape.getBounds(),this.options.shapeOptions)})}});
L.Marker.Draw=L.Handler.Draw.extend({options:{icon:new L.Icon.Default},addHooks:function(){L.Handler.Draw.prototype.addHooks.call(this);this._map&&(this._updateLabelText({text:"Click map to place marker."}),this._map.on("mousemove",this._onMouseMove,this))},removeHooks:function(){L.Handler.Draw.prototype.removeHooks.call(this);this._map&&(this._marker&&(this._marker.off("click",this._onClick),this._map.off("click",this._onClick).removeLayer(this._marker),delete this._marker),this._map.off("mousemove",
this._onMouseMove))},_onMouseMove:function(g){var b=g.latlng;this._updateLabelPosition(g.layerPoint);this._marker?this._marker.setLatLng(b):(this._marker=new L.Marker(b,{icon:this.options.icon}),this._marker.on("click",this._onClick,this),this._map.on("click",this._onClick,this).addLayer(this._marker))},_onClick:function(){this._map.fire("draw:marker-created",{marker:new L.Marker(this._marker.getLatLng(),{icon:this.options.icon,draggable:!0})});this.disable()}});L.Map.mergeOptions({drawControl:!1});
L.Control.Draw=L.Control.extend({options:{position:"topleft",polyline:{title:"Draw a polyline"},polygon:{title:"Draw a polygon"},rectangle:{title:"Draw a rectangle"},circle:{title:"Draw a circle"},marker:{title:"Add a marker"}},handlers:{},initialize:function(g){L.Util.extend(this.options,g)},onAdd:function(g){var b=L.DomUtil.create("div","leaflet-control-draw");return this.options.polyline&&(this.handlers.polyline=new L.Polyline.Draw(g,this.options.polyline),this._createButton(this.options.polyline.title,
"leaflet-control-draw-polyline",b,this.handlers.polyline.enable,this.handlers.polyline),this.handlers.polyline.on("activated",this._disableInactiveModes,this)),this.options.polygon&&(this.handlers.polygon=new L.Polygon.Draw(g,this.options.polygon),this._createButton(this.options.polygon.title,"leaflet-control-draw-polygon",b,this.handlers.polygon.enable,this.handlers.polygon),this.handlers.polygon.on("activated",this._disableInactiveModes,this)),this.options.rectangle&&(this.handlers.rectangle=new L.Rectangle.Draw(g,
this.options.rectangle),this._createButton(this.options.rectangle.title,"leaflet-control-draw-rectangle",b,this.handlers.rectangle.enable,this.handlers.rectangle),this.handlers.rectangle.on("activated",this._disableInactiveModes,this)),this.options.circle&&(this.handlers.circle=new L.Circle.Draw(g,this.options.circle),this._createButton(this.options.circle.title,"leaflet-control-draw-circle",b,this.handlers.circle.enable,this.handlers.circle),this.handlers.circle.on("activated",this._disableInactiveModes,
this)),this.options.marker&&(this.handlers.marker=new L.Marker.Draw(g,this.options.marker),this._createButton(this.options.marker.title,"leaflet-control-draw-marker",b,this.handlers.marker.enable,this.handlers.marker),this.handlers.marker.on("activated",this._disableInactiveModes,this)),b},_createButton:function(g,b,h,a,c){b=L.DomUtil.create("a",b,h);return b.href="#",b.title=g,L.DomEvent.addListener(b,"click",L.DomEvent.stopPropagation).addListener(b,"click",L.DomEvent.preventDefault).addListener(b,
"click",a,c),b},_disableInactiveModes:function(){for(var g in this.handlers)this.handlers.hasOwnProperty(g)&&this.handlers[g].enabled&&this.handlers[g].disable()}});L.Map.addInitHook(function(){this.options.drawControl&&(this.drawControl=new L.Control.Draw,this.addControl(this.drawControl))})})();L.Control.FullScreen=L.Control.extend({options:{position:"topleft"},onAdd:function(g){var b,h;g.zoomControl?(h=g.zoomControl._container,b="-fullscreen last"):(h=L.DomUtil.create("div","leaflet-control-zoom"),b="-fullscreen");this._createButton("Full Screen","leaflet-control-zoom"+b,h,this.toogleFullScreen,g);return h},_createButton:function(g,b,h,a,c){b=L.DomUtil.create("a",b,h);b.href="#";b.title=g;L.DomEvent.addListener(b,"click",L.DomEvent.stopPropagation).addListener(b,"click",L.DomEvent.preventDefault).addListener(b,
"click",a,c);L.DomEvent.addListener(h,fullScreenApi.fullScreenEventName,L.DomEvent.stopPropagation).addListener(h,fullScreenApi.fullScreenEventName,L.DomEvent.preventDefault).addListener(h,fullScreenApi.fullScreenEventName,this._handleEscKey,c);L.DomEvent.addListener(document,fullScreenApi.fullScreenEventName,L.DomEvent.stopPropagation).addListener(document,fullScreenApi.fullScreenEventName,L.DomEvent.preventDefault).addListener(document,fullScreenApi.fullScreenEventName,this._handleEscKey,c);return b},
toogleFullScreen:function(){this._exitFired=!1;if(fullScreenApi.supportsFullScreen){var g=this._container;fullScreenApi.isFullScreen(g)?(fullScreenApi.cancelFullScreen(g),this.fire("exitFullscreen"),this._exitFired=!0):(fullScreenApi.requestFullScreen(g),this.fire("enterFullscreen"))}},_handleEscKey:function(){!fullScreenApi.isFullScreen(this)&&!this._exitFired&&(this.fire("exitFullscreen"),this._exitFired=!0)}});
(function(){var g={supportsFullScreen:!1,isFullScreen:function(){return!1},requestFullScreen:function(){},cancelFullScreen:function(){},fullScreenEventName:"",prefix:""},b=["webkit","moz","o","ms","khtml"];if("undefined"!=typeof document.cancelFullScreen)g.supportsFullScreen=!0;else for(var h=0,a=b.length;h<a;h++)if(g.prefix=b[h],"undefined"!=typeof document[g.prefix+"CancelFullScreen"]){g.supportsFullScreen=!0;break}g.supportsFullScreen&&(g.fullScreenEventName=g.prefix+"fullscreenchange",g.isFullScreen=
function(){switch(this.prefix){case "":return document.fullScreen;case "webkit":return document.webkitIsFullScreen;default:return document[this.prefix+"FullScreen"]}},g.requestFullScreen=function(a){return""===this.prefix?a.requestFullScreen():a[this.prefix+"RequestFullScreen"]()},g.cancelFullScreen=function(){return""===this.prefix?document.cancelFullScreen():document[this.prefix+"CancelFullScreen"]()});"undefined"!=typeof jQuery&&(jQuery.fn.requestFullScreen=function(){return this.each(function(){var a=
jQuery(this);g.supportsFullScreen&&g.requestFullScreen(a)})});window.fullScreenApi=g})();
