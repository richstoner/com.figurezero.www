var map,tlpoint,brpoint,drawnItems,pubmedLayer,dxLayer,ytLayer,vimLayer,urlLayer,geojsonViewLayer,refhighlightLayer,activeFigure,resetMap=function(){},zoomToGlobal=function(){},highlightMapGlobal=function(){},clearHighLightsGlobal=function(){},highlightRefGlobal=function(i){window.appModel.highlightRef(i)},clearRefHighLightsGlobal=function(){},zoomRefGlobal=function(){},starFigureGlobal=function(i){window.appModel.starFigure(i)};
$(function(){Parse.$=jQuery;Parse.initialize("nY5yXtyaq5zJ1TnCfGOBDa6vu9IX9WwhDJTxx6eu","2HnPlp2kBNpS66dsPdVHRlec1b8BVzKnbZc5XknC");var i=Parse.Object.extend("UploadObject",{initialize:function(){console.log("initialized FZ object")},toggle:function(){console.log("called Toggle")}});Parse.Collection.extend({model:i});var d=Parse.Object.extend("AppState",{defaults:{filter:"all"}}),g=Parse.View.extend({tagName:"div",template:_.template($("#reference-template").html()),events:{},initialize:function(){_.bindAll(this,
"render")},render:function(){$(this.el).html(this.template(this.model));return this}}),a=Parse.View.extend({tagName:"div",template:_.template($("#view-template").html()),events:{},initialize:function(){_.bindAll(this,"render")},render:function(){$(this.el).html(this.template(this.model));return this}}),b=Parse.View.extend({events:{"click #signinButton":"signInUser","click #logoutButton":"logOut","click #signin-button":"signinPressed","keypress #signup-password":"signinPressed","click #createaccount-button":"createAccountPressed",
"keypress #signup-email":"createAccountPressed"},el:".content",initialize:function(){var a=this;_.bindAll(this,"render","zoomTo","zoomRef","highlightMap","highlightRef","addFigureInfo","addAllView","addAllRefs","signInUser","logOut","starFigure","createAccountPressed","signinPressed");this.activeFigureID=$("#parseID").html();$(this.el).html(_.template($("#publish-app-template").html()));this.query=new Parse.Query(i);this.query.get(this.activeFigureID,{success:function(b){$("#activityView").hide();
$("#myTab a").click(function(a){a.preventDefault();$(this).tab("show")});$("#dropDownButton").dropdown();$("#dropDownLogin input").click(function(a){a.stopPropagation()});$("#dropDownLogin button").click(function(a){a.stopPropagation();window.appModel.signInUser()});activeFigure=$.extend(!0,{},b);7<=b.toJSON().stat&&(a.addAllRefs(),a.addAllView(),a.addFigureInfo())},error:function(){console.log("error");$("#activityView").hide();$("#dropDownButton").dropdown();$("#dropDownLogin input").click(function(a){a.stopPropagation()});
$("#dropDownLogin button").click(function(a){a.stopPropagation();window.appModel.signInUser()});alert("figure not available - it may not be public?")}})},signinPressed:function(a){if(13==a.keyCode||"click"==a.type){var c=this,a=this.$("#signup-username").val().toLowerCase(),d=this.$("#signup-password").val();Parse.User.logIn(a,d,{success:function(){$("#myModal").modal("hide");window.appModel.undelegateEvents();window.appModel=new b;delete c},error:function(){$("#error").text("Invalid username or password. Please try again.").show()}})}},
createAccountPressed:function(a){if(13==a.keyCode||"click"==a.type){var c=this,a=this.$("#signup-username").val().toLowerCase(),d=this.$("#signup-email").val(),f=this.$("#signup-password").val(),g=new Parse.User;g.set("username",a);g.set("password",f);g.set("email",d);g.set("ACL",new Parse.ACL);g.signUp(null,{success:function(){$("#myModal").modal("hide");window.appModel.undelegateEvents();window.appModel=new b;delete c},error:function(a,b){$("#error").text(b.message).show()}})}},signInUser:function(){var a=
this,c=this.$("#login-username").val(),d=this.$("#login-password").val();Parse.User.logIn(c,d,{success:function(){$("#dropDownButton").dropdown("toggle");window.appModel=new b;a.undelegateEvents();delete a},error:function(){this.$("#login-username").val("");this.$("#login-password").val("")}})},starFigure:function(a){var b=Parse.User.current(),c="/star/"+a+"/"+b.id,d="/unstar/"+a+"/"+b.id;if(b.has("starArray")){var f=$.inArray(a,b.get("starArray"));console.log(f);0<=f?($.get(d,function(a){console.log(a)}),
b.get("starArray").splice(f,1),b.save(null,{success:function(){var a='<a class="btn btn-small" onclick="starFigureGlobal(\''+activeFigure.id+'\')"><span class="icon-star"></span></a>';$("#starSpan").html(a)}})):($.get(c,function(a){console.log(a)}),b.get("starArray").push(a),b.save(null,{success:function(){var a='<a class="btn btn-warning btn-small" onclick="starFigureGlobal(\''+activeFigure.id+'\')"><span class="icon-star icon-white"></span></a>';$("#starSpan").html(a)}}))}else $.get(c,function(a){console.log(a)}),
c=[],c.push(a),b.set("starArray",c),b.save(null,{success:function(){var a='<a class="btn btn-warning btn-small" onclick="starFigureGlobal(\''+activeFigure.id+'\')"><span class="icon-star icon-white"></span></a>';$("#starSpan").html(a)}})},zoomRef:function(a){a=activeFigure.get("referenceArray")[a];a=new L.LatLng(a.geometry.coordinates[1],a.geometry.coordinates[0]);map.panTo(a)},zoomTo:function(a){var b=activeFigure.get("viewArray")[a],a=new L.LatLng(b.geometry.coordinates[1][3][1],b.geometry.coordinates[1][3][0]),
b=new L.LatLng(b.geometry.coordinates[1][1][1],b.geometry.coordinates[1][1][0]);map.fitBounds(new L.LatLngBounds(a,b))},highlightMap:function(){},highlightRef:function(){},addFigureInfo:function(){$("#figureTitle").html(activeFigure.get("figureTitle"));$("#figureDescription").html(activeFigure.get("figureDescription"));$("#figureAuthor").html(activeFigure.get("authorList"));document.title=activeFigure.get("figureTitle");$("#figureStatic").html('<img src="'+activeFigure.get("static_location")+'"/>');
var a=activeFigure.get("shortenedURL"),b=activeFigure.get("qrLinkURL"),c=activeFigure.get("tag");tag_html="";_.each(c,function(a){tag_html+='<a href="/library/#/tag/'+a+'">'+a+"</a>, "});$("#figureTags").html(tag_html);$("#qrcode").html('<a target="_blank" href="'+b+' "><img style="width:200px; height:200px;" src="'+b+'"/></a>');$("#shortLinkURL").html('<a target="_blank" href="'+a+' ">'+a+"</a>")},addAllView:function(){this.$("#viewContainer").html("");_.each(activeFigure.get("viewArray"),function(b){console.log(b);
b=new a({model:b});this.$("#viewContainer").append(b.render().el)})},addAllRefs:function(){var a=Parse.User.current(),b=Object.keys(activeFigure.getACL().permissionsById),c="";_.each(b,function(a){"*"!=a&&(c=a)});a&&(a.id==c?(console.log("this is my figure"),a='<a class="btn btn-mini btn-primary dropdown-toggle" data-toggle="dropdown" href="#">Figure options<span class="caret"></span></a><ul class="dropdown-menu"><li><a class="" href="/fz/'+activeFigure.id+'">Edit text</a></li><li><a class="" href="/roi/'+
activeFigure.id+'">Edit ROIs</a></li><li><a class="" href="/ref/'+activeFigure.id+'">Edit references</a></li></ul>'):(console.log("this is not my figure"),b=!1,0<=$.inArray(activeFigure.id,a.get("starArray"))&&(b=!0),b?(console.log("and starred"),a='<a class="btn btn-warning btn-small" onclick="starFigureGlobal(\''+activeFigure.id+'\')"><span class="icon-star icon-white"></span></a>'):(console.log("and not starred"),a='<a class="btn btn-small" onclick="starFigureGlobal(\''+activeFigure.id+'\')"><span class="icon-star"></span></a>')),
$("#starSpan").html(a));this.$("#referenceContainer").html("");_.each(activeFigure.get("referenceArray"),function(a,b){a.index=b;var c=new g({model:a});this.$("#referenceContainer").append(c.render().el)})},logOut:function(){Parse.User.logOut();window.appModel=new b;this.undelegateEvents();delete this},reloadImageView:function(){},render:function(){this.delegateEvents()}}),c=Parse.View.extend({el:$("#todoapp"),initialize:function(){this.render()},render:function(){window.appModel=new b;$("#myTab a").click(function(a){a.preventDefault();
$(this).tab("show")})}}),f=Parse.Router.extend({});new d;new f;new c});(function(){function i(a,b,c){if(a===b)return 0!==a||1/a==1/b;if(null==a||null==b)return a===b;a._chain&&(a=a._wrapped);b._chain&&(b=b._wrapped);if(a.isEqual&&e.isFunction(a.isEqual))return a.isEqual(b);if(b.isEqual&&e.isFunction(b.isEqual))return b.isEqual(a);var d=k.call(a);if(d!=k.call(b))return!1;switch(d){case "[object String]":return a==""+b;case "[object Number]":return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case "[object Date]":case "[object Boolean]":return+a==+b;case "[object RegExp]":return a.source==
b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if("object"!=typeof a||"object"!=typeof b)return!1;for(var f=c.length;f--;)if(c[f]==a)return!0;c.push(a);var f=0,h=!0;if("[object Array]"==d){if(f=a.length,h=f==b.length)for(;f--&&(h=f in a==f in b&&i(a[f],b[f],c)););}else{if("constructor"in a!="constructor"in b||a.constructor!=b.constructor)return!1;for(var g in a)if(e.has(a,g)&&(f++,!(h=e.has(b,g)&&i(a[g],b[g],c))))break;if(h){for(g in b)if(e.has(b,g)&&!f--)break;
h=!f}}c.pop();return h}var d=this,g=d._,a={},b=Array.prototype,c=Object.prototype,f=b.slice,h=b.unshift,k=c.toString,j=c.hasOwnProperty,p=b.forEach,q=b.map,r=b.reduce,n=b.reduceRight,A=b.filter,B=b.every,C=b.some,u=b.indexOf,D=b.lastIndexOf,c=Array.isArray,G=Object.keys,v=Function.prototype.bind,e=function(a){return new s(a)};"undefined"!==typeof exports?("undefined"!==typeof module&&module.exports&&(exports=module.exports=e),exports._=e):d._=e;e.VERSION="1.3.3";var m=e.each=e.forEach=function(b,
c,d){if(null!=b)if(p&&b.forEach===p)b.forEach(c,d);else if(b.length===+b.length)for(var f=0,h=b.length;f<h&&!(f in b&&c.call(d,b[f],f,b)===a);f++);else for(f in b)if(e.has(b,f)&&c.call(d,b[f],f,b)===a)break};e.map=e.collect=function(a,b,c){var d=[];if(null==a)return d;if(q&&a.map===q)return a.map(b,c);m(a,function(a,l,f){d[d.length]=b.call(c,a,l,f)});a.length===+a.length&&(d.length=a.length);return d};e.reduce=e.foldl=e.inject=function(a,b,c,d){var f=2<arguments.length;null==a&&(a=[]);if(r&&a.reduce===
r)return d&&(b=e.bind(b,d)),f?a.reduce(b,c):a.reduce(b);m(a,function(a,l,e){f?c=b.call(d,c,a,l,e):(c=a,f=!0)});if(!f)throw new TypeError("Reduce of empty array with no initial value");return c};e.reduceRight=e.foldr=function(a,b,c,d){var f=2<arguments.length;null==a&&(a=[]);if(n&&a.reduceRight===n)return d&&(b=e.bind(b,d)),f?a.reduceRight(b,c):a.reduceRight(b);var h=e.toArray(a).reverse();d&&!f&&(b=e.bind(b,d));return f?e.reduce(h,b,c,d):e.reduce(h,b)};e.find=e.detect=function(a,b,c){var d;E(a,function(a,
l,f){if(b.call(c,a,l,f))return d=a,!0});return d};e.filter=e.select=function(a,b,c){var d=[];if(null==a)return d;if(A&&a.filter===A)return a.filter(b,c);m(a,function(a,l,f){b.call(c,a,l,f)&&(d[d.length]=a)});return d};e.reject=function(a,b,c){var d=[];if(null==a)return d;m(a,function(a,l,f){b.call(c,a,l,f)||(d[d.length]=a)});return d};e.every=e.all=function(b,c,d){var f=!0;if(null==b)return f;if(B&&b.every===B)return b.every(c,d);m(b,function(b,l,e){if(!(f=f&&c.call(d,b,l,e)))return a});return!!f};
var E=e.some=e.any=function(b,c,d){c||(c=e.identity);var f=!1;if(null==b)return f;if(C&&b.some===C)return b.some(c,d);m(b,function(b,l,e){if(f||(f=c.call(d,b,l,e)))return a});return!!f};e.include=e.contains=function(a,b){return null==a?!1:u&&a.indexOf===u?-1!=a.indexOf(b):E(a,function(a){return a===b})};e.invoke=function(a,b){var c=f.call(arguments,2);return e.map(a,function(a){return(e.isFunction(b)?b||a:a[b]).apply(a,c)})};e.pluck=function(a,b){return e.map(a,function(a){return a[b]})};e.max=function(a,
b,c){if(!b&&e.isArray(a)&&a[0]===+a[0])return Math.max.apply(Math,a);if(!b&&e.isEmpty(a))return-Infinity;var d={computed:-Infinity};m(a,function(a,l,f){l=b?b.call(c,a,l,f):a;l>=d.computed&&(d={value:a,computed:l})});return d.value};e.min=function(a,b,c){if(!b&&e.isArray(a)&&a[0]===+a[0])return Math.min.apply(Math,a);if(!b&&e.isEmpty(a))return Infinity;var d={computed:Infinity};m(a,function(a,l,f){l=b?b.call(c,a,l,f):a;l<d.computed&&(d={value:a,computed:l})});return d.value};e.shuffle=function(a){var b=
[],c;m(a,function(a,l){c=Math.floor(Math.random()*(l+1));b[l]=b[c];b[c]=a});return b};e.sortBy=function(a,b,c){var d=e.isFunction(b)?b:function(a){return a[b]};return e.pluck(e.map(a,function(a,b,l){return{value:a,criteria:d.call(c,a,b,l)}}).sort(function(a,b){var l=a.criteria,c=b.criteria;return void 0===l?1:void 0===c?-1:l<c?-1:l>c?1:0}),"value")};e.groupBy=function(a,b){var c={},d=e.isFunction(b)?b:function(a){return a[b]};m(a,function(a,b){var l=d(a,b);(c[l]||(c[l]=[])).push(a)});return c};e.sortedIndex=
function(a,b,c){c||(c=e.identity);for(var d=0,f=a.length;d<f;){var h=d+f>>1;c(a[h])<c(b)?d=h+1:f=h}return d};e.toArray=function(a){return!a?[]:e.isArray(a)||e.isArguments(a)?f.call(a):a.toArray&&e.isFunction(a.toArray)?a.toArray():e.values(a)};e.size=function(a){return e.isArray(a)?a.length:e.keys(a).length};e.first=e.head=e.take=function(a,b,c){return null!=b&&!c?f.call(a,0,b):a[0]};e.initial=function(a,b,c){return f.call(a,0,a.length-(null==b||c?1:b))};e.last=function(a,b,c){return null!=b&&!c?
f.call(a,Math.max(a.length-b,0)):a[a.length-1]};e.rest=e.tail=function(a,b,c){return f.call(a,null==b||c?1:b)};e.compact=function(a){return e.filter(a,function(a){return!!a})};e.flatten=function(a,b){return e.reduce(a,function(a,c){if(e.isArray(c))return a.concat(b?c:e.flatten(c));a[a.length]=c;return a},[])};e.without=function(a){return e.difference(a,f.call(arguments,1))};e.uniq=e.unique=function(a,b,c){var c=c?e.map(a,c):a,d=[];3>a.length&&(b=!0);e.reduce(c,function(c,f,h){if(b?e.last(c)!==f||
!c.length:!e.include(c,f))c.push(f),d.push(a[h]);return c},[]);return d};e.union=function(){return e.uniq(e.flatten(arguments,!0))};e.intersection=e.intersect=function(a){var b=f.call(arguments,1);return e.filter(e.uniq(a),function(a){return e.every(b,function(b){return 0<=e.indexOf(b,a)})})};e.difference=function(a){var b=e.flatten(f.call(arguments,1),!0);return e.filter(a,function(a){return!e.include(b,a)})};e.zip=function(){for(var a=f.call(arguments),b=e.max(e.pluck(a,"length")),c=Array(b),d=
0;d<b;d++)c[d]=e.pluck(a,""+d);return c};e.indexOf=function(a,b,c){if(null==a)return-1;var d;if(c)return c=e.sortedIndex(a,b),a[c]===b?c:-1;if(u&&a.indexOf===u)return a.indexOf(b);c=0;for(d=a.length;c<d;c++)if(c in a&&a[c]===b)return c;return-1};e.lastIndexOf=function(a,b){if(null==a)return-1;if(D&&a.lastIndexOf===D)return a.lastIndexOf(b);for(var c=a.length;c--;)if(c in a&&a[c]===b)return c;return-1};e.range=function(a,b,c){1>=arguments.length&&(b=a||0,a=0);for(var c=arguments[2]||1,d=Math.max(Math.ceil((b-
a)/c),0),f=0,e=Array(d);f<d;)e[f++]=a,a+=c;return e};var F=function(){};e.bind=function(a,b){var c,d;if(a.bind===v&&v)return v.apply(a,f.call(arguments,1));if(!e.isFunction(a))throw new TypeError;d=f.call(arguments,2);return c=function(){if(!(this instanceof c))return a.apply(b,d.concat(f.call(arguments)));F.prototype=a.prototype;var e=new F,h=a.apply(e,d.concat(f.call(arguments)));return Object(h)===h?h:e}};e.bindAll=function(a){var b=f.call(arguments,1);0==b.length&&(b=e.functions(a));m(b,function(b){a[b]=
e.bind(a[b],a)});return a};e.memoize=function(a,b){var c={};b||(b=e.identity);return function(){var d=b.apply(this,arguments);return e.has(c,d)?c[d]:c[d]=a.apply(this,arguments)}};e.delay=function(a,b){var c=f.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},b)};e.defer=function(a){return e.delay.apply(e,[a,1].concat(f.call(arguments,1)))};e.throttle=function(a,b){var c,d,f,h,g,k,j=e.debounce(function(){g=h=!1},b);return function(){c=this;d=arguments;f||(f=setTimeout(function(){f=
null;g&&a.apply(c,d);j()},b));h?g=!0:k=a.apply(c,d);j();h=!0;return k}};e.debounce=function(a,b,c){var d;return function(){var f=this,e=arguments;c&&!d&&a.apply(f,e);clearTimeout(d);d=setTimeout(function(){d=null;c||a.apply(f,e)},b)}};e.once=function(a){var b=!1,c;return function(){if(b)return c;b=!0;return c=a.apply(this,arguments)}};e.wrap=function(a,b){return function(){var c=[a].concat(f.call(arguments,0));return b.apply(this,c)}};e.compose=function(){var a=arguments;return function(){for(var b=
arguments,c=a.length-1;0<=c;c--)b=[a[c].apply(this,b)];return b[0]}};e.after=function(a,b){return 0>=a?b():function(){if(1>--a)return b.apply(this,arguments)}};e.keys=G||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[],c;for(c in a)e.has(a,c)&&(b[b.length]=c);return b};e.values=function(a){return e.map(a,e.identity)};e.functions=e.methods=function(a){var b=[],c;for(c in a)e.isFunction(a[c])&&b.push(c);return b.sort()};e.extend=function(a){m(f.call(arguments,1),function(b){for(var c in b)a[c]=
b[c]});return a};e.pick=function(a){var b={};m(e.flatten(f.call(arguments,1)),function(c){c in a&&(b[c]=a[c])});return b};e.defaults=function(a){m(f.call(arguments,1),function(b){for(var c in b)null==a[c]&&(a[c]=b[c])});return a};e.clone=function(a){return!e.isObject(a)?a:e.isArray(a)?a.slice():e.extend({},a)};e.tap=function(a,b){b(a);return a};e.isEqual=function(a,b){return i(a,b,[])};e.isEmpty=function(a){if(null==a)return!0;if(e.isArray(a)||e.isString(a))return 0===a.length;for(var b in a)if(e.has(a,
b))return!1;return!0};e.isElement=function(a){return!!(a&&1==a.nodeType)};e.isArray=c||function(a){return"[object Array]"==k.call(a)};e.isObject=function(a){return a===Object(a)};e.isArguments=function(a){return"[object Arguments]"==k.call(a)};e.isArguments(arguments)||(e.isArguments=function(a){return!(!a||!e.has(a,"callee"))});e.isFunction=function(a){return"[object Function]"==k.call(a)};e.isString=function(a){return"[object String]"==k.call(a)};e.isNumber=function(a){return"[object Number]"==
k.call(a)};e.isFinite=function(a){return e.isNumber(a)&&isFinite(a)};e.isNaN=function(a){return a!==a};e.isBoolean=function(a){return!0===a||!1===a||"[object Boolean]"==k.call(a)};e.isDate=function(a){return"[object Date]"==k.call(a)};e.isRegExp=function(a){return"[object RegExp]"==k.call(a)};e.isNull=function(a){return null===a};e.isUndefined=function(a){return void 0===a};e.has=function(a,b){return j.call(a,b)};e.noConflict=function(){d._=g;return this};e.identity=function(a){return a};e.times=
function(a,b,c){for(var d=0;d<a;d++)b.call(c,d)};e.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};e.result=function(a,b){if(null==a)return null;var c=a[b];return e.isFunction(c)?c.call(a):c};e.mixin=function(a){m(e.functions(a),function(b){var c=e[b]=a[b];s.prototype[b]=function(){var a=f.call(arguments);h.call(a,this._wrapped);return w(c.apply(e,a),this._chain)}})};var H=0;e.uniqueId=
function(a){var b=H++;return a?a+b:b};e.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var x=/.^/,t={"\\":"\\","'":"'",r:"\r",n:"\n",t:"\t",u2028:"\u2028",u2029:"\u2029"},y;for(y in t)t[t[y]]=y;var I=/\\|'|\r|\n|\t|\u2028|\u2029/g,J=/\\(\\|'|r|n|t|u2028|u2029)/g,z=function(a){return a.replace(J,function(a,b){return t[b]})};e.template=function(a,b,c){c=e.defaults(c||{},e.templateSettings);a="__p+='"+a.replace(I,function(a){return"\\"+t[a]}).replace(c.escape||
x,function(a,b){return"'+\n_.escape("+z(b)+")+\n'"}).replace(c.interpolate||x,function(a,b){return"'+\n("+z(b)+")+\n'"}).replace(c.evaluate||x,function(a,b){return"';\n"+z(b)+"\n;__p+='"})+"';\n";c.variable||(a="with(obj||{}){\n"+a+"}\n");var a="var __p='';var print=function(){__p+=Array.prototype.join.call(arguments, '')};\n"+a+"return __p;\n",d=new Function(c.variable||"obj","_",a);if(b)return d(b,e);b=function(a){return d.call(this,a,e)};b.source="function("+(c.variable||"obj")+"){\n"+a+"}";return b};
e.chain=function(a){return e(a).chain()};var s=function(a){this._wrapped=a};e.prototype=s.prototype;var w=function(a,b){return b?e(a).chain():a};e.mixin(e);m("pop push reverse shift sort splice unshift".split(" "),function(a){var c=b[a];s.prototype[a]=function(){var b=this._wrapped;c.apply(b,arguments);var d=b.length;("shift"==a||"splice"==a)&&0===d&&delete b[0];return w(b,this._chain)}});m(["concat","join","slice"],function(a){var c=b[a];s.prototype[a]=function(){return w(c.apply(this._wrapped,arguments),
this._chain)}});s.prototype.chain=function(){this._chain=!0;return this};s.prototype.value=function(){return this._wrapped}}).call(this);(function(i){i.Parse=i.Parse||{};i.Parse.VERSION="1.0.18"})(this);
(function(){function i(a,b,c){if(a===b)return 0!==a||1/a==1/b;if(null==a||null==b)return a===b;a._chain&&(a=a._wrapped);b._chain&&(b=b._wrapped);if(a.isEqual&&e.isFunction(a.isEqual))return a.isEqual(b);if(b.isEqual&&e.isFunction(b.isEqual))return b.isEqual(a);var d=k.call(a);if(d!=k.call(b))return!1;switch(d){case "[object String]":return a==String(b);case "[object Number]":return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case "[object Date]":case "[object Boolean]":return+a==+b;case "[object RegExp]":return a.source==
b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if("object"!=typeof a||"object"!=typeof b)return!1;for(var f=c.length;f--;)if(c[f]==a)return!0;c.push(a);var f=0,h=!0;if("[object Array]"==d){if(f=a.length,h=f==b.length)for(;f--&&(h=f in a==f in b&&i(a[f],b[f],c)););}else{if("constructor"in a!="constructor"in b||a.constructor!=b.constructor)return!1;for(var g in a)if(e.has(a,g)&&(f++,!(h=e.has(b,g)&&i(a[g],b[g],c))))break;if(h){for(g in b)if(e.has(b,g)&&!f--)break;
h=!f}}return c.pop(),h}var d=this,g=d._,a={},b=Array.prototype,c=Object.prototype,f=b.slice,h=b.unshift,k=c.toString,j=c.hasOwnProperty,p=b.forEach,q=b.map,r=b.reduce,n=b.reduceRight,A=b.filter,B=b.every,C=b.some,u=b.indexOf,D=b.lastIndexOf,c=Array.isArray,G=Object.keys,v=Function.prototype.bind,e=function(a){return new s(a)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=e),exports._=e):d._=e;e.VERSION="1.3.3";var m=e.each=e.forEach=function(b,c,
d){if(null!=b)if(p&&b.forEach===p)b.forEach(c,d);else if(b.length===+b.length)for(var f=0,h=b.length;f<h&&!(f in b&&c.call(d,b[f],f,b)===a);f++);else for(f in b)if(e.has(b,f)&&c.call(d,b[f],f,b)===a)break};e.map=e.collect=function(a,b,c){var d=[];return null==a?d:q&&a.map===q?a.map(b,c):(m(a,function(a,f,e){d[d.length]=b.call(c,a,f,e)}),a.length===+a.length&&(d.length=a.length),d)};e.reduce=e.foldl=e.inject=function(a,b,c,d){var f=2<arguments.length;null==a&&(a=[]);if(r&&a.reduce===r)return d&&(b=
e.bind(b,d)),f?a.reduce(b,c):a.reduce(b);m(a,function(a,e,h){f?c=b.call(d,c,a,e,h):(c=a,f=!0)});if(!f)throw new TypeError("Reduce of empty array with no initial value");return c};e.reduceRight=e.foldr=function(a,b,c,d){var f=2<arguments.length;null==a&&(a=[]);if(n&&a.reduceRight===n)return d&&(b=e.bind(b,d)),f?a.reduceRight(b,c):a.reduceRight(b);var h=e.toArray(a).reverse();return d&&!f&&(b=e.bind(b,d)),f?e.reduce(h,b,c,d):e.reduce(h,b)};e.find=e.detect=function(a,b,c){var d;return E(a,function(a,
f,e){if(b.call(c,a,f,e))return d=a,!0}),d};e.filter=e.select=function(a,b,c){var d=[];return null==a?d:A&&a.filter===A?a.filter(b,c):(m(a,function(a,f,e){b.call(c,a,f,e)&&(d[d.length]=a)}),d)};e.reject=function(a,b,c){var d=[];return null==a?d:(m(a,function(a,f,e){b.call(c,a,f,e)||(d[d.length]=a)}),d)};e.every=e.all=function(b,c,d){var f=!0;return null==b?f:B&&b.every===B?b.every(c,d):(m(b,function(b,e,h){if(!(f=f&&c.call(d,b,e,h)))return a}),!!f)};var E=e.some=e.any=function(b,c,d){c||(c=e.identity);
var f=!1;return null==b?f:C&&b.some===C?b.some(c,d):(m(b,function(b,e,h){if(f||(f=c.call(d,b,e,h)))return a}),!!f)};e.include=e.contains=function(a,b){var c=!1;return null==a?c:u&&a.indexOf===u?-1!=a.indexOf(b):(c=E(a,function(a){return a===b}),c)};e.invoke=function(a,b){var c=f.call(arguments,2);return e.map(a,function(a){return(e.isFunction(b)?b||a:a[b]).apply(a,c)})};e.pluck=function(a,b){return e.map(a,function(a){return a[b]})};e.max=function(a,b,c){if(!b&&e.isArray(a)&&a[0]===+a[0])return Math.max.apply(Math,
a);if(!b&&e.isEmpty(a))return-Infinity;var d={computed:-Infinity};return m(a,function(a,f,e){f=b?b.call(c,a,f,e):a;f>=d.computed&&(d={value:a,computed:f})}),d.value};e.min=function(a,b,c){if(!b&&e.isArray(a)&&a[0]===+a[0])return Math.min.apply(Math,a);if(!b&&e.isEmpty(a))return Infinity;var d={computed:Infinity};return m(a,function(a,f,e){f=b?b.call(c,a,f,e):a;f<d.computed&&(d={value:a,computed:f})}),d.value};e.shuffle=function(a){var b=[],c;return m(a,function(a,d){c=Math.floor(Math.random()*(d+
1));b[d]=b[c];b[c]=a}),b};e.sortBy=function(a,b,c){var d=e.isFunction(b)?b:function(a){return a[b]};return e.pluck(e.map(a,function(a,b,f){return{value:a,criteria:d.call(c,a,b,f)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;return void 0===c?1:void 0===d?-1:c<d?-1:c>d?1:0}),"value")};e.groupBy=function(a,b){var c={},d=e.isFunction(b)?b:function(a){return a[b]};return m(a,function(a,b){var f=d(a,b);(c[f]||(c[f]=[])).push(a)}),c};e.sortedIndex=function(a,b,c){c||(c=e.identity);for(var d=0,f=
a.length;d<f;){var h=d+f>>1;c(a[h])<c(b)?d=h+1:f=h}return d};e.toArray=function(a){return a?e.isArray(a)?f.call(a):e.isArguments(a)?f.call(a):a.toArray&&e.isFunction(a.toArray)?a.toArray():e.values(a):[]};e.size=function(a){return e.isArray(a)?a.length:e.keys(a).length};e.first=e.head=e.take=function(a,b,c){return null!=b&&!c?f.call(a,0,b):a[0]};e.initial=function(a,b,c){return f.call(a,0,a.length-(null==b||c?1:b))};e.last=function(a,b,c){return null!=b&&!c?f.call(a,Math.max(a.length-b,0)):a[a.length-
1]};e.rest=e.tail=function(a,b,c){return f.call(a,null==b||c?1:b)};e.compact=function(a){return e.filter(a,function(a){return!!a})};e.flatten=function(a,b){return e.reduce(a,function(a,c){return e.isArray(c)?a.concat(b?c:e.flatten(c)):(a[a.length]=c,a)},[])};e.without=function(a){return e.difference(a,f.call(arguments,1))};e.uniq=e.unique=function(a,b,c){var c=c?e.map(a,c):a,d=[];return 3>a.length&&(b=!0),e.reduce(c,function(c,f,h){if(b?e.last(c)!==f||!c.length:!e.include(c,f))c.push(f),d.push(a[h]);
return c},[]),d};e.union=function(){return e.uniq(e.flatten(arguments,!0))};e.intersection=e.intersect=function(a){var b=f.call(arguments,1);return e.filter(e.uniq(a),function(a){return e.every(b,function(b){return 0<=e.indexOf(b,a)})})};e.difference=function(a){var b=e.flatten(f.call(arguments,1),!0);return e.filter(a,function(a){return!e.include(b,a)})};e.zip=function(){for(var a=f.call(arguments),b=e.max(e.pluck(a,"length")),c=Array(b),d=0;d<b;d++)c[d]=e.pluck(a,""+d);return c};e.indexOf=function(a,
b,c){if(null==a)return-1;var d;if(c)return d=e.sortedIndex(a,b),a[d]===b?d:-1;if(u&&a.indexOf===u)return a.indexOf(b);d=0;for(c=a.length;d<c;d++)if(d in a&&a[d]===b)return d;return-1};e.lastIndexOf=function(a,b){if(null==a)return-1;if(D&&a.lastIndexOf===D)return a.lastIndexOf(b);for(var c=a.length;c--;)if(c in a&&a[c]===b)return c;return-1};e.range=function(a,b,c){1>=arguments.length&&(b=a||0,a=0);for(var c=arguments[2]||1,d=Math.max(Math.ceil((b-a)/c),0),f=0,e=Array(d);f<d;)e[f++]=a,a+=c;return e};
var F=function(){};e.bind=function(a,b){var c,d;if(a.bind===v&&v)return v.apply(a,f.call(arguments,1));if(!e.isFunction(a))throw new TypeError;return d=f.call(arguments,2),c=function(){if(this instanceof c){F.prototype=a.prototype;var e=new F,h=a.apply(e,d.concat(f.call(arguments)));return Object(h)===h?h:e}return a.apply(b,d.concat(f.call(arguments)))}};e.bindAll=function(a){var b=f.call(arguments,1);return 0==b.length&&(b=e.functions(a)),m(b,function(b){a[b]=e.bind(a[b],a)}),a};e.memoize=function(a,
b){var c={};return b||(b=e.identity),function(){var d=b.apply(this,arguments);return e.has(c,d)?c[d]:c[d]=a.apply(this,arguments)}};e.delay=function(a,b){var c=f.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},b)};e.defer=function(a){return e.delay.apply(e,[a,1].concat(f.call(arguments,1)))};e.throttle=function(a,b){var c,d,f,h,g,k,j=e.debounce(function(){g=h=!1},b);return function(){c=this;d=arguments;return f||(f=setTimeout(function(){f=null;g&&a.apply(c,d);j()},b)),h?g=!0:
k=a.apply(c,d),j(),h=!0,k}};e.debounce=function(a,b,c){var d;return function(){var f=this,e=arguments;c&&!d&&a.apply(f,e);clearTimeout(d);d=setTimeout(function(){d=null;c||a.apply(f,e)},b)}};e.once=function(a){var b=!1,c;return function(){return b?c:(b=!0,c=a.apply(this,arguments))}};e.wrap=function(a,b){return function(){var c=[a].concat(f.call(arguments,0));return b.apply(this,c)}};e.compose=function(){var a=arguments;return function(){for(var b=arguments,c=a.length-1;0<=c;c--)b=[a[c].apply(this,
b)];return b[0]}};e.after=function(a,b){return 0>=a?b():function(){if(1>--a)return b.apply(this,arguments)}};e.keys=G||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[],c;for(c in a)e.has(a,c)&&(b[b.length]=c);return b};e.values=function(a){return e.map(a,e.identity)};e.functions=e.methods=function(a){var b=[],c;for(c in a)e.isFunction(a[c])&&b.push(c);return b.sort()};e.extend=function(a){return m(f.call(arguments,1),function(b){for(var c in b)a[c]=b[c]}),a};e.pick=function(a){var b=
{};return m(e.flatten(f.call(arguments,1)),function(c){c in a&&(b[c]=a[c])}),b};e.defaults=function(a){return m(f.call(arguments,1),function(b){for(var c in b)null==a[c]&&(a[c]=b[c])}),a};e.clone=function(a){return e.isObject(a)?e.isArray(a)?a.slice():e.extend({},a):a};e.tap=function(a,b){return b(a),a};e.isEqual=function(a,b){return i(a,b,[])};e.isEmpty=function(a){if(null==a)return!0;if(e.isArray(a)||e.isString(a))return 0===a.length;for(var b in a)if(e.has(a,b))return!1;return!0};e.isElement=function(a){return!!a&&
1==a.nodeType};e.isArray=c||function(a){return"[object Array]"==k.call(a)};e.isObject=function(a){return a===Object(a)};e.isArguments=function(a){return"[object Arguments]"==k.call(a)};e.isArguments(arguments)||(e.isArguments=function(a){return!!a&&!!e.has(a,"callee")});e.isFunction=function(a){return"[object Function]"==k.call(a)};e.isString=function(a){return"[object String]"==k.call(a)};e.isNumber=function(a){return"[object Number]"==k.call(a)};e.isFinite=function(a){return e.isNumber(a)&&isFinite(a)};
e.isNaN=function(a){return a!==a};e.isBoolean=function(a){return!0===a||!1===a||"[object Boolean]"==k.call(a)};e.isDate=function(a){return"[object Date]"==k.call(a)};e.isRegExp=function(a){return"[object RegExp]"==k.call(a)};e.isNull=function(a){return null===a};e.isUndefined=function(a){return void 0===a};e.has=function(a,b){return j.call(a,b)};e.noConflict=function(){return d._=g,this};e.identity=function(a){return a};e.times=function(a,b,c){for(var d=0;d<a;d++)b.call(c,d)};e.escape=function(a){return(""+
a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};e.result=function(a,b){if(null==a)return null;var c=a[b];return e.isFunction(c)?c.call(a):c};e.mixin=function(a){m(e.functions(a),function(b){var c=e[b]=a[b];s.prototype[b]=function(){var a=f.call(arguments);return h.call(a,this._wrapped),w(c.apply(e,a),this._chain)}})};var H=0;e.uniqueId=function(a){var b=H++;return a?a+b:b};e.templateSettings={evaluate:/<%([\s\S]+?)%>/g,
interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var x=/.^/,t={"\\":"\\","'":"'",r:"\r",n:"\n",t:"\t",u2028:"\u2028",u2029:"\u2029"},y;for(y in t)t[t[y]]=y;var I=/\\|'|\r|\n|\t|\u2028|\u2029/g,J=/\\(\\|'|r|n|t|u2028|u2029)/g,z=function(a){return a.replace(J,function(a,b){return t[b]})};e.template=function(a,b,c){c=e.defaults(c||{},e.templateSettings);a="__p+='"+a.replace(I,function(a){return"\\"+t[a]}).replace(c.escape||x,function(a,b){return"'+\n_.escape("+z(b)+")+\n'"}).replace(c.interpolate||
x,function(a,b){return"'+\n("+z(b)+")+\n'"}).replace(c.evaluate||x,function(a,b){return"';\n"+z(b)+"\n;__p+='"})+"';\n";c.variable||(a="with(obj||{}){\n"+a+"}\n");var a="var __p='';var print=function(){__p+=Array.prototype.join.call(arguments, '')};\n"+a+"return __p;\n",d=new Function(c.variable||"obj","_",a);if(b)return d(b,e);b=function(a){return d.call(this,a,e)};return b.source="function("+(c.variable||"obj")+"){\n"+a+"}",b};e.chain=function(a){return e(a).chain()};var s=function(a){this._wrapped=
a};e.prototype=s.prototype;var w=function(a,b){return b?e(a).chain():a};e.mixin(e);m("pop push reverse shift sort splice unshift".split(" "),function(a){var c=b[a];s.prototype[a]=function(){var b=this._wrapped;c.apply(b,arguments);var d=b.length;return("shift"==a||"splice"==a)&&0===d&&delete b[0],w(b,this._chain)}});m(["concat","join","slice"],function(a){var c=b[a];s.prototype[a]=function(){return w(c.apply(this._wrapped,arguments),this._chain)}});s.prototype.chain=function(){return this._chain=
!0,this};s.prototype.value=function(){return this._wrapped}}).call(this);
(function(i){i.Parse=i.Parse||{};var d=i.Parse;"undefined"!=typeof exports&&exports._?(d._=exports._.noConflict(),exports.Parse=d):d._=_.noConflict();"undefined"!=typeof $&&(d.$=$);var g=function(){};d.serverURL="https://api.parse.com";d.initialize=function(a,b){d._initialize(a,b)};d._initialize=function(a,b,c){d.applicationId=a;d.javaScriptKey=b;d.masterKey=c;d._useMasterKey=!1};d._getParsePath=function(a){if(!d.applicationId)throw"You need to call Parse.initialize before using Parse.";a||(a="");
if(!d._.isString(a))throw"Tried to get a localStorage path that wasn't a String.";return"/"===a[0]&&(a=a.substring(1)),"Parse/"+d.applicationId+"/"+a};d._installationId=null;d._getInstallationId=function(){if(d._installationId)return d._installationId;var a=d._getParsePath("installationId");d._installationId=localStorage.getItem(a);if(!d._installationId||""===d._installationId){var b=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)};d._installationId=b()+b()+"-"+b()+
"-"+b()+"-"+b()+"-"+b()+b()+b();localStorage.setItem(a,d._installationId)}return d._installationId};d._parseDate=function(a){a=/^([0-9]{1,4})-([0-9]{1,2})-([0-9]{1,2})T([0-9]{1,2}):([0-9]{1,2}):([0-9]{1,2})(.([0-9]+))?Z$/.exec(a);return!a?null:new Date(Date.UTC(a[1]||0,(a[2]||1)-1,a[3]||0,a[4]||0,a[5]||0,a[6]||0,a[8]||0))};d._ajaxIE8=function(a,b,c,d,h){var g=new XDomainRequest;g.onload=function(){var a;try{a=JSON.parse(g.responseText)}catch(b){h&&h(g)}a&&d&&d(a,g)};g.onerror=g.ontimeout=function(){h(g)};
g.onprogress=function(){};g.open(a,b);g.send(c)};d._ajax=function(a,b,c,f,h){if("undefined"!=typeof XDomainRequest)return d._ajaxIE8(a,b,c,f,h);var g=!1,j=new XMLHttpRequest;j.onreadystatechange=function(){if(4===j.readyState&&!g)if(g=!0,200<=j.status&&300>j.status){var a;try{a=JSON.parse(j.responseText)}catch(b){h&&h(j)}a&&f&&f(a,j)}else h&&h(j)};j.open(a,b,!0);j.setRequestHeader("Content-Type","text/plain");j.send(c)};d._extend=function(a,b){var c,f=this,h;c=(a&&a.hasOwnProperty("constructor")?
h=a.constructor:h=function(){f.apply(this,arguments)},d._.extend(h,f),g.prototype=f.prototype,h.prototype=new g,a&&d._.extend(h.prototype,a),b&&d._.extend(h,b),h.prototype.constructor=h,h.__super__=f.prototype,h);return c.extend=this.extend,c};d._request=function(a,b,c,f,h,g){if(!d.applicationId)throw"You must specify your applicationId using Parse.initialize";if(!d.javaScriptKey&&!d.masterKey)throw"You must specify a key using Parse.initialize";if("classes"!==a&&"users"!==a&&"login"!==a&&"requestPasswordReset"!==
a)throw"First argument must be one of classes, users, or login, not '"+a+"'.";a=d.serverURL+"/1/"+a;b&&(a+="/"+b);c&&(a+="/"+c);h=d._.clone(h||{});"POST"!==f&&(h._method=f,f="POST");h._ApplicationId=d.applicationId;d._useMasterKey?h._MasterKey=d.masterKey:h._JavaScriptKey=d.javaScriptKey;h._ClientVersion="js"+d.VERSION;h._InstallationId=d._getInstallationId();(b=d.User.current())&&b._sessionToken&&(h._SessionToken=b._sessionToken);h=JSON.stringify(h);d._ajax(f,a,h,g.success,g.error)};d._getValue=
function(a,b){return!a||!a[b]?null:d._.isFunction(a[b])?a[b]():a[b]};d._encode=function(a,b){var c=d._;if(a instanceof d.Object){if(!b||c.include(b,a)||!a._hasData)return a._toPointer();if(!a.dirty())return b=b.concat(a),d._encode(a._toFullJSON(b),b);throw"Can't fully embed a dirty object";}if(a instanceof d.ACL)return a.toJSON();if(a instanceof Date)return{__type:"Date",iso:a.toJSON()};if(a instanceof d.GeoPoint)return a.toJSON();if(c.isArray(a))return c.map(a,function(a){return d._encode(a,b)});
if(c.isRegExp(a))return a.source;if(a instanceof d.Relation||a instanceof d.Op)return a.toJSON();if(a instanceof Object){var f={};return d._each(a,function(a,c){f[c]=d._encode(a,b)}),f}return a};d._decode=function(a,b){var c=d._;return!c.isObject(b)?b:c.isArray(b)?(d._each(b,function(a,c){b[c]=d._decode(c,a)}),b):b instanceof d.Object||b instanceof d.Op?b:b.__op?d.Op._decode(b):b.objectId?"Pointer"===b.__type?(c=d.Object._create(b.className),c._finishFetch({objectId:b.objectId},!1),c):"Object"===
b.__type?(c=b.className,delete b.__type,delete b.className,c=d.Object._create(c),c._finishFetch(b,!0),c):(d._each(b,function(a,c){b[c]=d._decode(c,a)}),d.Object._create(b.className,b)):"Date"===b.__type?d._parseDate(b.iso):"GeoPoint"===b.__type?new d.GeoPoint({latitude:b.latitude,longitude:b.longitude}):"ACL"===a?b instanceof d.ACL?b:new d.ACL(b):"Relation"===b.__type?(c=new d.Relation(null,a),c.targetClassName=b.className,c):b};d._each=function(a,b){var c=d._;c.isObject(a)?c.each(c.keys(a),function(c){b(a[c],
c)}):c.each(a,b)};d._isNullOrUndefined=function(a){return d._.isNull(a)||d._.isUndefined(a)}})(this);
(function(i){i.Parse=i.Parse||{};var i=i.Parse,d=i._;i.Error=function(d,a){this.code=d;this.message=a};d.extend(i.Error,{OTHER_CAUSE:-1,INTERNAL_SERVER_ERROR:1,CONNECTION_FAILED:100,OBJECT_NOT_FOUND:101,INVALID_QUERY:102,INVALID_CLASS_NAME:103,MISSING_OBJECT_ID:104,INVALID_KEY_NAME:105,INVALID_POINTER:106,INVALID_JSON:107,COMMAND_UNAVAILABLE:108,NOT_INITIALIZED:109,INCORRECT_TYPE:111,INVALID_CHANNEL_NAME:112,PUSH_MISCONFIGURED:115,OBJECT_TOO_LARGE:116,OPERATION_FORBIDDEN:119,CACHE_MISS:120,INVALID_NESTED_KEY:121,
INVALID_FILE_NAME:122,INVALID_ACL:123,TIMEOUT:124,INVALID_EMAIL_ADDRESS:125,DUPLICATE_VALUE:137,INVALID_ROLE_NAME:139,EXCEEDED_QUOTA:140,USERNAME_MISSING:200,PASSWORD_MISSING:201,USERNAME_TAKEN:202,EMAIL_TAKEN:203,EMAIL_MISSING:204,EMAIL_NOT_FOUND:205,SESSION_MISSING:206,MUST_CREATE_USER_THROUGH_SIGNUP:207,ACCOUNT_ALREADY_LINKED:208,LINKED_ID_MISSING:250,INVALID_LINKED_SESSION:251,UNSUPPORTED_SERVICE:252})})(this);
(function(){var i=this.Parse||(this.Parse={}),d=/\s+/,g=Array.prototype.slice;i.Events={on:function(a,b,c){var f,h,g,j,i;if(!b)return this;a=a.split(d);f=this._callbacks||(this._callbacks={});for(h=a.shift();h;)g=(i=f[h])?i.tail:{},g.next=j={},g.context=c,g.callback=b,f[h]={tail:j,next:i?i.next:g},h=a.shift();return this},off:function(a,b,c){var f,h,g,j,i,q;if(h=this._callbacks){if(!a&&!b&&!c)return delete this._callbacks,this;a=a?a.split(d):_.keys(h);for(f=a.shift();f;)if(g=h[f],delete h[f],g&&(b||
c)){j=g.tail;for(g=g.next;g!==j;)i=g.callback,q=g.context,(b&&i!==b||c&&q!==c)&&this.on(f,i,q),g=g.next;f=a.shift()}return this}},trigger:function(a){var b,c,f,h,k,j;if(!(f=this._callbacks))return this;k=f.all;a=a.split(d);j=g.call(arguments,1);for(b=a.shift();b;){if(c=f[b])for(h=c.tail;(c=c.next)!==h;)c.callback.apply(c.context||this,j);if(c=k){h=c.tail;for(b=[b].concat(j);(c=c.next)!==h;)c.callback.apply(c.context||this,b)}b=a.shift()}return this}};i.Events.bind=i.Events.on;i.Events.unbind=i.Events.off}).call(this);
(function(i){i.Parse=i.Parse||{};var d=i.Parse,g=d._;d.GeoPoint=function(a,b){g.isArray(a)?(d.GeoPoint._validate(a[0],a[1]),this.latitude=a[0],this.longitude=a[1]):g.isObject(a)?(d.GeoPoint._validate(a.latitude,a.longitude),this.latitude=a.latitude,this.longitude=a.longitude):g.isNumber(a)&&g.isNumber(b)?(d.GeoPoint._validate(a,b),this.latitude=a,this.longitude=b):(this.latitude=0,this.longitude=0);var c=this;this.__defineGetter__&&this.__defineSetter__&&(this._latitude=this.latitude,this._longitude=
this.longitude,this.__defineGetter__("latitude",function(){return c._latitude}),this.__defineGetter__("longitude",function(){return c._longitude}),this.__defineSetter__("latitude",function(a){d.GeoPoint._validate(a,c.longitude);c._latitude=a}),this.__defineSetter__("longitude",function(a){d.GeoPoint._validate(c.latitude,a);c._longitude=a}))};d.GeoPoint._validate=function(a,b){if(-90>a)throw"Parse.GeoPoint latitude "+a+" < -90.0.";if(90<a)throw"Parse.GeoPoint latitude "+a+" > 90.0.";if(-180>b)throw"Parse.GeoPoint longitude "+
b+" < -180.0.";if(180<b)throw"Parse.GeoPoint longitude "+b+" > 180.0.";};d.GeoPoint.current=function(a){navigator.geolocation.getCurrentPosition(function(b){a.success&&a.success(new d.GeoPoint({latitude:b.coords.latitude,longitude:b.coords.longitude}))},function(b){a.error&&a.error(b)})};d.GeoPoint.prototype={toJSON:function(){return d.GeoPoint._validate(this.latitude,this.longitude),{__type:"GeoPoint",latitude:this.latitude,longitude:this.longitude}},radiansTo:function(a){var b=Math.PI/180,c=this.latitude*
b,d=a.latitude*b,b=this.longitude*b-a.longitude*b,a=Math.sin((c-d)/2),b=Math.sin(b/2),c=a*a+Math.cos(c)*Math.cos(d)*b*b;return c=Math.min(1,c),2*Math.asin(Math.sqrt(c))},kilometersTo:function(a){return 6371*this.radiansTo(a)},milesTo:function(a){return 3958.8*this.radiansTo(a)}}})(this);
(function(i){i.Parse=i.Parse||{};var d=i.Parse,g=d._;d.ACL=function(a){var b=this;b.permissionsById={};if(g.isObject(a))if(a instanceof d.User)b.setReadAccess(a,!0),b.setWriteAccess(a,!0);else{if(g.isFunction(a))throw"Parse.ACL() called with a function.  Did you forget ()?";d._each(a,function(a,f){if(!g.isString(f))throw"Tried to create an ACL with an invalid userId.";b.permissionsById[f]={};d._each(a,function(a,c){if("read"!==c&&"write"!==c)throw"Tried to create an ACL with an invalid permission type.";
if(!g.isBoolean(a))throw"Tried to create an ACL with an invalid permission value.";b.permissionsById[f][c]=a})})}};d.ACL.prototype.toJSON=function(){return g.clone(this.permissionsById)};d.ACL.prototype._setAccess=function(a,b,c){b instanceof d.User?b=b.id:b instanceof d.Role&&(b="role:"+b.getName());if(!g.isString(b))throw"userId must be a string.";if(!g.isBoolean(c))throw"allowed must be either true or false.";var f=this.permissionsById[b];if(!f){if(!c)return;f={};this.permissionsById[b]=f}c?this.permissionsById[b][a]=
!0:(delete f[a],g.isEmpty(f)&&delete f[b])};d.ACL.prototype._getAccess=function(a,b){b instanceof d.User?b=b.id:b instanceof d.Role&&(b="role:"+b.getName());var c=this.permissionsById[b];return c?c[a]?!0:!1:!1};d.ACL.prototype.setReadAccess=function(a,b){this._setAccess("read",a,b)};d.ACL.prototype.getReadAccess=function(a){return this._getAccess("read",a)};d.ACL.prototype.setWriteAccess=function(a,b){this._setAccess("write",a,b)};d.ACL.prototype.getWriteAccess=function(a){return this._getAccess("write",
a)};d.ACL.prototype.setPublicReadAccess=function(a){this.setReadAccess("*",a)};d.ACL.prototype.getPublicReadAccess=function(){return this.getReadAccess("*")};d.ACL.prototype.setPublicWriteAccess=function(a){this.setWriteAccess("*",a)};d.ACL.prototype.getPublicWriteAccess=function(){return this.getWriteAccess("*")};d.ACL.prototype.getRoleReadAccess=function(a){a instanceof d.Role&&(a=a.getName());if(g.isString(a))return this.getReadAccess("role:"+a);throw"role must be a Parse.Role or a String";};d.ACL.prototype.getRoleWriteAccess=
function(a){a instanceof d.Role&&(a=a.getName());if(g.isString(a))return this.getWriteAccess("role:"+a);throw"role must be a Parse.Role or a String";};d.ACL.prototype.setRoleReadAccess=function(a,b){a instanceof d.Role&&(a=a.getName());if(g.isString(a))this.setReadAccess("role:"+a,b);else throw"role must be a Parse.Role or a String";};d.ACL.prototype.setRoleWriteAccess=function(a,b){a instanceof d.Role&&(a=a.getName());if(g.isString(a))this.setWriteAccess("role:"+a,b);else throw"role must be a Parse.Role or a String";
}})(this);
(function(i){i.Parse=i.Parse||{};var d=i.Parse,g=d._;d.Op=function(){this._initialize.apply(this,arguments)};d.Op.prototype={_initialize:function(){}};g.extend(d.Op,{_extend:d._extend,_opDecoderMap:{},_registerDecoder:function(a,b){d.Op._opDecoderMap[a]=b},_decode:function(a){var b=d.Op._opDecoderMap[a.__op];return b?b(a):void 0}});d.Op._registerDecoder("Batch",function(a){var b=null;return g.each(a.ops,function(a){a=d.Op._decode(a);b=a._mergeWithPrevious(b)}),b});d.Op.Set=d.Op._extend({_initialize:function(a){this._value=a},
value:function(){return this._value},toJSON:function(){return d._encode(this.value())},_mergeWithPrevious:function(){return this},_estimate:function(){return this.value()}});d.Op._UNSET={};d.Op.Unset=d.Op._extend({toJSON:function(){return{__op:"Delete"}},_mergeWithPrevious:function(){return this},_estimate:function(){return d.Op._UNSET}});d.Op._registerDecoder("Delete",function(){return new d.Op.Unset});d.Op.Increment=d.Op._extend({_initialize:function(a){this._amount=a},amount:function(){return this._amount},
toJSON:function(){return{__op:"Increment",amount:this._amount}},_mergeWithPrevious:function(a){if(!a)return this;if(a instanceof d.Op.Unset)return new d.Op.Set(this.amount());if(a instanceof d.Op.Set)return new d.Op.Set(a.value()+this.amount());if(a instanceof d.Op.Increment)return new d.Op.Increment(this.amount()+a.amount());throw"Op is invalid after previous op.";},_estimate:function(a){return a?a+this.amount():this.amount()}});d.Op._registerDecoder("Increment",function(a){return new d.Op.Increment(a.amount)});
d.Op.Add=d.Op._extend({_initialize:function(a){this._objects=a},objects:function(){return this._objects},toJSON:function(){return{__op:"Add",objects:this.objects()}},_mergeWithPrevious:function(a){if(!a)return this;if(a instanceof d.Op.Unset)return new d.Op.Set(this.objects());if(a instanceof d.Op.Set)return new d.Op.Set(this._estimate(a.value()));if(a instanceof d.Op.Add)return new d.Op.Add(a.objects().concat(this.objects()));throw"Op is invalid after previous op.";},_estimate:function(a){return a?
a.concat(this.objects()):g.clone(this.objects())}});d.Op._registerDecoder("Add",function(a){return new d.Op.Add(d._decode(a.objects))});d.Op.AddUnique=d.Op._extend({_initialize:function(a){this._objects=g.uniq(a)},objects:function(){return this._objects},toJSON:function(){return{__op:"AddUnique",objects:this.objects()}},_mergeWithPrevious:function(a){if(!a)return this;if(a instanceof d.Op.Unset)return new d.Op.Set(this.objects());if(a instanceof d.Op.Set)return new d.Op.Set(this._estimate(a.value()));
if(a instanceof d.Op.AddUnique)return new d.Op.AddUnique(g.union(a.objects(),this.objects()));throw"Op is invalid after previous op.";},_estimate:function(a){return a?a.concat(g.difference(this.objects(),a)):g.clone(this.objects())}});d.Op._registerDecoder("AddUnique",function(a){return new d.Op.AddUnique(d._decode(a.objects))});d.Op.Remove=d.Op._extend({_initialize:function(a){this._objects=g.uniq(a)},objects:function(){return this._objects},toJSON:function(){return{__op:"Remove",objects:this.objects()}},
_mergeWithPrevious:function(a){if(!a)return this;if(a instanceof d.Op.Unset)return a;if(a instanceof d.Op.Set)return new d.Op.Set(this._estimate(a.value()));if(a instanceof d.Op.Remove)return new d.Op.Remove(g.union(a.objects(),this.objects()));throw"Op is invalid after previous op.";},_estimate:function(a){return a?g.difference(a,this.objects()):[]}});d.Op._registerDecoder("Remove",function(a){return new d.Op.Remove(d._decode(a.objects))});d.Op.Relation=d.Op._extend({_initialize:function(a,b){this._targetClassName=
null;var c=this,f=function(a){if(a instanceof d.Object){if(!a.id)throw"You can't add an unsaved Parse.Object to a relation.";c._targetClassName||(c._targetClassName=a.className);if(c._targetClassName!==a.className)throw"Tried to create a Parse.Relation with 2 different types: "+c._targetClassName+" and "+a.className+".";return a.id}return a};this.relationsToAdd=g.uniq(g.map(a,f));this.relationsToRemove=g.uniq(g.map(b,f))},added:function(){var a=this;return g.map(this.relationsToAdd,function(b){var c=
d.Object._create(a._targetClassName);return c.id=b,c})},removed:function(){var a=this;return g.map(this.relationsToRemove,function(b){var c=d.Object._create(a._targetClassName);return c.id=b,c})},toJSON:function(){var a=null,b=null,c=this,d=function(a){return{__type:"Pointer",className:c._targetClassName,objectId:a}},h=null;return 0<this.relationsToAdd.length&&(h=g.map(this.relationsToAdd,d),a={__op:"AddRelation",objects:h}),0<this.relationsToRemove.length&&(h=g.map(this.relationsToRemove,d),b={__op:"RemoveRelation",
objects:h}),a&&b?{__op:"Batch",ops:[a,b]}:a||b||{}},_mergeWithPrevious:function(a){if(!a)return this;if(a instanceof d.Op.Unset)throw"You can't modify a relation after deleting it.";if(a instanceof d.Op.Relation){if(a._targetClassName&&a._targetClassName!==this._targetClassName)throw"Related object must be of class "+a._targetClassName+", but "+this._targetClassName+" was passed in.";var b=g.union(g.difference(a.relationsToAdd,this.relationsToRemove),this.relationsToAdd),a=g.union(g.difference(a.relationsToRemove,
this.relationsToAdd),this.relationsToRemove),b=new d.Op.Relation(b,a);return b._targetClassName=this._targetClassName,b}throw"Op is invalid after previous op.";},_estimate:function(a,b,c){if(a){if(a instanceof d.Relation){if(this._targetClassName)if(a.targetClassName){if(a.targetClassName!==this._targetClassName)throw"Related object must be a "+a.targetClassName+", but a "+this._targetClassName+" was passed in.";}else a.targetClassName=this._targetClassName;return a}throw"Op is invalid after previous op.";
}(new d.Relation(b,c)).targetClassName=this._targetClassName}});d.Op._registerDecoder("AddRelation",function(a){return new d.Op.Relation(a.objects,[])});d.Op._registerDecoder("RemoveRelation",function(a){return new d.Op.Relation([],a.objects)})})(this);
(function(i){i.Parse=i.Parse||{};var d=i.Parse,g=d._;d.Relation=function(a,b){this.parent=a;this.key=b;this.targetClassName=null};d.Relation.prototype={_ensureParentAndKey:function(a,b){this.parent=this.parent||a;this.key=this.key||b;if(this.parent!==a)throw"Internal Error. Relation retrieved from two different Objects.";if(this.key!==b)throw"Internal Error. Relation retrieved from two different keys.";},add:function(a){g.isArray(a)||(a=[a]);a=new d.Op.Relation(a,[]);this.parent.set(this.key,a);this.targetClassName=
a._targetClassName},remove:function(a){g.isArray(a)||(a=[a]);a=new d.Op.Relation([],a);this.parent.set(this.key,a);this.targetClassName=a._targetClassName},toJSON:function(){return{__type:"Relation",className:this.targetClassName}},query:function(){var a=d.Object._getSubclass(this.targetClassName),a=new d.Query(a);return a._addCondition("$relatedTo","object",this.parent._toPointer()),a._addCondition("$relatedTo","key",this.key),a}}})(this);
(function(i){i.Parse=i.Parse||{};var d=i.Parse,g=d._;d.Object=function(a,c){if(g.isString(a))return d.Object._create.apply(this,arguments);a=a||{};c&&c.parse&&(a=this.parse(a));var f=d._getValue(this,"defaults");f&&(a=g.extend({},f,a));c&&c.collection&&(this.collection=c.collection);this._serverData={};this._opSetQueue=[{}];this.attributes={};this._hashedJSON={};this._escapedAttributes={};this.cid=g.uniqueId("c");this.changed={};this._silent={};this._pending={};if(!this.set(a,{silent:!0}))throw Error("Can't create an invalid Parse.Object");
this.changed={};this._silent={};this._pending={};this._hasData=!0;this._previousAttributes=g.clone(this.attributes);this.initialize.apply(this,arguments)};var a=function(b,c,d,h){var d=d||[],k;k=g.isFunction(h)?{success:function(a){h(a,null)},error:function(a){h(null,a)}}:h;if(b.length){var j=k?g.clone(k):{};j.success=function(h){d.push(h);a(g.rest(b),c,d,k)};c.call(this,g.first(b),j)}else k.success&&k.success(d)};d.Object.saveAll=function(b,c){a(b,function(a,b){a.save(null,b)},[],c)};d.Object._signUpAll=
function(b,c){a(b,function(a,b){a.signUp(null,b)},[],c)};g.extend(d.Object.prototype,d.Events,{_existed:!1,initialize:function(){},toJSON:function(){var a=this._toFullJSON();return g.each(["createdAt","objectId","updatedAt","__type","className"],function(c){delete a[c]}),a},_toFullJSON:function(a){var c=g.clone(this.attributes);return d._each(c,function(f,h){c[h]=d._encode(f,a)}),d._each(this._operations,function(a,b){c[b]=a}),c.objectId=this.id,c.createdAt=this.createdAt,c.updatedAt=this.updatedAt,
c.__type="Object",c.className=this.className,c},_refreshCache:function(){var a=this;d._each(this.attributes,function(c,f){c instanceof d.Object?c._refreshCache():g.isObject(c)&&a._resetCacheForKey(f)&&a.set(f,new d.Op.Set(c),{silent:!0})})},dirty:function(a){this._refreshCache();var c=g.last(this._opSetQueue);return a?c[a]?!0:!1:this.id?0<g.keys(c).length?!0:!1:!0},_toPointer:function(){if(!this.id)throw Error("Can't serialize an unsaved Parse.Object");return{__type:"Pointer",className:this.className,
objectId:this.id}},get:function(a){return this.attributes[a]},relation:function(a){var c=this.get(a);if(c){if(c instanceof d.Relation)return c._ensureParentAndKey(this,a),c;throw"Called relation() on non-relation field "+a;}return new d.Relation(this,a)},escape:function(a){var c=this._escapedAttributes[a];if(c)return c;var c=this.attributes[a],f;return d._isNullOrUndefined(c)?f="":f=g.escape(c.toString()),this._escapedAttributes[a]=f,f},has:function(a){return!d._isNullOrUndefined(this.attributes[a])},
_mergeMagicFields:function(a){var c=this;g.each(["id","objectId","createdAt","updatedAt"],function(d){a[d]&&("objectId"===d?c.id=a[d]:c[d]=a[d],delete a[d])})},_startSave:function(){this._opSetQueue.push({})},_processSaveQueue:function(){if(this._saveQueue&&0<this._saveQueue.length){var a=g.first(this._saveQueue);this._saveQueue=g.rest(this._saveQueue);a()}else this._saving=!1},_cancelSave:function(){var a=g.first(this._opSetQueue);this._opSetQueue=g.rest(this._opSetQueue);var c=g.first(this._opSetQueue);
d._each(a,function(d,h){var g=a[h],j=c[h];g&&j?c[h]=j._mergeWithPrevious(g):g&&(c[h]=g)});this._processSaveQueue()},_finishSave:function(a){var c=g.first(this._opSetQueue);this._opSetQueue=g.rest(this._opSetQueue);this._applyOpSet(c,this._serverData);this._mergeMagicFields(a);var f=this;d._each(a,function(a,b){f._serverData[b]=d._decode(b,a)});this._rebuildAllEstimatedData();this._processSaveQueue()},_finishFetch:function(a,c){this._mergeMagicFields(a);var f=this;d._each(a,function(a,b){f._serverData[b]=
d._decode(b,a)});this._refreshCache();this._hasData=c;this._opSetQueue=[{}];this._rebuildAllEstimatedData()},_applyOpSet:function(a,c){var f=this;d._.each(a,function(a,b){c[b]=a._estimate(c[b],f,b);c[b]===d.Op._UNSET&&delete c[b]})},_resetCacheForKey:function(a){var c=this.attributes[a];return g.isObject(c)&&!(c instanceof d.Object)&&(c=c.toJSON?c.toJSON():c,c=JSON.stringify(c),this._hashedJSON[a]!==c)?(this._hashedJSON[a]=c,!0):!1},_rebuildEstimatedDataForKey:function(a){var c=this;delete this.attributes[a];
this._serverData[a]&&(this.attributes[a]=this._serverData[a]);g.each(this._opSetQueue,function(f){(f=f[a])&&(c.attributes[a]=f._estimate(c.attributes[a],c,a),c.attributes[a]===d.Op._UNSET?delete c.attributes[a]:c._resetCacheForKey(a))})},_rebuildAllEstimatedData:function(){var a=this;this.attributes=g.clone(this._serverData);g.each(this._opSetQueue,function(c){a._applyOpSet(c,a.attributes);g.each(c,function(c,d){a._resetCacheForKey(d)})})},set:function(a,c,f){var h;g.isObject(a)||d._isNullOrUndefined(a)?
(h=a,d._each(h,function(a,b){h[b]=d._decode(b,a)}),f=c):(h={},h[a]=d._decode(a,c));f=f||{};if(!h)return this;h instanceof d.Object&&(h=h.attributes);f.unset&&d._each(h,function(a,b){h[b]=new d.Op.Unset});var k=g.clone(h),j=this;d._each(k,function(a,b){a instanceof d.Op&&(k[b]=a._estimate(j.attributes[b],j,b),k[b]===d.Op._UNSET&&delete k[b])});if(!this._validate(h,f))return!1;this._mergeMagicFields(h);f.changes={};var i=this._escapedAttributes;return d._each(g.keys(h),function(a){var b=h[a];b instanceof
d.Relation&&(b.parent=j);b instanceof d.Op||(b=new d.Op.Set(b));var c=!0;b instanceof d.Op.Set&&g.isEqual(j.attributes[a],b.value)&&(c=!1);c&&(delete i[a],f.silent?j._silent[a]=!0:f.changes[a]=!0);var k=g.last(j._opSetQueue);k[a]=b._mergeWithPrevious(k[a]);j._rebuildEstimatedDataForKey(a);c?(j.changed[a]=j.attributes[a],f.silent||(j._pending[a]=!0)):(delete j.changed[a],delete j._pending[a])}),f.silent||this.change(f),this},unset:function(a,c){return c=c||{},c.unset=!0,this.set(a,null,c)},increment:function(a,
c){if(g.isUndefined(c)||g.isNull(c))c=1;return this.set(a,new d.Op.Increment(c))},add:function(a,c){return this.set(a,new d.Op.Add([c]))},addUnique:function(a,c){return this.set(a,new d.Op.AddUnique([c]))},remove:function(a,c){return this.set(a,new d.Op.Remove([c]))},op:function(a){return g.last(this._opSetQueue)[a]},clear:function(a){a=a||{};a.unset=!0;var c=g.extend(this.attributes,this._operations);return this.set(c,a)},_getSaveJSON:function(){var a=g.clone(g.first(this._opSetQueue));return d._each(a,
function(c,d){a[d]=c.toJSON()}),a},fetch:function(a){var a=a?g.clone(a):{},c=this,f=a.success;a.success=function(a,b,d){c._finishFetch(c.parse(a,b,d),!0);f&&f(c,a)};a.error=d.Object._wrapError(a.error,c,a);d._request("classes",c.className,c.id,"GET",null,a)},save:function(a,c,f){var h,k,i;g.isObject(a)||d._isNullOrUndefined(a)?(h=a,i=c):(h={},h[a]=c,i=f);if(!i&&h&&0===g.reject(h,function(a,b){return g.include(["success","error","wait"],b)}).length&&(a=!0,g.has(h,"success")&&!g.isFunction(h.success)&&
(a=!1),g.has(h,"error")&&!g.isFunction(h.error)&&(a=!1),a))return this.save(null,h);i=i?g.clone(i):{};i.wait&&(k=g.clone(this.attributes));var p=g.extend({},i,{silent:!0});if(h&&!this.set(h,i.wait?p:i))return!1;var q=i,r=g.clone(i),n=this;n._refreshCache();a=d.Object._findUnsavedChildren(n.attributes);if(0<a.length)return d.Object.saveAll(a,{success:function(){n.save(null,q)},error:function(a){i.error&&i.error.apply(this,arguments)}}),this;r.success=function(a,b,c){b=n.parse(a,b,c);r.wait&&(b=g.extend(h||
{},b));n._finishSave(b);q.success?q.success(n,a):n.trigger("sync",n,a,r)};r.error=function(){n._cancelSave();q.error&&q.error.apply(this,arguments)};r.error=d.Object._wrapError(r.error,n,r);this._startSave();a=function(){var a=n.id?"PUT":"POST",b=n._getSaveJSON(),c="classes",f=n.className;"_User"===n.className&&!n.id&&(c="users",f=null);d._request(c,f,n.id,a,b,r);r.wait&&n.set(k,p)};return this._saving?(this._saveQueue=this._saveQueue||[],this._saveQueue.push(a)):(this._saving=!0,a()),this},destroy:function(a){var a=
a?g.clone(a):{},c=this,f=a.success,h=function(){c.trigger("destroy",c,c.collection,a)};if(!this.id)return h();a.success=function(d){a.wait&&h();f?f(c,d):c.trigger("sync",c,d,a)};a.error=d.Object._wrapError(a.error,c,a);d._request("classes",this.className,this.id,"DELETE",null,a);a.wait||h()},parse:function(a,c){var f=g.clone(a);return g(["createdAt","updatedAt"]).each(function(a){f[a]&&(f[a]=d._parseDate(f[a]))}),f.updatedAt||(f.updatedAt=f.createdAt),c&&(this._existed=201!==c.status),f},clone:function(){return new this.constructor(this.attributes)},
isNew:function(){return!this.id},change:function(a){var a=a||{},c=this._changing;this._changing=!0;var f=this;d._each(this._silent,function(a){f._pending[a]=!0});var h=g.extend({},a.changes,this._silent);this._silent={};d._each(h,function(c){f.trigger("change:"+c,f,f.get(c),a)});if(c)return this;for(c=function(a){!f._pending[a]&&!f._silent[a]&&delete f.changed[a]};!g.isEmpty(this._pending);)this._pending={},this.trigger("change",this,a),d._each(this.changed,c),f._previousAttributes=g.clone(this.attributes);
return this._changing=!1,this},existed:function(){return this._existed},hasChanged:function(a){return arguments.length?this._changed&&g.has(this._changed,a):!g.isEmpty(this._changed)},changedAttributes:function(a){if(!a)return this.hasChanged()?g.clone(this._changed):!1;var c={},f=this._previousAttributes;return d._each(a,function(a,b){g.isEqual(f[b],a)||(c[b]=a)}),c},previous:function(a){return!arguments.length||!this._previousAttributes?null:this._previousAttributes[a]},previousAttributes:function(){return g.clone(this._previousAttributes)},
isValid:function(){return!this.validate(this.attributes)},validate:function(a){return!g.has(a,"ACL")||a.ACL instanceof d.ACL?!1:new d.Error(d.Error.OTHER_CAUSE,"ACL must be a Parse.ACL.")},_validate:function(a,c){if(c.silent||!this.validate)return!0;var a=g.extend({},this.attributes,a),d=this.validate(a,c);return d?(c&&c.error?c.error(this,d,c):this.trigger("error",this,d,c),!1):!0},getACL:function(){return this.get("ACL")},setACL:function(a,c){return this.set("ACL",a,c)}});d.Object._getSubclass=
function(a){if(!g.isString(a))throw"Parse.Object._getSubclass requires a string argument.";var c=d.Object._classMap[a];return c||(c=d.Object.extend(a),d.Object._classMap[a]=c),c};d.Object._create=function(a,c,f){return new (d.Object._getSubclass(a))(c,f)};d.Object._classMap={};d.Object._extend=d._extend;d.Object.extend=function(a,c,f){if(!g.isString(a)){if(a&&g.has(a,"className"))return d.Object.extend(a.className,a,c);throw Error("Parse.Object.extend's first argument should be the className.");}"User"===
a&&(a="_User");var h=null;g.has(d.Object._classMap,a)?h=d.Object._classMap[a]._extend(c,f):(c=c||{},c.className=a,h=d.Object._extend(c,f));return h.extend=function(c){if(g.isString(c)||c&&g.has(c,"className"))return d.Object.extend.apply(h,arguments);var f=[a].concat(d._.toArray(arguments));return d.Object.extend.apply(h,f)},d.Object._classMap[a]=h,h};d.Object._wrapError=function(a,c,f){return function(h,g){h!==c&&(g=h);var i=new d.Error(-1,g.responseText);if(g.responseText){var p=JSON.parse(g.responseText);
p&&(i=new d.Error(p.code,p.error))}a?a(c,i,f):c.trigger("error",c,i,f)}};d.Object._findUnsavedChildren=function(a){var c=[];a instanceof d.Object?(a._refreshCache(),a.dirty()&&(c=[a]),c.push.apply(c,d.Object._findUnsavedChildren(a.attributes))):a instanceof d.Relation||(g.isArray(a)?g.each(a,function(a){c.push.apply(c,d.Object._findUnsavedChildren(a))}):g.isObject(a)&&d._each(a,function(a){c.push.apply(c,d.Object._findUnsavedChildren(a))}));return c}})(this);
(function(i){i.Parse=i.Parse||{};var d=i.Parse,g=d._;d.Role=d.Object.extend("_Role",{constructor:function(a,b){g.isString(a)&&b instanceof d.ACL?(d.Object.prototype.constructor.call(this,null,null),this.setName(a),this.setACL(b)):d.Object.prototype.constructor.call(this,a,b)},getName:function(){return this.get("name")},setName:function(a,b){return this.set("name",a,b)},getUsers:function(){return this.relation("users")},getRoles:function(){return this.relation("roles")},validate:function(a,b){if("name"in
a&&a.name!==this.getName()){var c=a.name;if(this.id&&this.id!==a.objectId)return new d.Error(d.Error.OTHER_CAUSE,"A role's name can only be set before it has been saved.");if(!g.isString(c))return new d.Error(d.Error.OTHER_CAUSE,"A role's name must be a String.");if(!/^[a-zA-Z\-_ ]+$/.test(c))return new d.Error(d.Error.OTHER_CAUSE,"A role's name can only contain alphanumeric characters, _, -, and spaces.")}return d.Object.prototype.validate?d.Object.prototype.validate.call(this,a,b):!1}})})(this);
(function(i){i.Parse=i.Parse||{};var d=i.Parse,g=d._;d.Collection=function(a,b){b=b||{};b.comparator&&(this.comparator=b.comparator);b.model&&(this.model=b.model);b.query&&(this.query=b.query);this._reset();this.initialize.apply(this,arguments);a&&this.reset(a,{silent:!0,parse:b.parse})};g.extend(d.Collection.prototype,d.Events,{model:d.Object,initialize:function(){},toJSON:function(){return this.map(function(a){return a.toJSON()})},add:function(a,b){var c,f,h,i,j,p={},q={},b=b||{},a=g.isArray(a)?
a.slice():[a];c=0;for(f=a.length;c<f;c++){a[c]=this._prepareModel(a[c],b);h=a[c];if(!h)throw Error("Can't add an invalid model to a collection");i=h.cid;if(p[i]||this._byCid[i])throw Error("Duplicate cid: can't add the same model to a collection twice");j=h.id;if(!d._isNullOrUndefined(j)&&(q[j]||this._byId[j]))throw Error("Duplicate id: can't add the same model to a collection twice");q[j]=h;p[i]=h}for(c=0;c<f;c++)(h=a[c]).on("all",this._onModelEvent,this),this._byCid[h.cid]=h,h.id&&(this._byId[h.id]=
h);this.length+=f;this.models.splice.apply(this.models,[b.at||this.models.length,0].concat(a));this.comparator&&this.sort({silent:!0});if(b.silent)return this;c=0;for(f=this.models.length;c<f;c++)h=this.models[c],p[h.cid]&&(b.index=c,h.trigger("add",h,this,b));return this},remove:function(a,b){var c,d,h,i,b=b||{},a=g.isArray(a)?a.slice():[a];c=0;for(d=a.length;c<d;c++)if(i=this.getByCid(a[c])||this.get(a[c]))delete this._byId[i.id],delete this._byCid[i.cid],h=this.indexOf(i),this.models.splice(h,
1),this.length--,b.silent||(b.index=h,i.trigger("remove",i,this,b)),this._removeReference(i);return this},get:function(a){return a&&this._byId[a.id||a]},getByCid:function(a){return a&&this._byCid[a.cid||a]},at:function(a){return this.models[a]},sort:function(a){a=a||{};if(!this.comparator)throw Error("Cannot sort a set without a comparator");var b=g.bind(this.comparator,this);return 1===this.comparator.length?this.models=this.sortBy(b):this.models.sort(b),a.silent||this.trigger("reset",this,a),this},
pluck:function(a){return g.map(this.models,function(b){return b.get(a)})},reset:function(a,b){var c=this;return a=a||[],b=b||{},g.each(this.models,function(a){c._removeReference(a)}),this._reset(),this.add(a,{silent:!0,parse:b.parse}),b.silent||this.trigger("reset",this,b),this},fetch:function(a){a=a?g.clone(a):{};void 0===a.parse&&(a.parse=!0);var b=this,c=a.success;a.success=function(d,h){a.add?b.add(d,a):b.reset(d,a);c&&c(b,h)};a.error=d.Object._wrapError(a.error,b,a);(this.query||new d.Query(this.model)).find(a)},
create:function(a,b){var c=this,b=b?g.clone(b):{},a=this._prepareModel(a,b);if(!a)return!1;b.wait||c.add(a,b);var d=b.success;return b.success=function(h,g){b.wait&&c.add(h,b);d?d(h,g):h.trigger("sync",a,g,b)},a.save(null,b),a},parse:function(a){return a},chain:function(){return g(this.models).chain()},_reset:function(){this.length=0;this.models=[];this._byId={};this._byCid={}},_prepareModel:function(a,b){a instanceof d.Object?a.collection||(a.collection=this):(b.collection=this,a=new this.model(a,
b),a._validate(a.attributes,b)||(a=!1));return a},_removeReference:function(a){this===a.collection&&delete a.collection;a.off("all",this._onModelEvent,this)},_onModelEvent:function(a,b,c,d){if("add"!==a&&"remove"!==a||c===this)"destroy"===a&&this.remove(b,d),b&&"change:objectId"===a&&(delete this._byId[b.previous("objectId")],this._byId[b.id]=b),this.trigger.apply(this,arguments)}});g.each("forEach each map reduce reduceRight find detect filter select reject every all some any include contains invoke max min sortBy sortedIndex toArray size first initial rest last without indexOf shuffle lastIndexOf isEmpty groupBy".split(" "),
function(a){d.Collection.prototype[a]=function(){return g[a].apply(g,[this.models].concat(g.toArray(arguments)))}});d.Collection.extend=d._extend})(this);
(function(i){i.Parse=i.Parse||{};var d=i.Parse,g=d._;d.View=function(a){this.cid=g.uniqueId("view");this._configure(a||{});this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents()};var a=/^(\S+)\s*(.*)$/,b="model collection el id attributes className tagName".split(" ");g.extend(d.View.prototype,d.Events,{tagName:"div",$:function(a){return this.$el.find(a)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this},make:function(a,
b,h){a=document.createElement(a);return b&&d.$(a).attr(b),h&&d.$(a).html(h),a},setElement:function(a,b){return this.$el=d.$(a),this.el=this.$el[0],!1!==b&&this.delegateEvents(),this},delegateEvents:function(b){if(b=b||d._getValue(this,"events")){this.undelegateEvents();var f=this;d._each(b,function(d,i){g.isFunction(d)||(d=f[b[i]]);if(!d)throw Error('Event "'+b[i]+'" does not exist');var j=i.match(a),p=j[1],j=j[2],d=g.bind(d,f),p=p+(".delegateEvents"+f.cid);""===j?f.$el.bind(p,d):f.$el.delegate(j,
p,d)})}},undelegateEvents:function(){this.$el.unbind(".delegateEvents"+this.cid)},_configure:function(a){this.options&&(a=g.extend({},this.options,a));var d=this;g.each(b,function(b){a[b]&&(d[b]=a[b])});this.options=a},_ensureElement:function(){if(this.el)this.setElement(this.el,!1);else{var a=d._getValue(this,"attributes")||{};this.id&&(a.id=this.id);this.className&&(a["class"]=this.className);this.setElement(this.make(this.tagName,a),!1)}}});d.View.extend=d._extend})(this);
(function(i){i.Parse=i.Parse||{};var d=i.Parse,g=d._;d.User=d.Object.extend("_User",{_isCurrentUser:!1,_mergeMagicFields:function(a){a.sessionToken&&(this._sessionToken=a.sessionToken,delete a.sessionToken);d.User.__super__._mergeMagicFields.call(this,a)},_cleanupAuthData:function(){if(this.isCurrent()){var a=this.get("authData");a&&g.each(this.get("authData"),function(b,c){a[c]||delete a[c]})}},_synchronizeAllAuthData:function(){if(this.get("authData")){var a=this;g.each(this.get("authData"),function(b,
c){a._synchronizeAuthData(c)})}},_synchronizeAuthData:function(a){if(this.isCurrent()){var b;g.isString(a)?(b=a,a=d.User._authProviders[b]):b=a.getAuthType();var c=this.get("authData");c&&a&&(a.restoreAuthentication(c[b])||this._unlinkFrom(a))}},_handleSaveResult:function(a){a&&(this._isCurrentUser=!0);this._cleanupAuthData();this._synchronizeAllAuthData();delete this._serverData.password;this._rebuildEstimatedDataForKey("password");this._refreshCache();(a||this.isCurrent())&&d.User._saveCurrentUser(this)},
_linkWith:function(a,b){var c;g.isString(a)?(c=a,a=d.User._authProviders[a]):c=a.getAuthType();if(g.has(b,"authData")){var f=this.get("authData")||{};f[c]=b.authData;this.set("authData",f);c=g.clone(b);return c.success=function(a){a._handleSaveResult(!0);b.success&&b.success.apply(this,arguments)},this.save({authData:f},c)}var h=this;return a.authenticate({success:function(a,c){h._linkWith(a,{authData:c,success:b.success,error:b.error})},error:function(a,c){b.error&&b.error(h,c)}})},_unlinkFrom:function(a,
b){g.isString(a)?a=d.User._authProviders[a]:a.getAuthType();var c=g.clone(b),f=this;return c.authData=null,c.success=function(c){f._synchronizeAuthData(a);b.success&&b.success.apply(this,arguments)},this._linkWith(a,c)},_isLinked:function(a){var b;g.isString(a)?b=a:b=a.getAuthType();return!!(this.get("authData")||{})[b]},_logOutWithAll:function(){if(this.get("authData")){var a=this;g.each(this.get("authData"),function(b,c){a._logOutWith(c)})}},_logOutWith:function(a){this.isCurrent()&&(g.isString(a)&&
(a=d.User._authProviders[a]),a&&a.deauthenticate&&a.deauthenticate())},signUp:function(a,b){var c,f=a&&a.username||this.get("username");if(!f||""===f)return b&&b.error&&(c=new d.Error(d.Error.OTHER_CAUSE,"Cannot sign up user with an empty name."),b.error(this,c)),!1;f=a&&a.password||this.get("password");if(!f||""===f)return b&&b.error&&(c=new d.Error(d.Error.OTHER_CAUSE,"Cannot sign up user with an empty password."),b.error(this,c)),!1;c=g.clone(b);return c.success=function(a){a._handleSaveResult(!0);
b.success&&b.success.apply(this,arguments)},this.save(a,c)},logIn:function(a){var b=this,c=g.clone(a);c.success=function(d,h,g){h=b.parse(d,h,g);b._finishFetch(h);b._handleSaveResult(!0);a.success?a.success(b,d):b.trigger("sync",b,d,c)};c.error=d.Object._wrapError(a.error,b,c);d._request("login",null,null,"GET",this.toJSON(),c)},save:function(a,b,c){var f,h;g.isObject(a)||g.isNull(a)||g.isUndefined(a)?(f=a,h=b):(f={},f[a]=b,h=c);a=g.clone(h);return a.success=function(a){a._handleSaveResult(!1);h.success&&
h.success.apply(this,arguments)},d.Object.prototype.save.call(this,f,a)},fetch:function(a){var b=g.clone(a);return b.success=function(b){b._handleSaveResult(!1);a.success&&a.success.apply(this,arguments)},d.Object.prototype.fetch.call(this,b)},isCurrent:function(){return this._isCurrentUser},getUsername:function(){return this.get("username")},setUsername:function(a,b){return this.set("username",a,b)},setPassword:function(a,b){return this.set("password",a,b)},getEmail:function(){return this.get("email")},
setEmail:function(a,b){return this.set("email",a,b)}},{_currentUser:null,_currentUserMatchesDisk:!1,_CURRENT_USER_KEY:"currentUser",_authProviders:{},signUp:function(a,b,c,f){c=c||{};c.username=a;c.password=b;return d.Object._create("_User").signUp(c,f)},logIn:function(a,b,c){var f=d.Object._create("_User");f._finishFetch({username:a,password:b});f.logIn(c)},logOut:function(){null!==d.User._currentUser&&(d.User._currentUser._logOutWithAll(),d.User._currentUser._isCurrentUser=!1);d.User._currentUserMatchesDisk=
!0;d.User._currentUser=null;localStorage.removeItem(d._getParsePath(d.User._CURRENT_USER_KEY))},requestPasswordReset:function(a,b){var c={email:a};b.error=d.Query._wrapError(b.error,b);d._request("requestPasswordReset",null,null,"POST",c,b)},current:function(){if(d.User._currentUser||d.User._currentUserMatchesDisk)return d.User._currentUser;d.User._currentUserMatchesDisk=!0;var a=localStorage.getItem(d._getParsePath(d.User._CURRENT_USER_KEY));if(!a)return null;d.User._currentUser=new d.Object._create("_User");
d.User._currentUser._isCurrentUser=!0;a=JSON.parse(a);return d.User._currentUser.id=a._id,delete a._id,d.User._currentUser._sessionToken=a._sessionToken,delete a._sessionToken,d.User._currentUser.set(a),d.User._currentUser._synchronizeAllAuthData(),d.User._currentUser._refreshCache(),d.User._currentUser._dirty={},d.User._currentUser},_saveCurrentUser:function(a){d.User._currentUser!==a&&d.User.logOut();a._isCurrentUser=!0;d.User._currentUser=a;d.User._currentUserMatchesDisk=!0;var b=a.toJSON();b._id=
a.id;b._sessionToken=a._sessionToken;localStorage.setItem(d._getParsePath(d.User._CURRENT_USER_KEY),JSON.stringify(b))},_registerAuthenticationProvider:function(a){d.User._authProviders[a.getAuthType()]=a;d.User.current()&&d.User.current()._synchronizeAuthData(a.getAuthType())},_logInWith:function(a,b){return(new d.User)._linkWith(a,b)}})})(this);
(function(i){i.Parse=i.Parse||{};var d=i.Parse,g=d._;d.Query=function(a){g.isString(a)&&(a=d.Object._getSubclass(a));this.objectClass=a;this.className=a.prototype.className;this._where={};this._include=[];this._limit=-1;this._skip=0};d.Query.prototype={get:function(a,b){var c=b.success||function(){},f=b.error||function(){};this.equalTo("objectId",a);this.first({error:function(a){f(null,a)},success:function(a){a?c(a):f(null,new d.Error(d.Error.OBJECT_NOT_FOUND,"Object not found."))}})},toJSON:function(){var a=
{where:this._where};return 0<this._include.length&&(a.include=this._include.join(",")),0<=this._limit&&(a.limit=this._limit),0<this._skip&&(a.skip=this._skip),void 0!==this._order&&(a.order=this._order),a},find:function(a){var b=this,c=a.success||function(){},f={error:a.error,success:function(a){c(g.map(a.results,function(a){var c=new b.objectClass;return c._finishFetch(a,!0),c}))}},h=this.toJSON();f.error=d.Query._wrapError(a.error,f);d._request("classes",this.className,null,"GET",h,f)},count:function(a){var b=
a.success||function(){},c={error:a.error,success:function(a){b(a.count)}},f=this.toJSON();f.limit=0;f.count=1;c.error=d.Query._wrapError(a.error,c);d._request("classes",this.className,null,"GET",f,c)},first:function(a){var b=this,c=a.success||function(){},f={error:a.error,success:function(a){c(g.map(a.results,function(a){var c=new b.objectClass;return c._finishFetch(a,!0),c})[0])}},h=this.toJSON();h.limit=1;f.error=d.Query._wrapError(a.error,f);d._request("classes",this.className,null,"GET",h,f)},
collection:function(a,b){return b=b||{},new d.Collection(a,g.extend(b,{model:this.objectClass,query:this}))},skip:function(a){return this._skip=a,this},limit:function(a){return this._limit=a,this},equalTo:function(a,b){return this._where[a]=d._encode(b),this},_addCondition:function(a,b,c){return this._where[a]||(this._where[a]={}),this._where[a][b]=d._encode(c),this},notEqualTo:function(a,b){return this._addCondition(a,"$ne",b),this},lessThan:function(a,b){return this._addCondition(a,"$lt",b),this},
greaterThan:function(a,b){return this._addCondition(a,"$gt",b),this},lessThanOrEqualTo:function(a,b){return this._addCondition(a,"$lte",b),this},greaterThanOrEqualTo:function(a,b){return this._addCondition(a,"$gte",b),this},containedIn:function(a,b){return this._addCondition(a,"$in",b),this},notContainedIn:function(a,b){return this._addCondition(a,"$nin",b),this},exists:function(a){return this._addCondition(a,"$exists",!0),this},doesNotExist:function(a){return this._addCondition(a,"$exists",!1),this},
matches:function(a,b,c){return this._addCondition(a,"$regex",b),c||(c=""),b.ignoreCase&&(c+="i"),b.multiline&&(c+="m"),c&&c.length&&this._addCondition(a,"$options",c),this},matchesQuery:function(a,b){var c=b.toJSON();return c.className=b.className,this._addCondition(a,"$inQuery",c),this},doesNotMatchQuery:function(a,b){var c=b.toJSON();return c.className=b.className,this._addCondition(a,"$notInQuery",c),this},matchesKeyInQuery:function(a,b,c){var d=c.toJSON();return d.className=c.className,this._addCondition(a,
"$select",{key:b,query:d}),this},_quote:function(a){return"\\Q"+a.replace("\\E","\\E\\\\E\\Q")+"\\E"},contains:function(a,b){return this._addCondition(a,"$regex",this._quote(b)),this},startsWith:function(a,b){return this._addCondition(a,"$regex","^"+this._quote(b)),this},endsWith:function(a,b){return this._addCondition(a,"$regex",this._quote(b)+"$"),this},ascending:function(a){return this._order=a,this},descending:function(a){return this._order="-"+a,this},near:function(a,b){return b instanceof d.GeoPoint||
(b=new d.GeoPoint(b)),this._addCondition(a,"$nearSphere",b),this},withinRadians:function(a,b,c){return this.near(a,b),this._addCondition(a,"$maxDistance",c),this},withinMiles:function(a,b,c){return this.withinRadians(a,b,c/3958.8)},withinKilometers:function(a,b,c){return this.withinRadians(a,b,c/6371)},withinGeoBox:function(a,b,c){return b instanceof d.GeoPoint||(b=new d.GeoPoint(b)),c instanceof d.GeoPoint||(c=new d.GeoPoint(c)),this._addCondition(a,"$within",{$box:[b,c]}),this},include:function(a){return g.isArray(a)?
this._include=this._include.concat(a):this._include.push(a),this}};d.Query._wrapError=function(a,b){return function(c){if(a){var f=new d.Error(-1,c.responseText);c.responseText&&(c=JSON.parse(c.responseText))&&(f=new d.Error(c.code,c.error));a(f,b)}}}})(this);
(function(i){i.Parse=i.Parse||{};var d=i.Parse,g=!1,a,b={authenticate:function(b){var d=this;FB.login(function(a){a.authResponse?b.success&&b.success(d,{id:a.authResponse.userID,access_token:a.authResponse.accessToken,expiration_date:(new Date(1E3*a.authResponse.expiresIn+(new Date).getTime())).toJSON()}):b.error&&b.error(d,a)},{scope:a})},restoreAuthentication:function(a){var b;return a?b={userID:a.id,accessToken:a.access_token,expiresIn:(d._parseDate(a.expiration_date).getTime()-(new Date).getTime())/
1E3}:b={userID:null,accessToken:null,expiresIn:null},FB.Auth.setAuthResponse(b),a||FB.logout(),!0},getAuthType:function(){return"facebook"},deauthenticate:function(){this.restoreAuthentication(null)}};d.FacebookUtils={init:function(a){if("undefined"==typeof FB)throw"The Javascript Facebook SDK must be loaded before calling init.";FB.init(a);d.User._registerAuthenticationProvider(b);g=!0},isLinked:function(a){return a._isLinked("facebook")},logIn:function(b,f){if(!g)throw"You must initialize FacebookUtils before calling logIn.";
return a=b,d.User._logInWith("facebook",f)},link:function(b,d,h){if(!g)throw"You must initialize FacebookUtils before calling link.";return a=d,b._linkWith("facebook",h)},unlink:function(a,b){if(!g)throw"You must initialize FacebookUtils before calling unlink.";return a._unlinkFrom("facebook",b)}}})(this);
(function(i){i.Parse=i.Parse||{};var d=i.Parse,g=d._;d.History=function(){this.handlers=[];g.bindAll(this,"checkUrl")};var a=/^[#\/]/,b=/msie [\w.]+/;d.History.started=!1;g.extend(d.History.prototype,d.Events,{interval:50,getHash:function(a){return(a=(a?a.location:window.location).href.match(/#(.*)$/))?a[1]:""},getFragment:function(b,f){if(d._isNullOrUndefined(b))if(this._hasPushState||f){var b=window.location.pathname,g=window.location.search;g&&(b+=g)}else b=this.getHash();return b.indexOf(this.options.root)||
(b=b.substr(this.options.root.length)),b.replace(a,"")},start:function(c){if(d.History.started)throw Error("Parse.history has already been started");d.History.started=!0;this.options=g.extend({},{root:"/"},this.options,c);this._wantsHashChange=!1!==this.options.hashChange;this._wantsPushState=!!this.options.pushState;this._hasPushState=!(!this.options.pushState||!window.history||!window.history.pushState);var c=this.getFragment(),f=document.documentMode;(f=b.exec(navigator.userAgent.toLowerCase())&&
(!f||7>=f))&&(this.iframe=d.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(c));this._hasPushState?d.$(window).bind("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!f?d.$(window).bind("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=window.setInterval(this.checkUrl,this.interval));this.fragment=c;c=window.location;f=c.pathname===this.options.root;if(this._wantsHashChange&&this._wantsPushState&&
!this._hasPushState&&!f)return this.fragment=this.getFragment(null,!0),window.location.replace(this.options.root+"#"+this.fragment),!0;this._wantsPushState&&this._hasPushState&&f&&c.hash&&(this.fragment=this.getHash().replace(a,""),window.history.replaceState({},document.title,c.protocol+"//"+c.host+this.options.root+this.fragment));if(!this.options.silent)return this.loadUrl()},stop:function(){d.$(window).unbind("popstate",this.checkUrl).unbind("hashchange",this.checkUrl);window.clearInterval(this._checkUrlInterval);
d.History.started=!1},route:function(a,b){this.handlers.unshift({route:a,callback:b})},checkUrl:function(){var a=this.getFragment();a===this.fragment&&this.iframe&&(a=this.getFragment(this.getHash(this.iframe)));if(a===this.fragment)return!1;this.iframe&&this.navigate(a);this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(a){var b=this.fragment=this.getFragment(a);return g.any(this.handlers,function(a){if(a.route.test(b))return a.callback(b),!0})},navigate:function(b,f){if(!d.History.started)return!1;
if(!f||!0===f)f={trigger:f};var g=(b||"").replace(a,"");this.fragment!==g&&(this._hasPushState?(0!==g.indexOf(this.options.root)&&(g=this.options.root+g),this.fragment=g,window.history[f.replace?"replaceState":"pushState"]({},document.title,g)):this._wantsHashChange?(this.fragment=g,this._updateHash(window.location,g,f.replace),this.iframe&&g!==this.getFragment(this.getHash(this.iframe))&&(f.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,g,f.replace))):window.location.assign(this.options.root+
b),f.trigger&&this.loadUrl(b))},_updateHash:function(a,b,d){d?(d=a.toString().replace(/(javascript:|#).*$/,""),a.replace(d+"#"+b)):a.hash=b}})})(this);
(function(i){i.Parse=i.Parse||{};var d=i.Parse,g=d._;d.Router=function(a){a=a||{};a.routes&&(this.routes=a.routes);this._bindRoutes();this.initialize.apply(this,arguments)};var a=/:\w+/g,b=/\*\w+/g,c=/[\-\[\]{}()+?.,\\\^\$\|#\s]/g;g.extend(d.Router.prototype,d.Events,{initialize:function(){},route:function(a,b,c){return d.history=d.history||new d.History,g.isRegExp(a)||(a=this._routeToRegExp(a)),c||(c=this[b]),d.history.route(a,g.bind(function(g){g=this._extractParameters(a,g);c&&c.apply(this,g);
this.trigger.apply(this,["route:"+b].concat(g));d.history.trigger("route",this,b,g)},this)),this},navigate:function(a,b){d.history.navigate(a,b)},_bindRoutes:function(){if(this.routes){var a=[],b;for(b in this.routes)this.routes.hasOwnProperty(b)&&a.unshift([b,this.routes[b]]);b=0;for(var c=a.length;b<c;b++)this.route(a[b][0],a[b][1],this[a[b][1]])}},_routeToRegExp:function(d){return d=d.replace(c,"\\$&").replace(a,"([^/]+)").replace(b,"(.*?)"),RegExp("^"+d+"$")},_extractParameters:function(a,b){return a.exec(b).slice(1)}});
d.Router.extend=d._extend})(this);
