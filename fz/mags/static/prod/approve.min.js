var map,tlpoint,brpoint,resetMap=function(){map.fitBounds(new L.LatLngBounds(tlpoint,brpoint))};$(window).resize(function(){$("#map").height(window.innerHeight-100)});
var loadMapFromFigureObject=function(i){L.TileLayer.Common=L.TileLayer.extend({initialize:function(b){L.TileLayer.prototype.initialize.call(this,this.url,b)}});L.Projection.NoWrap={project:function(b){return new L.Point(b.lng,b.lat)},unproject:function(b){return new L.LatLng(b.y,b.x,!0)}};L.CRS.Direct=L.Util.extend({},L.CRS,{code:"Direct",projection:L.Projection.NoWrap,transformation:new L.Transformation(1,0,1,0)});var c,g;c=i.get("imagePropertiesLocation");g=i.get("tileLocation");$.ajax({type:"GET",
url:c,dataType:"xml",success:function(b){$imgxml=$(b).find("IMAGE_PROPERTIES");var b=$imgxml.attr("HEIGHT"),a=$imgxml.attr("WIDTH");imageHeight=b;imageWidth=a;var d=Math.ceil(Math.log(Math.max(a,b)/256)/Math.log(2));$("#map").height(window.innerHeight-100);map=new L.Map("map",{crs:L.CRS.Direct,center:new L.LatLng(0,0),zoom:d,minZoom:1,worldCopyJump:!1,attributionControl:!1});var c=new L.Control.FullScreen;map.addControl(c);c=L.Control.extend({options:{position:"topright"},_createButton:function(b,
a,d,c,f){a=L.DomUtil.create("a",a,d);a.href="#";a.title=b;L.DomEvent.addListener(a,"click",L.DomEvent.stopPropagation).addListener(a,"click",L.DomEvent.preventDefault).addListener(a,"click",c,f);return a},onAdd:function(){var b=L.DomUtil.create("div","leaflet-control-draw");this._createButton("reset zoom","leaflet-control-draw-zoom",b,resetMap,window);return b}});map.addControl(new c);map.setView(map.layerPointToLatLng(new L.Point($("#map").width(),$("#map").height())),d,!0);L.TileLayer.FigureZero=
L.TileLayer.Common.extend({url:g+"TileGroup0/{z}-{x}-{y}.jpg",options:{noWrap:!0,maxZoom:d}});d=new L.TileLayer.FigureZero;map.addLayer(d);tlpoint=map.layerPointToLatLng(new L.Point(0,b));tlpoint.lat*=0.1;brpoint=map.layerPointToLatLng(new L.Point(a,0));brpoint.lng*=0.1;map.fitBounds(new L.LatLngBounds(tlpoint,brpoint))}})};
$(function(){Parse.$=jQuery;Parse.initialize("nY5yXtyaq5zJ1TnCfGOBDa6vu9IX9WwhDJTxx6eu","2HnPlp2kBNpS66dsPdVHRlec1b8BVzKnbZc5XknC");var i=Parse.Object.extend("UploadObject",{initialize:function(){},toggle:function(){}});Parse.Collection.extend({model:i});var c=Parse.Object.extend("AppState",{defaults:{filter:"all"}}),g=Parse.View.extend({events:{"click #logoutButton":"logOut","click #resetviewbutton":"reloadImageView","click #approveFigure":"approveFigure","click #conversionError":"conversionError",
"click #refreshProcButton":"checkIfFileDone"},el:".content",initialize:function(){_.bindAll(this,"render","logOut","reloadImageView","approveFigure","conversionError","checkIfFileDone");this.$el.html(_.template($("#manage-todos-template").html()));_gaq.push(["_trackEvent","Approve","Approve view initialized"]);this.activeFigureID=$("#parseID").html();this.query=new Parse.Query(i);this.query.equalTo("user",Parse.User.current());this.query.get(this.activeFigureID,{success:function(b){this.activeFigure=
b;var a=b.toJSON();6<=a.stat?(console.log("figure ready for approval"),$("#_filename").fadeOut(500,function(){$(this).text(a.originalFilename).fadeIn(500)}),$("#_filesize").fadeOut(500,function(){$(this).text(a.originalFileSize+" bytes").fadeIn(500)}),$("#_procstatus").fadeOut(500,function(){$(this).text(a.stat+","+a.processingStatus).fadeIn(500)}),$("#_imagesize").fadeOut(500,function(){$(this).text(a.originalImageSize).fadeIn(500)}),loadMapFromFigureObject(b),7<=a.stat?(console.log("figure already approved"),
$("#approvalBlock").fadeOut(500,function(){var a;a='<center><h3 id="homeContent">Figure approved.</h3><p>You can now edit the occompanying text...</p>'+('<p><a href="/fz/'+b.id+'" class="btn" type="button">Edit figure text  <i class="icon-arrow-right"></i></a></p><br>');a+="<p>or define important regions of interest...</p>";a+='<p><a href="/roi/'+b.id+'" class="btn" type="button">Edit regions  <i class="icon-arrow-right"></i></a></p><br>';a+="<p><p>or embed references from Pubmed or videos from youtube & vimeo... </p>";
a+='<a href="/ref/'+b.id+'" class="btn" type="button">Edit references  <i class="icon-arrow-right"></i></a></p><br>';a+="<p>or return to your library </p>";a+='<p><a href="/library" class="btn btn-small btn-inverse" type="button">Return to library</a></p><br></center>';$(this).html(a).fadeIn(500)})):$("#approvalBlock").fadeIn(500,function(){$(this).html('<center><h3 id="title">Before we continue, <br>please review the conversion</h3><br><p><button class="btn btn-success btn-large btn-block" id="approveFigure" type="button">Figure appears correct. <i class="icon-check icon-white"></i></button></p><br><p><button class="btn btn-danger btn-block" id="conversionError" type="button">Something went wrong, discard....</button></p></center>')})):
($("#_filename").fadeOut(500,function(){$(this).text(a.originalFilename).fadeIn(500)}),$("#_procstatus").fadeOut(500,function(){$(this).text(a.stat+","+a.processingStatus).fadeIn(500)}),$("#approvalBlock").fadeOut(500,function(){var b;b='<h3 id="title">Figure still in conversion queue...</h3><a href="#" id="refreshProcButton" class="btn btn-large btn-block" type="button">Refresh status</a><a href="/library" class="btn btn-large btn-block" type="button">Return to figure list.</a>';$(this).html(b).fadeIn(500)}))},
error:function(){window.location="/library"}})},checkIfFileDone:function(){_gaq.push(["_trackEvent","Approve","Refresh status"]);this.query.get(this.activeFigureID,{success:function(b){this.activeFigure=b;var a=b.toJSON();6<=a.stat?(console.log("figure ready for approval"),$("#_filename").fadeOut(500,function(){$(this).text(a.originalFilename).fadeIn(500)}),$("#_filesize").fadeOut(500,function(){$(this).text(a.originalFileSize+" bytes").fadeIn(500)}),$("#_procstatus").fadeOut(500,function(){$(this).text(a.stat+
","+a.processingStatus).fadeIn(500)}),$("#_imagesize").fadeOut(500,function(){$(this).text(a.originalImageSize).fadeIn(500)}),loadMapFromFigureObject(b),7<=a.stat?$("#approvalBlock").fadeOut(500,function(){var a;a='<h3 id="title">Figure already approved.</h3>'+('<a href="/fz/'+b.id+'" class="btn btn-small btn-primary" type="button">Edit text</a>');a+='<a href="/roi/'+b.id+'" class="btn btn-small btn-primary" type="button">Edit views</a>';a+='<a href="/ref/'+b.id+'" class="btn btn-small btn-primary" type="button">Edit references</a>';
$(this).html(a+'<a href="/library" class="btn btn-small btn-inverse" type="button">Return to library</a></div><br>').fadeIn(500)}):$("#approvalBlock").fadeIn(500,function(){$(this).html('<h3 id="title">Before we continue, <br>please review the conversion</h3><br><div class="btn-group"><button class="btn btn-success btn-block" id="approveFigure" type="button">Okay <i class="icon-check icon-white"></i></button><button class="btn btn-danger btn-block" id="conversionError" type="button">Something went wrong</button></div>')})):
($("#_filename").fadeOut(500,function(){$(this).text(a.originalFilename).fadeIn(500)}),$("#_procstatus").fadeOut(500,function(){$(this).text(a.stat+","+a.processingStatus).fadeIn(500)}),$("#approvalBlock").fadeOut(500,function(){var a;a='<h3 id="title">Figure still in conversion queue...</h3><a href="#" id="refreshProcButton" class="btn btn-large btn-block" type="button">Refresh status</a><a href="/library" class="btn btn-large btn-block" type="button">Return to figure list.</a>';$(this).html(a).fadeIn(500)}))},
error:function(){window.location="/library"}})},reloadImageView:function(){resetMap()},approveFigure:function(){_gaq.push(["_trackEvent","Approve","Approved figure"]);this.query.first({success:function(a){a.set("stat",7);a.save(null,{success:function(){console.log("success");$("#_procstatus").fadeOut(500,function(){$(this).text(a.stat+","+a.processingStatus).fadeIn(500)});$("#approvalBlock").fadeOut(100,function(){var b;b='<center><h3 id="homeContent">Figure approved.</h3><p>You can now edit the occompanying text...</p>'+
('<p><a href="/fz/'+a.id+'" class="btn" type="button">Edit figure text  <i class="icon-arrow-right"></i></a></p><br>');b+="<p>or define important regions of interest...</p>";b+='<p><a href="/roi/'+a.id+'" class="btn" type="button">Edit regions  <i class="icon-arrow-right"></i></a></p><br>';b+="<p><p>or embed references from Pubmed or videos from youtube & vimeo... </p>";b+='<a href="/ref/'+a.id+'" class="btn" type="button">Edit references  <i class="icon-arrow-right"></i></a></p><br>';b+="<p>or return to your library </p>";
b+='<p><a href="/library" class="btn btn-small btn-inverse" type="button">Return to library</a></p><br></center>';$(this).html(b).fadeIn(500)})},error:function(a,b){alert(b)}})},error:function(a){alert("Error: "+a.code+" "+a.message)}})},conversionError:function(){_gaq.push(["_trackEvent","Approve","Conversion error clicked"]);!0==confirm("Confirm delete of this upload?")&&this.query.first({success:function(a){a.destroy({success:function(){_gaq.push(["_trackEvent","Approve","Conversion error, figure removed"]);
window.location="http://figurezero.com/library"},error:function(){}})},error:function(){console.log("object not retrieved successfully")}})},logOut:function(){Parse.User.logOut();new b;this.undelegateEvents();delete this},render:function(){this.delegateEvents()}}),b=Parse.View.extend({events:{"submit form.login-form":"logIn","submit form.signup-form":"signUp"},el:".content",initialize:function(){_.bindAll(this,"logIn","signUp");this.render()},logIn:function(){var a=this,b=this.$("#signup-username").val().toLowerCase(),
d=this.$("#signup-email").val(),c=this.$("#signup-password").val(),f=new Parse.User;f.set("username",b);f.set("password",c);f.set("email",d);f.set("ACL",new Parse.ACL);f.signUp(null,{success:function(){window.appModel=new MainApplicationView;a.undelegateEvents();delete a},error:function(b,d){a.$(".signup-form .error").html(d.message).show();this.$(".signup-form button").removeAttr("disabled")}});this.$(".login-form button").attr("disabled","disabled");return!1},signUp:function(){var a=this,b=this.$("#signup-username").val(),
d=this.$("#signup-password").val();Parse.User.signUp(b,d,{ACL:new Parse.ACL},{success:function(){new g;a.undelegateEvents();delete a},error:function(b,d){a.$(".signup-form .error").html(d.message).show();this.$(".signup-form button").removeAttr("disabled")}});this.$(".signup-form button").attr("disabled","disabled");return!1},render:function(){this.$el.html(_.template($("#login-template").html()));$("#login-username").focus();this.delegateEvents()}}),a=Parse.View.extend({el:$("#todoapp"),initialize:function(){this.render()},
render:function(){Parse.User.current()?new g:new b}}),d=Parse.Router.extend({routes:{all:"all",active:"active",completed:"completed"},initialize:function(){},all:function(){f.set({filter:"all"})},active:function(){f.set({filter:"active"})},completed:function(){f.set({filter:"completed"})}}),f=new c;new d;new a;Parse.history.start()});(function(){function i(a,b,d){if(a===b)return 0!==a||1/a==1/b;if(null==a||null==b)return a===b;a._chain&&(a=a._wrapped);b._chain&&(b=b._wrapped);if(a.isEqual&&e.isFunction(a.isEqual))return a.isEqual(b);if(b.isEqual&&e.isFunction(b.isEqual))return b.isEqual(a);var c=n.call(a);if(c!=n.call(b))return!1;switch(c){case "[object String]":return a==""+b;case "[object Number]":return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case "[object Date]":case "[object Boolean]":return+a==+b;case "[object RegExp]":return a.source==
b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if("object"!=typeof a||"object"!=typeof b)return!1;for(var f=d.length;f--;)if(d[f]==a)return!0;d.push(a);var f=0,h=!0;if("[object Array]"==c){if(f=a.length,h=f==b.length)for(;f--&&(h=f in a==f in b&&i(a[f],b[f],d)););}else{if("constructor"in a!="constructor"in b||a.constructor!=b.constructor)return!1;for(var g in a)if(e.has(a,g)&&(f++,!(h=e.has(b,g)&&i(a[g],b[g],d))))break;if(h){for(g in b)if(e.has(b,g)&&!f--)break;
h=!f}}d.pop();return h}var c=this,g=c._,b={},a=Array.prototype,d=Object.prototype,f=a.slice,h=a.unshift,n=d.toString,j=d.hasOwnProperty,m=a.forEach,q=a.map,r=a.reduce,p=a.reduceRight,A=a.filter,B=a.every,C=a.some,u=a.indexOf,D=a.lastIndexOf,d=Array.isArray,G=Object.keys,v=Function.prototype.bind,e=function(a){return new s(a)};"undefined"!==typeof exports?("undefined"!==typeof module&&module.exports&&(exports=module.exports=e),exports._=e):c._=e;e.VERSION="1.3.3";var l=e.each=e.forEach=function(a,
d,c){if(null!=a)if(m&&a.forEach===m)a.forEach(d,c);else if(a.length===+a.length)for(var f=0,h=a.length;f<h&&!(f in a&&d.call(c,a[f],f,a)===b);f++);else for(f in a)if(e.has(a,f)&&d.call(c,a[f],f,a)===b)break};e.map=e.collect=function(a,b,d){var c=[];if(null==a)return c;if(q&&a.map===q)return a.map(b,d);l(a,function(a,k,f){c[c.length]=b.call(d,a,k,f)});a.length===+a.length&&(c.length=a.length);return c};e.reduce=e.foldl=e.inject=function(a,b,d,c){var f=2<arguments.length;null==a&&(a=[]);if(r&&a.reduce===
r)return c&&(b=e.bind(b,c)),f?a.reduce(b,d):a.reduce(b);l(a,function(a,k,e){f?d=b.call(c,d,a,k,e):(d=a,f=!0)});if(!f)throw new TypeError("Reduce of empty array with no initial value");return d};e.reduceRight=e.foldr=function(a,b,d,c){var f=2<arguments.length;null==a&&(a=[]);if(p&&a.reduceRight===p)return c&&(b=e.bind(b,c)),f?a.reduceRight(b,d):a.reduceRight(b);var h=e.toArray(a).reverse();c&&!f&&(b=e.bind(b,c));return f?e.reduce(h,b,d,c):e.reduce(h,b)};e.find=e.detect=function(a,b,d){var c;E(a,function(a,
k,f){if(b.call(d,a,k,f))return c=a,!0});return c};e.filter=e.select=function(a,b,d){var c=[];if(null==a)return c;if(A&&a.filter===A)return a.filter(b,d);l(a,function(a,k,f){b.call(d,a,k,f)&&(c[c.length]=a)});return c};e.reject=function(a,b,d){var c=[];if(null==a)return c;l(a,function(a,k,f){b.call(d,a,k,f)||(c[c.length]=a)});return c};e.every=e.all=function(a,d,c){var f=!0;if(null==a)return f;if(B&&a.every===B)return a.every(d,c);l(a,function(a,k,e){if(!(f=f&&d.call(c,a,k,e)))return b});return!!f};
var E=e.some=e.any=function(a,d,c){d||(d=e.identity);var f=!1;if(null==a)return f;if(C&&a.some===C)return a.some(d,c);l(a,function(a,k,e){if(f||(f=d.call(c,a,k,e)))return b});return!!f};e.include=e.contains=function(a,b){return null==a?!1:u&&a.indexOf===u?-1!=a.indexOf(b):E(a,function(a){return a===b})};e.invoke=function(a,b){var d=f.call(arguments,2);return e.map(a,function(a){return(e.isFunction(b)?b||a:a[b]).apply(a,d)})};e.pluck=function(a,b){return e.map(a,function(a){return a[b]})};e.max=function(a,
b,d){if(!b&&e.isArray(a)&&a[0]===+a[0])return Math.max.apply(Math,a);if(!b&&e.isEmpty(a))return-Infinity;var c={computed:-Infinity};l(a,function(a,k,f){k=b?b.call(d,a,k,f):a;k>=c.computed&&(c={value:a,computed:k})});return c.value};e.min=function(a,b,d){if(!b&&e.isArray(a)&&a[0]===+a[0])return Math.min.apply(Math,a);if(!b&&e.isEmpty(a))return Infinity;var c={computed:Infinity};l(a,function(a,k,f){k=b?b.call(d,a,k,f):a;k<c.computed&&(c={value:a,computed:k})});return c.value};e.shuffle=function(a){var b=
[],d;l(a,function(a,k){d=Math.floor(Math.random()*(k+1));b[k]=b[d];b[d]=a});return b};e.sortBy=function(a,b,d){var c=e.isFunction(b)?b:function(a){return a[b]};return e.pluck(e.map(a,function(a,b,k){return{value:a,criteria:c.call(d,a,b,k)}}).sort(function(a,b){var k=a.criteria,d=b.criteria;return void 0===k?1:void 0===d?-1:k<d?-1:k>d?1:0}),"value")};e.groupBy=function(a,b){var d={},c=e.isFunction(b)?b:function(a){return a[b]};l(a,function(a,b){var k=c(a,b);(d[k]||(d[k]=[])).push(a)});return d};e.sortedIndex=
function(a,b,d){d||(d=e.identity);for(var c=0,f=a.length;c<f;){var h=c+f>>1;d(a[h])<d(b)?c=h+1:f=h}return c};e.toArray=function(a){return!a?[]:e.isArray(a)||e.isArguments(a)?f.call(a):a.toArray&&e.isFunction(a.toArray)?a.toArray():e.values(a)};e.size=function(a){return e.isArray(a)?a.length:e.keys(a).length};e.first=e.head=e.take=function(a,b,d){return null!=b&&!d?f.call(a,0,b):a[0]};e.initial=function(a,b,d){return f.call(a,0,a.length-(null==b||d?1:b))};e.last=function(a,b,d){return null!=b&&!d?
f.call(a,Math.max(a.length-b,0)):a[a.length-1]};e.rest=e.tail=function(a,b,d){return f.call(a,null==b||d?1:b)};e.compact=function(a){return e.filter(a,function(a){return!!a})};e.flatten=function(a,b){return e.reduce(a,function(a,d){if(e.isArray(d))return a.concat(b?d:e.flatten(d));a[a.length]=d;return a},[])};e.without=function(a){return e.difference(a,f.call(arguments,1))};e.uniq=e.unique=function(a,b,d){var d=d?e.map(a,d):a,c=[];3>a.length&&(b=!0);e.reduce(d,function(d,f,h){if(b?e.last(d)!==f||
!d.length:!e.include(d,f))d.push(f),c.push(a[h]);return d},[]);return c};e.union=function(){return e.uniq(e.flatten(arguments,!0))};e.intersection=e.intersect=function(a){var b=f.call(arguments,1);return e.filter(e.uniq(a),function(a){return e.every(b,function(b){return 0<=e.indexOf(b,a)})})};e.difference=function(a){var b=e.flatten(f.call(arguments,1),!0);return e.filter(a,function(a){return!e.include(b,a)})};e.zip=function(){for(var a=f.call(arguments),b=e.max(e.pluck(a,"length")),d=Array(b),c=
0;c<b;c++)d[c]=e.pluck(a,""+c);return d};e.indexOf=function(a,b,d){if(null==a)return-1;var c;if(d)return d=e.sortedIndex(a,b),a[d]===b?d:-1;if(u&&a.indexOf===u)return a.indexOf(b);d=0;for(c=a.length;d<c;d++)if(d in a&&a[d]===b)return d;return-1};e.lastIndexOf=function(a,b){if(null==a)return-1;if(D&&a.lastIndexOf===D)return a.lastIndexOf(b);for(var d=a.length;d--;)if(d in a&&a[d]===b)return d;return-1};e.range=function(a,b,d){1>=arguments.length&&(b=a||0,a=0);for(var d=arguments[2]||1,c=Math.max(Math.ceil((b-
a)/d),0),f=0,e=Array(c);f<c;)e[f++]=a,a+=d;return e};var F=function(){};e.bind=function(a,b){var d,c;if(a.bind===v&&v)return v.apply(a,f.call(arguments,1));if(!e.isFunction(a))throw new TypeError;c=f.call(arguments,2);return d=function(){if(!(this instanceof d))return a.apply(b,c.concat(f.call(arguments)));F.prototype=a.prototype;var e=new F,h=a.apply(e,c.concat(f.call(arguments)));return Object(h)===h?h:e}};e.bindAll=function(a){var b=f.call(arguments,1);0==b.length&&(b=e.functions(a));l(b,function(b){a[b]=
e.bind(a[b],a)});return a};e.memoize=function(a,b){var d={};b||(b=e.identity);return function(){var c=b.apply(this,arguments);return e.has(d,c)?d[c]:d[c]=a.apply(this,arguments)}};e.delay=function(a,b){var d=f.call(arguments,2);return setTimeout(function(){return a.apply(null,d)},b)};e.defer=function(a){return e.delay.apply(e,[a,1].concat(f.call(arguments,1)))};e.throttle=function(a,b){var d,c,f,h,g,n,i=e.debounce(function(){g=h=!1},b);return function(){d=this;c=arguments;f||(f=setTimeout(function(){f=
null;g&&a.apply(d,c);i()},b));h?g=!0:n=a.apply(d,c);i();h=!0;return n}};e.debounce=function(a,b,d){var c;return function(){var f=this,e=arguments;d&&!c&&a.apply(f,e);clearTimeout(c);c=setTimeout(function(){c=null;d||a.apply(f,e)},b)}};e.once=function(a){var b=!1,d;return function(){if(b)return d;b=!0;return d=a.apply(this,arguments)}};e.wrap=function(a,b){return function(){var d=[a].concat(f.call(arguments,0));return b.apply(this,d)}};e.compose=function(){var a=arguments;return function(){for(var b=
arguments,d=a.length-1;0<=d;d--)b=[a[d].apply(this,b)];return b[0]}};e.after=function(a,b){return 0>=a?b():function(){if(1>--a)return b.apply(this,arguments)}};e.keys=G||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[],d;for(d in a)e.has(a,d)&&(b[b.length]=d);return b};e.values=function(a){return e.map(a,e.identity)};e.functions=e.methods=function(a){var b=[],d;for(d in a)e.isFunction(a[d])&&b.push(d);return b.sort()};e.extend=function(a){l(f.call(arguments,1),function(b){for(var d in b)a[d]=
b[d]});return a};e.pick=function(a){var b={};l(e.flatten(f.call(arguments,1)),function(d){d in a&&(b[d]=a[d])});return b};e.defaults=function(a){l(f.call(arguments,1),function(b){for(var d in b)null==a[d]&&(a[d]=b[d])});return a};e.clone=function(a){return!e.isObject(a)?a:e.isArray(a)?a.slice():e.extend({},a)};e.tap=function(a,b){b(a);return a};e.isEqual=function(a,b){return i(a,b,[])};e.isEmpty=function(a){if(null==a)return!0;if(e.isArray(a)||e.isString(a))return 0===a.length;for(var b in a)if(e.has(a,
b))return!1;return!0};e.isElement=function(a){return!!(a&&1==a.nodeType)};e.isArray=d||function(a){return"[object Array]"==n.call(a)};e.isObject=function(a){return a===Object(a)};e.isArguments=function(a){return"[object Arguments]"==n.call(a)};e.isArguments(arguments)||(e.isArguments=function(a){return!(!a||!e.has(a,"callee"))});e.isFunction=function(a){return"[object Function]"==n.call(a)};e.isString=function(a){return"[object String]"==n.call(a)};e.isNumber=function(a){return"[object Number]"==
n.call(a)};e.isFinite=function(a){return e.isNumber(a)&&isFinite(a)};e.isNaN=function(a){return a!==a};e.isBoolean=function(a){return!0===a||!1===a||"[object Boolean]"==n.call(a)};e.isDate=function(a){return"[object Date]"==n.call(a)};e.isRegExp=function(a){return"[object RegExp]"==n.call(a)};e.isNull=function(a){return null===a};e.isUndefined=function(a){return void 0===a};e.has=function(a,b){return j.call(a,b)};e.noConflict=function(){c._=g;return this};e.identity=function(a){return a};e.times=
function(a,b,d){for(var c=0;c<a;c++)b.call(d,c)};e.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};e.result=function(a,b){if(null==a)return null;var d=a[b];return e.isFunction(d)?d.call(a):d};e.mixin=function(a){l(e.functions(a),function(b){var d=e[b]=a[b];s.prototype[b]=function(){var a=f.call(arguments);h.call(a,this._wrapped);return w(d.apply(e,a),this._chain)}})};var H=0;e.uniqueId=
function(a){var b=H++;return a?a+b:b};e.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var x=/.^/,t={"\\":"\\","'":"'",r:"\r",n:"\n",t:"\t",u2028:"\u2028",u2029:"\u2029"},y;for(y in t)t[t[y]]=y;var I=/\\|'|\r|\n|\t|\u2028|\u2029/g,J=/\\(\\|'|r|n|t|u2028|u2029)/g,z=function(a){return a.replace(J,function(a,b){return t[b]})};e.template=function(a,b,d){d=e.defaults(d||{},e.templateSettings);a="__p+='"+a.replace(I,function(a){return"\\"+t[a]}).replace(d.escape||
x,function(a,b){return"'+\n_.escape("+z(b)+")+\n'"}).replace(d.interpolate||x,function(a,b){return"'+\n("+z(b)+")+\n'"}).replace(d.evaluate||x,function(a,b){return"';\n"+z(b)+"\n;__p+='"})+"';\n";d.variable||(a="with(obj||{}){\n"+a+"}\n");var a="var __p='';var print=function(){__p+=Array.prototype.join.call(arguments, '')};\n"+a+"return __p;\n",c=new Function(d.variable||"obj","_",a);if(b)return c(b,e);b=function(a){return c.call(this,a,e)};b.source="function("+(d.variable||"obj")+"){\n"+a+"}";return b};
e.chain=function(a){return e(a).chain()};var s=function(a){this._wrapped=a};e.prototype=s.prototype;var w=function(a,b){return b?e(a).chain():a};e.mixin(e);l("pop push reverse shift sort splice unshift".split(" "),function(b){var d=a[b];s.prototype[b]=function(){var a=this._wrapped;d.apply(a,arguments);var c=a.length;("shift"==b||"splice"==b)&&0===c&&delete a[0];return w(a,this._chain)}});l(["concat","join","slice"],function(b){var d=a[b];s.prototype[b]=function(){return w(d.apply(this._wrapped,arguments),
this._chain)}});s.prototype.chain=function(){this._chain=!0;return this};s.prototype.value=function(){return this._wrapped}}).call(this);(function(i){i.Parse=i.Parse||{};i.Parse.VERSION="1.0.18"})(this);
(function(){function i(a,b,d){if(a===b)return 0!==a||1/a==1/b;if(null==a||null==b)return a===b;a._chain&&(a=a._wrapped);b._chain&&(b=b._wrapped);if(a.isEqual&&e.isFunction(a.isEqual))return a.isEqual(b);if(b.isEqual&&e.isFunction(b.isEqual))return b.isEqual(a);var c=n.call(a);if(c!=n.call(b))return!1;switch(c){case "[object String]":return a==String(b);case "[object Number]":return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case "[object Date]":case "[object Boolean]":return+a==+b;case "[object RegExp]":return a.source==
b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if("object"!=typeof a||"object"!=typeof b)return!1;for(var f=d.length;f--;)if(d[f]==a)return!0;d.push(a);var f=0,h=!0;if("[object Array]"==c){if(f=a.length,h=f==b.length)for(;f--&&(h=f in a==f in b&&i(a[f],b[f],d)););}else{if("constructor"in a!="constructor"in b||a.constructor!=b.constructor)return!1;for(var g in a)if(e.has(a,g)&&(f++,!(h=e.has(b,g)&&i(a[g],b[g],d))))break;if(h){for(g in b)if(e.has(b,g)&&!f--)break;
h=!f}}return d.pop(),h}var c=this,g=c._,b={},a=Array.prototype,d=Object.prototype,f=a.slice,h=a.unshift,n=d.toString,j=d.hasOwnProperty,m=a.forEach,q=a.map,r=a.reduce,p=a.reduceRight,A=a.filter,B=a.every,C=a.some,u=a.indexOf,D=a.lastIndexOf,d=Array.isArray,G=Object.keys,v=Function.prototype.bind,e=function(a){return new s(a)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=e),exports._=e):c._=e;e.VERSION="1.3.3";var l=e.each=e.forEach=function(a,d,
c){if(null!=a)if(m&&a.forEach===m)a.forEach(d,c);else if(a.length===+a.length)for(var f=0,h=a.length;f<h&&!(f in a&&d.call(c,a[f],f,a)===b);f++);else for(f in a)if(e.has(a,f)&&d.call(c,a[f],f,a)===b)break};e.map=e.collect=function(a,b,d){var c=[];return null==a?c:q&&a.map===q?a.map(b,d):(l(a,function(a,f,e){c[c.length]=b.call(d,a,f,e)}),a.length===+a.length&&(c.length=a.length),c)};e.reduce=e.foldl=e.inject=function(a,b,d,c){var f=2<arguments.length;null==a&&(a=[]);if(r&&a.reduce===r)return c&&(b=
e.bind(b,c)),f?a.reduce(b,d):a.reduce(b);l(a,function(a,e,h){f?d=b.call(c,d,a,e,h):(d=a,f=!0)});if(!f)throw new TypeError("Reduce of empty array with no initial value");return d};e.reduceRight=e.foldr=function(a,b,d,c){var f=2<arguments.length;null==a&&(a=[]);if(p&&a.reduceRight===p)return c&&(b=e.bind(b,c)),f?a.reduceRight(b,d):a.reduceRight(b);var h=e.toArray(a).reverse();return c&&!f&&(b=e.bind(b,c)),f?e.reduce(h,b,d,c):e.reduce(h,b)};e.find=e.detect=function(a,b,d){var c;return E(a,function(a,
f,e){if(b.call(d,a,f,e))return c=a,!0}),c};e.filter=e.select=function(a,b,d){var c=[];return null==a?c:A&&a.filter===A?a.filter(b,d):(l(a,function(a,f,e){b.call(d,a,f,e)&&(c[c.length]=a)}),c)};e.reject=function(a,b,d){var c=[];return null==a?c:(l(a,function(a,f,e){b.call(d,a,f,e)||(c[c.length]=a)}),c)};e.every=e.all=function(a,d,c){var f=!0;return null==a?f:B&&a.every===B?a.every(d,c):(l(a,function(a,e,h){if(!(f=f&&d.call(c,a,e,h)))return b}),!!f)};var E=e.some=e.any=function(a,d,c){d||(d=e.identity);
var f=!1;return null==a?f:C&&a.some===C?a.some(d,c):(l(a,function(a,e,h){if(f||(f=d.call(c,a,e,h)))return b}),!!f)};e.include=e.contains=function(a,b){var d=!1;return null==a?d:u&&a.indexOf===u?-1!=a.indexOf(b):(d=E(a,function(a){return a===b}),d)};e.invoke=function(a,b){var d=f.call(arguments,2);return e.map(a,function(a){return(e.isFunction(b)?b||a:a[b]).apply(a,d)})};e.pluck=function(a,b){return e.map(a,function(a){return a[b]})};e.max=function(a,b,d){if(!b&&e.isArray(a)&&a[0]===+a[0])return Math.max.apply(Math,
a);if(!b&&e.isEmpty(a))return-Infinity;var c={computed:-Infinity};return l(a,function(a,f,e){f=b?b.call(d,a,f,e):a;f>=c.computed&&(c={value:a,computed:f})}),c.value};e.min=function(a,b,d){if(!b&&e.isArray(a)&&a[0]===+a[0])return Math.min.apply(Math,a);if(!b&&e.isEmpty(a))return Infinity;var c={computed:Infinity};return l(a,function(a,f,e){f=b?b.call(d,a,f,e):a;f<c.computed&&(c={value:a,computed:f})}),c.value};e.shuffle=function(a){var b=[],d;return l(a,function(a,c){d=Math.floor(Math.random()*(c+
1));b[c]=b[d];b[d]=a}),b};e.sortBy=function(a,b,d){var c=e.isFunction(b)?b:function(a){return a[b]};return e.pluck(e.map(a,function(a,b,f){return{value:a,criteria:c.call(d,a,b,f)}}).sort(function(a,b){var d=a.criteria,c=b.criteria;return void 0===d?1:void 0===c?-1:d<c?-1:d>c?1:0}),"value")};e.groupBy=function(a,b){var d={},c=e.isFunction(b)?b:function(a){return a[b]};return l(a,function(a,b){var f=c(a,b);(d[f]||(d[f]=[])).push(a)}),d};e.sortedIndex=function(a,b,d){d||(d=e.identity);for(var c=0,f=
a.length;c<f;){var h=c+f>>1;d(a[h])<d(b)?c=h+1:f=h}return c};e.toArray=function(a){return a?e.isArray(a)?f.call(a):e.isArguments(a)?f.call(a):a.toArray&&e.isFunction(a.toArray)?a.toArray():e.values(a):[]};e.size=function(a){return e.isArray(a)?a.length:e.keys(a).length};e.first=e.head=e.take=function(a,b,d){return null!=b&&!d?f.call(a,0,b):a[0]};e.initial=function(a,b,d){return f.call(a,0,a.length-(null==b||d?1:b))};e.last=function(a,b,d){return null!=b&&!d?f.call(a,Math.max(a.length-b,0)):a[a.length-
1]};e.rest=e.tail=function(a,b,d){return f.call(a,null==b||d?1:b)};e.compact=function(a){return e.filter(a,function(a){return!!a})};e.flatten=function(a,b){return e.reduce(a,function(a,d){return e.isArray(d)?a.concat(b?d:e.flatten(d)):(a[a.length]=d,a)},[])};e.without=function(a){return e.difference(a,f.call(arguments,1))};e.uniq=e.unique=function(a,b,d){var d=d?e.map(a,d):a,c=[];return 3>a.length&&(b=!0),e.reduce(d,function(d,f,h){if(b?e.last(d)!==f||!d.length:!e.include(d,f))d.push(f),c.push(a[h]);
return d},[]),c};e.union=function(){return e.uniq(e.flatten(arguments,!0))};e.intersection=e.intersect=function(a){var b=f.call(arguments,1);return e.filter(e.uniq(a),function(a){return e.every(b,function(b){return 0<=e.indexOf(b,a)})})};e.difference=function(a){var b=e.flatten(f.call(arguments,1),!0);return e.filter(a,function(a){return!e.include(b,a)})};e.zip=function(){for(var a=f.call(arguments),b=e.max(e.pluck(a,"length")),d=Array(b),c=0;c<b;c++)d[c]=e.pluck(a,""+c);return d};e.indexOf=function(a,
b,d){if(null==a)return-1;var c;if(d)return c=e.sortedIndex(a,b),a[c]===b?c:-1;if(u&&a.indexOf===u)return a.indexOf(b);c=0;for(d=a.length;c<d;c++)if(c in a&&a[c]===b)return c;return-1};e.lastIndexOf=function(a,b){if(null==a)return-1;if(D&&a.lastIndexOf===D)return a.lastIndexOf(b);for(var d=a.length;d--;)if(d in a&&a[d]===b)return d;return-1};e.range=function(a,b,d){1>=arguments.length&&(b=a||0,a=0);for(var d=arguments[2]||1,c=Math.max(Math.ceil((b-a)/d),0),f=0,e=Array(c);f<c;)e[f++]=a,a+=d;return e};
var F=function(){};e.bind=function(a,b){var d,c;if(a.bind===v&&v)return v.apply(a,f.call(arguments,1));if(!e.isFunction(a))throw new TypeError;return c=f.call(arguments,2),d=function(){if(this instanceof d){F.prototype=a.prototype;var e=new F,h=a.apply(e,c.concat(f.call(arguments)));return Object(h)===h?h:e}return a.apply(b,c.concat(f.call(arguments)))}};e.bindAll=function(a){var b=f.call(arguments,1);return 0==b.length&&(b=e.functions(a)),l(b,function(b){a[b]=e.bind(a[b],a)}),a};e.memoize=function(a,
b){var d={};return b||(b=e.identity),function(){var c=b.apply(this,arguments);return e.has(d,c)?d[c]:d[c]=a.apply(this,arguments)}};e.delay=function(a,b){var d=f.call(arguments,2);return setTimeout(function(){return a.apply(null,d)},b)};e.defer=function(a){return e.delay.apply(e,[a,1].concat(f.call(arguments,1)))};e.throttle=function(a,b){var d,c,f,h,g,n,i=e.debounce(function(){g=h=!1},b);return function(){d=this;c=arguments;return f||(f=setTimeout(function(){f=null;g&&a.apply(d,c);i()},b)),h?g=!0:
n=a.apply(d,c),i(),h=!0,n}};e.debounce=function(a,b,d){var c;return function(){var f=this,e=arguments;d&&!c&&a.apply(f,e);clearTimeout(c);c=setTimeout(function(){c=null;d||a.apply(f,e)},b)}};e.once=function(a){var b=!1,d;return function(){return b?d:(b=!0,d=a.apply(this,arguments))}};e.wrap=function(a,b){return function(){var d=[a].concat(f.call(arguments,0));return b.apply(this,d)}};e.compose=function(){var a=arguments;return function(){for(var b=arguments,d=a.length-1;0<=d;d--)b=[a[d].apply(this,
b)];return b[0]}};e.after=function(a,b){return 0>=a?b():function(){if(1>--a)return b.apply(this,arguments)}};e.keys=G||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[],d;for(d in a)e.has(a,d)&&(b[b.length]=d);return b};e.values=function(a){return e.map(a,e.identity)};e.functions=e.methods=function(a){var b=[],d;for(d in a)e.isFunction(a[d])&&b.push(d);return b.sort()};e.extend=function(a){return l(f.call(arguments,1),function(b){for(var d in b)a[d]=b[d]}),a};e.pick=function(a){var b=
{};return l(e.flatten(f.call(arguments,1)),function(d){d in a&&(b[d]=a[d])}),b};e.defaults=function(a){return l(f.call(arguments,1),function(b){for(var d in b)null==a[d]&&(a[d]=b[d])}),a};e.clone=function(a){return e.isObject(a)?e.isArray(a)?a.slice():e.extend({},a):a};e.tap=function(a,b){return b(a),a};e.isEqual=function(a,b){return i(a,b,[])};e.isEmpty=function(a){if(null==a)return!0;if(e.isArray(a)||e.isString(a))return 0===a.length;for(var b in a)if(e.has(a,b))return!1;return!0};e.isElement=function(a){return!!a&&
1==a.nodeType};e.isArray=d||function(a){return"[object Array]"==n.call(a)};e.isObject=function(a){return a===Object(a)};e.isArguments=function(a){return"[object Arguments]"==n.call(a)};e.isArguments(arguments)||(e.isArguments=function(a){return!!a&&!!e.has(a,"callee")});e.isFunction=function(a){return"[object Function]"==n.call(a)};e.isString=function(a){return"[object String]"==n.call(a)};e.isNumber=function(a){return"[object Number]"==n.call(a)};e.isFinite=function(a){return e.isNumber(a)&&isFinite(a)};
e.isNaN=function(a){return a!==a};e.isBoolean=function(a){return!0===a||!1===a||"[object Boolean]"==n.call(a)};e.isDate=function(a){return"[object Date]"==n.call(a)};e.isRegExp=function(a){return"[object RegExp]"==n.call(a)};e.isNull=function(a){return null===a};e.isUndefined=function(a){return void 0===a};e.has=function(a,b){return j.call(a,b)};e.noConflict=function(){return c._=g,this};e.identity=function(a){return a};e.times=function(a,b,d){for(var c=0;c<a;c++)b.call(d,c)};e.escape=function(a){return(""+
a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};e.result=function(a,b){if(null==a)return null;var d=a[b];return e.isFunction(d)?d.call(a):d};e.mixin=function(a){l(e.functions(a),function(b){var d=e[b]=a[b];s.prototype[b]=function(){var a=f.call(arguments);return h.call(a,this._wrapped),w(d.apply(e,a),this._chain)}})};var H=0;e.uniqueId=function(a){var b=H++;return a?a+b:b};e.templateSettings={evaluate:/<%([\s\S]+?)%>/g,
interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var x=/.^/,t={"\\":"\\","'":"'",r:"\r",n:"\n",t:"\t",u2028:"\u2028",u2029:"\u2029"},y;for(y in t)t[t[y]]=y;var I=/\\|'|\r|\n|\t|\u2028|\u2029/g,J=/\\(\\|'|r|n|t|u2028|u2029)/g,z=function(a){return a.replace(J,function(a,b){return t[b]})};e.template=function(a,b,d){d=e.defaults(d||{},e.templateSettings);a="__p+='"+a.replace(I,function(a){return"\\"+t[a]}).replace(d.escape||x,function(a,b){return"'+\n_.escape("+z(b)+")+\n'"}).replace(d.interpolate||
x,function(a,b){return"'+\n("+z(b)+")+\n'"}).replace(d.evaluate||x,function(a,b){return"';\n"+z(b)+"\n;__p+='"})+"';\n";d.variable||(a="with(obj||{}){\n"+a+"}\n");var a="var __p='';var print=function(){__p+=Array.prototype.join.call(arguments, '')};\n"+a+"return __p;\n",c=new Function(d.variable||"obj","_",a);if(b)return c(b,e);b=function(a){return c.call(this,a,e)};return b.source="function("+(d.variable||"obj")+"){\n"+a+"}",b};e.chain=function(a){return e(a).chain()};var s=function(a){this._wrapped=
a};e.prototype=s.prototype;var w=function(a,b){return b?e(a).chain():a};e.mixin(e);l("pop push reverse shift sort splice unshift".split(" "),function(b){var d=a[b];s.prototype[b]=function(){var a=this._wrapped;d.apply(a,arguments);var c=a.length;return("shift"==b||"splice"==b)&&0===c&&delete a[0],w(a,this._chain)}});l(["concat","join","slice"],function(b){var d=a[b];s.prototype[b]=function(){return w(d.apply(this._wrapped,arguments),this._chain)}});s.prototype.chain=function(){return this._chain=
!0,this};s.prototype.value=function(){return this._wrapped}}).call(this);
(function(i){i.Parse=i.Parse||{};var c=i.Parse;"undefined"!=typeof exports&&exports._?(c._=exports._.noConflict(),exports.Parse=c):c._=_.noConflict();"undefined"!=typeof $&&(c.$=$);var g=function(){};c.serverURL="https://api.parse.com";c.initialize=function(b,a){c._initialize(b,a)};c._initialize=function(b,a,d){c.applicationId=b;c.javaScriptKey=a;c.masterKey=d;c._useMasterKey=!1};c._getParsePath=function(b){if(!c.applicationId)throw"You need to call Parse.initialize before using Parse.";b||(b="");
if(!c._.isString(b))throw"Tried to get a localStorage path that wasn't a String.";return"/"===b[0]&&(b=b.substring(1)),"Parse/"+c.applicationId+"/"+b};c._installationId=null;c._getInstallationId=function(){if(c._installationId)return c._installationId;var b=c._getParsePath("installationId");c._installationId=localStorage.getItem(b);if(!c._installationId||""===c._installationId){var a=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)};c._installationId=a()+a()+"-"+a()+
"-"+a()+"-"+a()+"-"+a()+a()+a();localStorage.setItem(b,c._installationId)}return c._installationId};c._parseDate=function(b){b=/^([0-9]{1,4})-([0-9]{1,2})-([0-9]{1,2})T([0-9]{1,2}):([0-9]{1,2}):([0-9]{1,2})(.([0-9]+))?Z$/.exec(b);return!b?null:new Date(Date.UTC(b[1]||0,(b[2]||1)-1,b[3]||0,b[4]||0,b[5]||0,b[6]||0,b[8]||0))};c._ajaxIE8=function(b,a,d,c,h){var g=new XDomainRequest;g.onload=function(){var a;try{a=JSON.parse(g.responseText)}catch(b){h&&h(g)}a&&c&&c(a,g)};g.onerror=g.ontimeout=function(){h(g)};
g.onprogress=function(){};g.open(b,a);g.send(d)};c._ajax=function(b,a,d,f,h){if("undefined"!=typeof XDomainRequest)return c._ajaxIE8(b,a,d,f,h);var g=!1,i=new XMLHttpRequest;i.onreadystatechange=function(){if(4===i.readyState&&!g)if(g=!0,200<=i.status&&300>i.status){var a;try{a=JSON.parse(i.responseText)}catch(b){h&&h(i)}a&&f&&f(a,i)}else h&&h(i)};i.open(b,a,!0);i.setRequestHeader("Content-Type","text/plain");i.send(d)};c._extend=function(b,a){var d,f=this,h;d=(b&&b.hasOwnProperty("constructor")?
h=b.constructor:h=function(){f.apply(this,arguments)},c._.extend(h,f),g.prototype=f.prototype,h.prototype=new g,b&&c._.extend(h.prototype,b),a&&c._.extend(h,a),h.prototype.constructor=h,h.__super__=f.prototype,h);return d.extend=this.extend,d};c._request=function(b,a,d,f,h,g){if(!c.applicationId)throw"You must specify your applicationId using Parse.initialize";if(!c.javaScriptKey&&!c.masterKey)throw"You must specify a key using Parse.initialize";if("classes"!==b&&"users"!==b&&"login"!==b&&"requestPasswordReset"!==
b)throw"First argument must be one of classes, users, or login, not '"+b+"'.";b=c.serverURL+"/1/"+b;a&&(b+="/"+a);d&&(b+="/"+d);h=c._.clone(h||{});"POST"!==f&&(h._method=f,f="POST");h._ApplicationId=c.applicationId;c._useMasterKey?h._MasterKey=c.masterKey:h._JavaScriptKey=c.javaScriptKey;h._ClientVersion="js"+c.VERSION;h._InstallationId=c._getInstallationId();(a=c.User.current())&&a._sessionToken&&(h._SessionToken=a._sessionToken);h=JSON.stringify(h);c._ajax(f,b,h,g.success,g.error)};c._getValue=
function(b,a){return!b||!b[a]?null:c._.isFunction(b[a])?b[a]():b[a]};c._encode=function(b,a){var d=c._;if(b instanceof c.Object){if(!a||d.include(a,b)||!b._hasData)return b._toPointer();if(!b.dirty())return a=a.concat(b),c._encode(b._toFullJSON(a),a);throw"Can't fully embed a dirty object";}if(b instanceof c.ACL)return b.toJSON();if(b instanceof Date)return{__type:"Date",iso:b.toJSON()};if(b instanceof c.GeoPoint)return b.toJSON();if(d.isArray(b))return d.map(b,function(b){return c._encode(b,a)});
if(d.isRegExp(b))return b.source;if(b instanceof c.Relation||b instanceof c.Op)return b.toJSON();if(b instanceof Object){var f={};return c._each(b,function(b,d){f[d]=c._encode(b,a)}),f}return b};c._decode=function(b,a){var d=c._;return!d.isObject(a)?a:d.isArray(a)?(c._each(a,function(b,d){a[d]=c._decode(d,b)}),a):a instanceof c.Object||a instanceof c.Op?a:a.__op?c.Op._decode(a):a.objectId?"Pointer"===a.__type?(d=c.Object._create(a.className),d._finishFetch({objectId:a.objectId},!1),d):"Object"===
a.__type?(d=a.className,delete a.__type,delete a.className,d=c.Object._create(d),d._finishFetch(a,!0),d):(c._each(a,function(b,d){a[d]=c._decode(d,b)}),c.Object._create(a.className,a)):"Date"===a.__type?c._parseDate(a.iso):"GeoPoint"===a.__type?new c.GeoPoint({latitude:a.latitude,longitude:a.longitude}):"ACL"===b?a instanceof c.ACL?a:new c.ACL(a):"Relation"===a.__type?(d=new c.Relation(null,b),d.targetClassName=a.className,d):a};c._each=function(b,a){var d=c._;d.isObject(b)?d.each(d.keys(b),function(d){a(b[d],
d)}):d.each(b,a)};c._isNullOrUndefined=function(b){return c._.isNull(b)||c._.isUndefined(b)}})(this);
(function(i){i.Parse=i.Parse||{};var i=i.Parse,c=i._;i.Error=function(c,b){this.code=c;this.message=b};c.extend(i.Error,{OTHER_CAUSE:-1,INTERNAL_SERVER_ERROR:1,CONNECTION_FAILED:100,OBJECT_NOT_FOUND:101,INVALID_QUERY:102,INVALID_CLASS_NAME:103,MISSING_OBJECT_ID:104,INVALID_KEY_NAME:105,INVALID_POINTER:106,INVALID_JSON:107,COMMAND_UNAVAILABLE:108,NOT_INITIALIZED:109,INCORRECT_TYPE:111,INVALID_CHANNEL_NAME:112,PUSH_MISCONFIGURED:115,OBJECT_TOO_LARGE:116,OPERATION_FORBIDDEN:119,CACHE_MISS:120,INVALID_NESTED_KEY:121,
INVALID_FILE_NAME:122,INVALID_ACL:123,TIMEOUT:124,INVALID_EMAIL_ADDRESS:125,DUPLICATE_VALUE:137,INVALID_ROLE_NAME:139,EXCEEDED_QUOTA:140,USERNAME_MISSING:200,PASSWORD_MISSING:201,USERNAME_TAKEN:202,EMAIL_TAKEN:203,EMAIL_MISSING:204,EMAIL_NOT_FOUND:205,SESSION_MISSING:206,MUST_CREATE_USER_THROUGH_SIGNUP:207,ACCOUNT_ALREADY_LINKED:208,LINKED_ID_MISSING:250,INVALID_LINKED_SESSION:251,UNSUPPORTED_SERVICE:252})})(this);
(function(){var i=this.Parse||(this.Parse={}),c=/\s+/,g=Array.prototype.slice;i.Events={on:function(b,a,d){var f,h,g,i,m;if(!a)return this;b=b.split(c);f=this._callbacks||(this._callbacks={});for(h=b.shift();h;)g=(m=f[h])?m.tail:{},g.next=i={},g.context=d,g.callback=a,f[h]={tail:i,next:m?m.next:g},h=b.shift();return this},off:function(b,a,d){var f,h,g,i,m,q;if(h=this._callbacks){if(!b&&!a&&!d)return delete this._callbacks,this;b=b?b.split(c):_.keys(h);for(f=b.shift();f;)if(g=h[f],delete h[f],g&&(a||
d)){i=g.tail;for(g=g.next;g!==i;)m=g.callback,q=g.context,(a&&m!==a||d&&q!==d)&&this.on(f,m,q),g=g.next;f=b.shift()}return this}},trigger:function(b){var a,d,f,h,i,j;if(!(f=this._callbacks))return this;i=f.all;b=b.split(c);j=g.call(arguments,1);for(a=b.shift();a;){if(d=f[a])for(h=d.tail;(d=d.next)!==h;)d.callback.apply(d.context||this,j);if(d=i){h=d.tail;for(a=[a].concat(j);(d=d.next)!==h;)d.callback.apply(d.context||this,a)}a=b.shift()}return this}};i.Events.bind=i.Events.on;i.Events.unbind=i.Events.off}).call(this);
(function(i){i.Parse=i.Parse||{};var c=i.Parse,g=c._;c.GeoPoint=function(b,a){g.isArray(b)?(c.GeoPoint._validate(b[0],b[1]),this.latitude=b[0],this.longitude=b[1]):g.isObject(b)?(c.GeoPoint._validate(b.latitude,b.longitude),this.latitude=b.latitude,this.longitude=b.longitude):g.isNumber(b)&&g.isNumber(a)?(c.GeoPoint._validate(b,a),this.latitude=b,this.longitude=a):(this.latitude=0,this.longitude=0);var d=this;this.__defineGetter__&&this.__defineSetter__&&(this._latitude=this.latitude,this._longitude=
this.longitude,this.__defineGetter__("latitude",function(){return d._latitude}),this.__defineGetter__("longitude",function(){return d._longitude}),this.__defineSetter__("latitude",function(a){c.GeoPoint._validate(a,d.longitude);d._latitude=a}),this.__defineSetter__("longitude",function(a){c.GeoPoint._validate(d.latitude,a);d._longitude=a}))};c.GeoPoint._validate=function(b,a){if(-90>b)throw"Parse.GeoPoint latitude "+b+" < -90.0.";if(90<b)throw"Parse.GeoPoint latitude "+b+" > 90.0.";if(-180>a)throw"Parse.GeoPoint longitude "+
a+" < -180.0.";if(180<a)throw"Parse.GeoPoint longitude "+a+" > 180.0.";};c.GeoPoint.current=function(b){navigator.geolocation.getCurrentPosition(function(a){b.success&&b.success(new c.GeoPoint({latitude:a.coords.latitude,longitude:a.coords.longitude}))},function(a){b.error&&b.error(a)})};c.GeoPoint.prototype={toJSON:function(){return c.GeoPoint._validate(this.latitude,this.longitude),{__type:"GeoPoint",latitude:this.latitude,longitude:this.longitude}},radiansTo:function(b){var a=Math.PI/180,d=this.latitude*
a,c=b.latitude*a,a=this.longitude*a-b.longitude*a,b=Math.sin((d-c)/2),a=Math.sin(a/2),d=b*b+Math.cos(d)*Math.cos(c)*a*a;return d=Math.min(1,d),2*Math.asin(Math.sqrt(d))},kilometersTo:function(b){return 6371*this.radiansTo(b)},milesTo:function(b){return 3958.8*this.radiansTo(b)}}})(this);
(function(i){i.Parse=i.Parse||{};var c=i.Parse,g=c._;c.ACL=function(b){var a=this;a.permissionsById={};if(g.isObject(b))if(b instanceof c.User)a.setReadAccess(b,!0),a.setWriteAccess(b,!0);else{if(g.isFunction(b))throw"Parse.ACL() called with a function.  Did you forget ()?";c._each(b,function(b,f){if(!g.isString(f))throw"Tried to create an ACL with an invalid userId.";a.permissionsById[f]={};c._each(b,function(b,d){if("read"!==d&&"write"!==d)throw"Tried to create an ACL with an invalid permission type.";
if(!g.isBoolean(b))throw"Tried to create an ACL with an invalid permission value.";a.permissionsById[f][d]=b})})}};c.ACL.prototype.toJSON=function(){return g.clone(this.permissionsById)};c.ACL.prototype._setAccess=function(b,a,d){a instanceof c.User?a=a.id:a instanceof c.Role&&(a="role:"+a.getName());if(!g.isString(a))throw"userId must be a string.";if(!g.isBoolean(d))throw"allowed must be either true or false.";var f=this.permissionsById[a];if(!f){if(!d)return;f={};this.permissionsById[a]=f}d?this.permissionsById[a][b]=
!0:(delete f[b],g.isEmpty(f)&&delete f[a])};c.ACL.prototype._getAccess=function(b,a){a instanceof c.User?a=a.id:a instanceof c.Role&&(a="role:"+a.getName());var d=this.permissionsById[a];return d?d[b]?!0:!1:!1};c.ACL.prototype.setReadAccess=function(b,a){this._setAccess("read",b,a)};c.ACL.prototype.getReadAccess=function(b){return this._getAccess("read",b)};c.ACL.prototype.setWriteAccess=function(b,a){this._setAccess("write",b,a)};c.ACL.prototype.getWriteAccess=function(b){return this._getAccess("write",
b)};c.ACL.prototype.setPublicReadAccess=function(b){this.setReadAccess("*",b)};c.ACL.prototype.getPublicReadAccess=function(){return this.getReadAccess("*")};c.ACL.prototype.setPublicWriteAccess=function(b){this.setWriteAccess("*",b)};c.ACL.prototype.getPublicWriteAccess=function(){return this.getWriteAccess("*")};c.ACL.prototype.getRoleReadAccess=function(b){b instanceof c.Role&&(b=b.getName());if(g.isString(b))return this.getReadAccess("role:"+b);throw"role must be a Parse.Role or a String";};c.ACL.prototype.getRoleWriteAccess=
function(b){b instanceof c.Role&&(b=b.getName());if(g.isString(b))return this.getWriteAccess("role:"+b);throw"role must be a Parse.Role or a String";};c.ACL.prototype.setRoleReadAccess=function(b,a){b instanceof c.Role&&(b=b.getName());if(g.isString(b))this.setReadAccess("role:"+b,a);else throw"role must be a Parse.Role or a String";};c.ACL.prototype.setRoleWriteAccess=function(b,a){b instanceof c.Role&&(b=b.getName());if(g.isString(b))this.setWriteAccess("role:"+b,a);else throw"role must be a Parse.Role or a String";
}})(this);
(function(i){i.Parse=i.Parse||{};var c=i.Parse,g=c._;c.Op=function(){this._initialize.apply(this,arguments)};c.Op.prototype={_initialize:function(){}};g.extend(c.Op,{_extend:c._extend,_opDecoderMap:{},_registerDecoder:function(b,a){c.Op._opDecoderMap[b]=a},_decode:function(b){var a=c.Op._opDecoderMap[b.__op];return a?a(b):void 0}});c.Op._registerDecoder("Batch",function(b){var a=null;return g.each(b.ops,function(b){b=c.Op._decode(b);a=b._mergeWithPrevious(a)}),a});c.Op.Set=c.Op._extend({_initialize:function(b){this._value=b},
value:function(){return this._value},toJSON:function(){return c._encode(this.value())},_mergeWithPrevious:function(){return this},_estimate:function(){return this.value()}});c.Op._UNSET={};c.Op.Unset=c.Op._extend({toJSON:function(){return{__op:"Delete"}},_mergeWithPrevious:function(){return this},_estimate:function(){return c.Op._UNSET}});c.Op._registerDecoder("Delete",function(){return new c.Op.Unset});c.Op.Increment=c.Op._extend({_initialize:function(b){this._amount=b},amount:function(){return this._amount},
toJSON:function(){return{__op:"Increment",amount:this._amount}},_mergeWithPrevious:function(b){if(!b)return this;if(b instanceof c.Op.Unset)return new c.Op.Set(this.amount());if(b instanceof c.Op.Set)return new c.Op.Set(b.value()+this.amount());if(b instanceof c.Op.Increment)return new c.Op.Increment(this.amount()+b.amount());throw"Op is invalid after previous op.";},_estimate:function(b){return b?b+this.amount():this.amount()}});c.Op._registerDecoder("Increment",function(b){return new c.Op.Increment(b.amount)});
c.Op.Add=c.Op._extend({_initialize:function(b){this._objects=b},objects:function(){return this._objects},toJSON:function(){return{__op:"Add",objects:this.objects()}},_mergeWithPrevious:function(b){if(!b)return this;if(b instanceof c.Op.Unset)return new c.Op.Set(this.objects());if(b instanceof c.Op.Set)return new c.Op.Set(this._estimate(b.value()));if(b instanceof c.Op.Add)return new c.Op.Add(b.objects().concat(this.objects()));throw"Op is invalid after previous op.";},_estimate:function(b){return b?
b.concat(this.objects()):g.clone(this.objects())}});c.Op._registerDecoder("Add",function(b){return new c.Op.Add(c._decode(b.objects))});c.Op.AddUnique=c.Op._extend({_initialize:function(b){this._objects=g.uniq(b)},objects:function(){return this._objects},toJSON:function(){return{__op:"AddUnique",objects:this.objects()}},_mergeWithPrevious:function(b){if(!b)return this;if(b instanceof c.Op.Unset)return new c.Op.Set(this.objects());if(b instanceof c.Op.Set)return new c.Op.Set(this._estimate(b.value()));
if(b instanceof c.Op.AddUnique)return new c.Op.AddUnique(g.union(b.objects(),this.objects()));throw"Op is invalid after previous op.";},_estimate:function(b){return b?b.concat(g.difference(this.objects(),b)):g.clone(this.objects())}});c.Op._registerDecoder("AddUnique",function(b){return new c.Op.AddUnique(c._decode(b.objects))});c.Op.Remove=c.Op._extend({_initialize:function(b){this._objects=g.uniq(b)},objects:function(){return this._objects},toJSON:function(){return{__op:"Remove",objects:this.objects()}},
_mergeWithPrevious:function(b){if(!b)return this;if(b instanceof c.Op.Unset)return b;if(b instanceof c.Op.Set)return new c.Op.Set(this._estimate(b.value()));if(b instanceof c.Op.Remove)return new c.Op.Remove(g.union(b.objects(),this.objects()));throw"Op is invalid after previous op.";},_estimate:function(b){return b?g.difference(b,this.objects()):[]}});c.Op._registerDecoder("Remove",function(b){return new c.Op.Remove(c._decode(b.objects))});c.Op.Relation=c.Op._extend({_initialize:function(b,a){this._targetClassName=
null;var d=this,f=function(a){if(a instanceof c.Object){if(!a.id)throw"You can't add an unsaved Parse.Object to a relation.";d._targetClassName||(d._targetClassName=a.className);if(d._targetClassName!==a.className)throw"Tried to create a Parse.Relation with 2 different types: "+d._targetClassName+" and "+a.className+".";return a.id}return a};this.relationsToAdd=g.uniq(g.map(b,f));this.relationsToRemove=g.uniq(g.map(a,f))},added:function(){var b=this;return g.map(this.relationsToAdd,function(a){var d=
c.Object._create(b._targetClassName);return d.id=a,d})},removed:function(){var b=this;return g.map(this.relationsToRemove,function(a){var d=c.Object._create(b._targetClassName);return d.id=a,d})},toJSON:function(){var b=null,a=null,d=this,c=function(a){return{__type:"Pointer",className:d._targetClassName,objectId:a}},h=null;return 0<this.relationsToAdd.length&&(h=g.map(this.relationsToAdd,c),b={__op:"AddRelation",objects:h}),0<this.relationsToRemove.length&&(h=g.map(this.relationsToRemove,c),a={__op:"RemoveRelation",
objects:h}),b&&a?{__op:"Batch",ops:[b,a]}:b||a||{}},_mergeWithPrevious:function(b){if(!b)return this;if(b instanceof c.Op.Unset)throw"You can't modify a relation after deleting it.";if(b instanceof c.Op.Relation){if(b._targetClassName&&b._targetClassName!==this._targetClassName)throw"Related object must be of class "+b._targetClassName+", but "+this._targetClassName+" was passed in.";var a=g.union(g.difference(b.relationsToAdd,this.relationsToRemove),this.relationsToAdd),b=g.union(g.difference(b.relationsToRemove,
this.relationsToAdd),this.relationsToRemove),a=new c.Op.Relation(a,b);return a._targetClassName=this._targetClassName,a}throw"Op is invalid after previous op.";},_estimate:function(b,a,d){if(b){if(b instanceof c.Relation){if(this._targetClassName)if(b.targetClassName){if(b.targetClassName!==this._targetClassName)throw"Related object must be a "+b.targetClassName+", but a "+this._targetClassName+" was passed in.";}else b.targetClassName=this._targetClassName;return b}throw"Op is invalid after previous op.";
}(new c.Relation(a,d)).targetClassName=this._targetClassName}});c.Op._registerDecoder("AddRelation",function(b){return new c.Op.Relation(b.objects,[])});c.Op._registerDecoder("RemoveRelation",function(b){return new c.Op.Relation([],b.objects)})})(this);
(function(i){i.Parse=i.Parse||{};var c=i.Parse,g=c._;c.Relation=function(b,a){this.parent=b;this.key=a;this.targetClassName=null};c.Relation.prototype={_ensureParentAndKey:function(b,a){this.parent=this.parent||b;this.key=this.key||a;if(this.parent!==b)throw"Internal Error. Relation retrieved from two different Objects.";if(this.key!==a)throw"Internal Error. Relation retrieved from two different keys.";},add:function(b){g.isArray(b)||(b=[b]);b=new c.Op.Relation(b,[]);this.parent.set(this.key,b);this.targetClassName=
b._targetClassName},remove:function(b){g.isArray(b)||(b=[b]);b=new c.Op.Relation([],b);this.parent.set(this.key,b);this.targetClassName=b._targetClassName},toJSON:function(){return{__type:"Relation",className:this.targetClassName}},query:function(){var b=c.Object._getSubclass(this.targetClassName),b=new c.Query(b);return b._addCondition("$relatedTo","object",this.parent._toPointer()),b._addCondition("$relatedTo","key",this.key),b}}})(this);
(function(i){i.Parse=i.Parse||{};var c=i.Parse,g=c._;c.Object=function(a,b){if(g.isString(a))return c.Object._create.apply(this,arguments);a=a||{};b&&b.parse&&(a=this.parse(a));var f=c._getValue(this,"defaults");f&&(a=g.extend({},f,a));b&&b.collection&&(this.collection=b.collection);this._serverData={};this._opSetQueue=[{}];this.attributes={};this._hashedJSON={};this._escapedAttributes={};this.cid=g.uniqueId("c");this.changed={};this._silent={};this._pending={};if(!this.set(a,{silent:!0}))throw Error("Can't create an invalid Parse.Object");
this.changed={};this._silent={};this._pending={};this._hasData=!0;this._previousAttributes=g.clone(this.attributes);this.initialize.apply(this,arguments)};var b=function(a,d,c,h){var c=c||[],i;i=g.isFunction(h)?{success:function(a){h(a,null)},error:function(a){h(null,a)}}:h;if(a.length){var j=i?g.clone(i):{};j.success=function(h){c.push(h);b(g.rest(a),d,c,i)};d.call(this,g.first(a),j)}else i.success&&i.success(c)};c.Object.saveAll=function(a,d){b(a,function(a,b){a.save(null,b)},[],d)};c.Object._signUpAll=
function(a,d){b(a,function(a,b){a.signUp(null,b)},[],d)};g.extend(c.Object.prototype,c.Events,{_existed:!1,initialize:function(){},toJSON:function(){var a=this._toFullJSON();return g.each(["createdAt","objectId","updatedAt","__type","className"],function(b){delete a[b]}),a},_toFullJSON:function(a){var b=g.clone(this.attributes);return c._each(b,function(f,h){b[h]=c._encode(f,a)}),c._each(this._operations,function(a,c){b[c]=a}),b.objectId=this.id,b.createdAt=this.createdAt,b.updatedAt=this.updatedAt,
b.__type="Object",b.className=this.className,b},_refreshCache:function(){var a=this;c._each(this.attributes,function(b,f){b instanceof c.Object?b._refreshCache():g.isObject(b)&&a._resetCacheForKey(f)&&a.set(f,new c.Op.Set(b),{silent:!0})})},dirty:function(a){this._refreshCache();var b=g.last(this._opSetQueue);return a?b[a]?!0:!1:this.id?0<g.keys(b).length?!0:!1:!0},_toPointer:function(){if(!this.id)throw Error("Can't serialize an unsaved Parse.Object");return{__type:"Pointer",className:this.className,
objectId:this.id}},get:function(a){return this.attributes[a]},relation:function(a){var b=this.get(a);if(b){if(b instanceof c.Relation)return b._ensureParentAndKey(this,a),b;throw"Called relation() on non-relation field "+a;}return new c.Relation(this,a)},escape:function(a){var b=this._escapedAttributes[a];if(b)return b;var b=this.attributes[a],f;return c._isNullOrUndefined(b)?f="":f=g.escape(b.toString()),this._escapedAttributes[a]=f,f},has:function(a){return!c._isNullOrUndefined(this.attributes[a])},
_mergeMagicFields:function(a){var b=this;g.each(["id","objectId","createdAt","updatedAt"],function(c){a[c]&&("objectId"===c?b.id=a[c]:b[c]=a[c],delete a[c])})},_startSave:function(){this._opSetQueue.push({})},_processSaveQueue:function(){if(this._saveQueue&&0<this._saveQueue.length){var a=g.first(this._saveQueue);this._saveQueue=g.rest(this._saveQueue);a()}else this._saving=!1},_cancelSave:function(){var a=g.first(this._opSetQueue);this._opSetQueue=g.rest(this._opSetQueue);var b=g.first(this._opSetQueue);
c._each(a,function(c,h){var g=a[h],i=b[h];g&&i?b[h]=i._mergeWithPrevious(g):g&&(b[h]=g)});this._processSaveQueue()},_finishSave:function(a){var b=g.first(this._opSetQueue);this._opSetQueue=g.rest(this._opSetQueue);this._applyOpSet(b,this._serverData);this._mergeMagicFields(a);var f=this;c._each(a,function(a,b){f._serverData[b]=c._decode(b,a)});this._rebuildAllEstimatedData();this._processSaveQueue()},_finishFetch:function(a,b){this._mergeMagicFields(a);var f=this;c._each(a,function(a,b){f._serverData[b]=
c._decode(b,a)});this._refreshCache();this._hasData=b;this._opSetQueue=[{}];this._rebuildAllEstimatedData()},_applyOpSet:function(a,b){var f=this;c._.each(a,function(a,g){b[g]=a._estimate(b[g],f,g);b[g]===c.Op._UNSET&&delete b[g]})},_resetCacheForKey:function(a){var b=this.attributes[a];return g.isObject(b)&&!(b instanceof c.Object)&&(b=b.toJSON?b.toJSON():b,b=JSON.stringify(b),this._hashedJSON[a]!==b)?(this._hashedJSON[a]=b,!0):!1},_rebuildEstimatedDataForKey:function(a){var b=this;delete this.attributes[a];
this._serverData[a]&&(this.attributes[a]=this._serverData[a]);g.each(this._opSetQueue,function(f){(f=f[a])&&(b.attributes[a]=f._estimate(b.attributes[a],b,a),b.attributes[a]===c.Op._UNSET?delete b.attributes[a]:b._resetCacheForKey(a))})},_rebuildAllEstimatedData:function(){var a=this;this.attributes=g.clone(this._serverData);g.each(this._opSetQueue,function(b){a._applyOpSet(b,a.attributes);g.each(b,function(b,d){a._resetCacheForKey(d)})})},set:function(a,b,f){var h;g.isObject(a)||c._isNullOrUndefined(a)?
(h=a,c._each(h,function(a,b){h[b]=c._decode(b,a)}),f=b):(h={},h[a]=c._decode(a,b));f=f||{};if(!h)return this;h instanceof c.Object&&(h=h.attributes);f.unset&&c._each(h,function(a,b){h[b]=new c.Op.Unset});var i=g.clone(h),j=this;c._each(i,function(a,b){a instanceof c.Op&&(i[b]=a._estimate(j.attributes[b],j,b),i[b]===c.Op._UNSET&&delete i[b])});if(!this._validate(h,f))return!1;this._mergeMagicFields(h);f.changes={};var m=this._escapedAttributes;return c._each(g.keys(h),function(a){var b=h[a];b instanceof
c.Relation&&(b.parent=j);b instanceof c.Op||(b=new c.Op.Set(b));var d=!0;b instanceof c.Op.Set&&g.isEqual(j.attributes[a],b.value)&&(d=!1);d&&(delete m[a],f.silent?j._silent[a]=!0:f.changes[a]=!0);var i=g.last(j._opSetQueue);i[a]=b._mergeWithPrevious(i[a]);j._rebuildEstimatedDataForKey(a);d?(j.changed[a]=j.attributes[a],f.silent||(j._pending[a]=!0)):(delete j.changed[a],delete j._pending[a])}),f.silent||this.change(f),this},unset:function(a,b){return b=b||{},b.unset=!0,this.set(a,null,b)},increment:function(a,
b){if(g.isUndefined(b)||g.isNull(b))b=1;return this.set(a,new c.Op.Increment(b))},add:function(a,b){return this.set(a,new c.Op.Add([b]))},addUnique:function(a,b){return this.set(a,new c.Op.AddUnique([b]))},remove:function(a,b){return this.set(a,new c.Op.Remove([b]))},op:function(a){return g.last(this._opSetQueue)[a]},clear:function(a){a=a||{};a.unset=!0;var b=g.extend(this.attributes,this._operations);return this.set(b,a)},_getSaveJSON:function(){var a=g.clone(g.first(this._opSetQueue));return c._each(a,
function(b,c){a[c]=b.toJSON()}),a},fetch:function(a){var a=a?g.clone(a):{},b=this,f=a.success;a.success=function(a,c,g){b._finishFetch(b.parse(a,c,g),!0);f&&f(b,a)};a.error=c.Object._wrapError(a.error,b,a);c._request("classes",b.className,b.id,"GET",null,a)},save:function(a,b,f){var h,i,j;g.isObject(a)||c._isNullOrUndefined(a)?(h=a,j=b):(h={},h[a]=b,j=f);if(!j&&h&&0===g.reject(h,function(a,b){return g.include(["success","error","wait"],b)}).length&&(a=!0,g.has(h,"success")&&!g.isFunction(h.success)&&
(a=!1),g.has(h,"error")&&!g.isFunction(h.error)&&(a=!1),a))return this.save(null,h);j=j?g.clone(j):{};j.wait&&(i=g.clone(this.attributes));var m=g.extend({},j,{silent:!0});if(h&&!this.set(h,j.wait?m:j))return!1;var q=j,r=g.clone(j),p=this;p._refreshCache();a=c.Object._findUnsavedChildren(p.attributes);if(0<a.length)return c.Object.saveAll(a,{success:function(){p.save(null,q)},error:function(a){j.error&&j.error.apply(this,arguments)}}),this;r.success=function(a,b,d){b=p.parse(a,b,d);r.wait&&(b=g.extend(h||
{},b));p._finishSave(b);q.success?q.success(p,a):p.trigger("sync",p,a,r)};r.error=function(){p._cancelSave();q.error&&q.error.apply(this,arguments)};r.error=c.Object._wrapError(r.error,p,r);this._startSave();a=function(){var a=p.id?"PUT":"POST",b=p._getSaveJSON(),d="classes",f=p.className;"_User"===p.className&&!p.id&&(d="users",f=null);c._request(d,f,p.id,a,b,r);r.wait&&p.set(i,m)};return this._saving?(this._saveQueue=this._saveQueue||[],this._saveQueue.push(a)):(this._saving=!0,a()),this},destroy:function(a){var a=
a?g.clone(a):{},b=this,f=a.success,h=function(){b.trigger("destroy",b,b.collection,a)};if(!this.id)return h();a.success=function(c){a.wait&&h();f?f(b,c):b.trigger("sync",b,c,a)};a.error=c.Object._wrapError(a.error,b,a);c._request("classes",this.className,this.id,"DELETE",null,a);a.wait||h()},parse:function(a,b){var f=g.clone(a);return g(["createdAt","updatedAt"]).each(function(a){f[a]&&(f[a]=c._parseDate(f[a]))}),f.updatedAt||(f.updatedAt=f.createdAt),b&&(this._existed=201!==b.status),f},clone:function(){return new this.constructor(this.attributes)},
isNew:function(){return!this.id},change:function(a){var a=a||{},b=this._changing;this._changing=!0;var f=this;c._each(this._silent,function(a){f._pending[a]=!0});var h=g.extend({},a.changes,this._silent);this._silent={};c._each(h,function(b){f.trigger("change:"+b,f,f.get(b),a)});if(b)return this;for(b=function(a){!f._pending[a]&&!f._silent[a]&&delete f.changed[a]};!g.isEmpty(this._pending);)this._pending={},this.trigger("change",this,a),c._each(this.changed,b),f._previousAttributes=g.clone(this.attributes);
return this._changing=!1,this},existed:function(){return this._existed},hasChanged:function(a){return arguments.length?this._changed&&g.has(this._changed,a):!g.isEmpty(this._changed)},changedAttributes:function(a){if(!a)return this.hasChanged()?g.clone(this._changed):!1;var b={},f=this._previousAttributes;return c._each(a,function(a,c){g.isEqual(f[c],a)||(b[c]=a)}),b},previous:function(a){return!arguments.length||!this._previousAttributes?null:this._previousAttributes[a]},previousAttributes:function(){return g.clone(this._previousAttributes)},
isValid:function(){return!this.validate(this.attributes)},validate:function(a){return!g.has(a,"ACL")||a.ACL instanceof c.ACL?!1:new c.Error(c.Error.OTHER_CAUSE,"ACL must be a Parse.ACL.")},_validate:function(a,b){if(b.silent||!this.validate)return!0;var a=g.extend({},this.attributes,a),c=this.validate(a,b);return c?(b&&b.error?b.error(this,c,b):this.trigger("error",this,c,b),!1):!0},getACL:function(){return this.get("ACL")},setACL:function(a,b){return this.set("ACL",a,b)}});c.Object._getSubclass=
function(a){if(!g.isString(a))throw"Parse.Object._getSubclass requires a string argument.";var b=c.Object._classMap[a];return b||(b=c.Object.extend(a),c.Object._classMap[a]=b),b};c.Object._create=function(a,b,f){return new (c.Object._getSubclass(a))(b,f)};c.Object._classMap={};c.Object._extend=c._extend;c.Object.extend=function(a,b,f){if(!g.isString(a)){if(a&&g.has(a,"className"))return c.Object.extend(a.className,a,b);throw Error("Parse.Object.extend's first argument should be the className.");}"User"===
a&&(a="_User");var h=null;g.has(c.Object._classMap,a)?h=c.Object._classMap[a]._extend(b,f):(b=b||{},b.className=a,h=c.Object._extend(b,f));return h.extend=function(b){if(g.isString(b)||b&&g.has(b,"className"))return c.Object.extend.apply(h,arguments);var d=[a].concat(c._.toArray(arguments));return c.Object.extend.apply(h,d)},c.Object._classMap[a]=h,h};c.Object._wrapError=function(a,b,f){return function(h,g){h!==b&&(g=h);var i=new c.Error(-1,g.responseText);if(g.responseText){var m=JSON.parse(g.responseText);
m&&(i=new c.Error(m.code,m.error))}a?a(b,i,f):b.trigger("error",b,i,f)}};c.Object._findUnsavedChildren=function(a){var b=[];a instanceof c.Object?(a._refreshCache(),a.dirty()&&(b=[a]),b.push.apply(b,c.Object._findUnsavedChildren(a.attributes))):a instanceof c.Relation||(g.isArray(a)?g.each(a,function(a){b.push.apply(b,c.Object._findUnsavedChildren(a))}):g.isObject(a)&&c._each(a,function(a){b.push.apply(b,c.Object._findUnsavedChildren(a))}));return b}})(this);
(function(i){i.Parse=i.Parse||{};var c=i.Parse,g=c._;c.Role=c.Object.extend("_Role",{constructor:function(b,a){g.isString(b)&&a instanceof c.ACL?(c.Object.prototype.constructor.call(this,null,null),this.setName(b),this.setACL(a)):c.Object.prototype.constructor.call(this,b,a)},getName:function(){return this.get("name")},setName:function(b,a){return this.set("name",b,a)},getUsers:function(){return this.relation("users")},getRoles:function(){return this.relation("roles")},validate:function(b,a){if("name"in
b&&b.name!==this.getName()){var d=b.name;if(this.id&&this.id!==b.objectId)return new c.Error(c.Error.OTHER_CAUSE,"A role's name can only be set before it has been saved.");if(!g.isString(d))return new c.Error(c.Error.OTHER_CAUSE,"A role's name must be a String.");if(!/^[a-zA-Z\-_ ]+$/.test(d))return new c.Error(c.Error.OTHER_CAUSE,"A role's name can only contain alphanumeric characters, _, -, and spaces.")}return c.Object.prototype.validate?c.Object.prototype.validate.call(this,b,a):!1}})})(this);
(function(i){i.Parse=i.Parse||{};var c=i.Parse,g=c._;c.Collection=function(b,a){a=a||{};a.comparator&&(this.comparator=a.comparator);a.model&&(this.model=a.model);a.query&&(this.query=a.query);this._reset();this.initialize.apply(this,arguments);b&&this.reset(b,{silent:!0,parse:a.parse})};g.extend(c.Collection.prototype,c.Events,{model:c.Object,initialize:function(){},toJSON:function(){return this.map(function(b){return b.toJSON()})},add:function(b,a){var d,f,h,i,j,m={},q={},a=a||{},b=g.isArray(b)?
b.slice():[b];d=0;for(f=b.length;d<f;d++){b[d]=this._prepareModel(b[d],a);h=b[d];if(!h)throw Error("Can't add an invalid model to a collection");i=h.cid;if(m[i]||this._byCid[i])throw Error("Duplicate cid: can't add the same model to a collection twice");j=h.id;if(!c._isNullOrUndefined(j)&&(q[j]||this._byId[j]))throw Error("Duplicate id: can't add the same model to a collection twice");q[j]=h;m[i]=h}for(d=0;d<f;d++)(h=b[d]).on("all",this._onModelEvent,this),this._byCid[h.cid]=h,h.id&&(this._byId[h.id]=
h);this.length+=f;this.models.splice.apply(this.models,[a.at||this.models.length,0].concat(b));this.comparator&&this.sort({silent:!0});if(a.silent)return this;d=0;for(f=this.models.length;d<f;d++)h=this.models[d],m[h.cid]&&(a.index=d,h.trigger("add",h,this,a));return this},remove:function(b,a){var c,f,h,i,a=a||{},b=g.isArray(b)?b.slice():[b];c=0;for(f=b.length;c<f;c++)if(i=this.getByCid(b[c])||this.get(b[c]))delete this._byId[i.id],delete this._byCid[i.cid],h=this.indexOf(i),this.models.splice(h,
1),this.length--,a.silent||(a.index=h,i.trigger("remove",i,this,a)),this._removeReference(i);return this},get:function(b){return b&&this._byId[b.id||b]},getByCid:function(b){return b&&this._byCid[b.cid||b]},at:function(b){return this.models[b]},sort:function(b){b=b||{};if(!this.comparator)throw Error("Cannot sort a set without a comparator");var a=g.bind(this.comparator,this);return 1===this.comparator.length?this.models=this.sortBy(a):this.models.sort(a),b.silent||this.trigger("reset",this,b),this},
pluck:function(b){return g.map(this.models,function(a){return a.get(b)})},reset:function(b,a){var c=this;return b=b||[],a=a||{},g.each(this.models,function(a){c._removeReference(a)}),this._reset(),this.add(b,{silent:!0,parse:a.parse}),a.silent||this.trigger("reset",this,a),this},fetch:function(b){b=b?g.clone(b):{};void 0===b.parse&&(b.parse=!0);var a=this,d=b.success;b.success=function(c,h){b.add?a.add(c,b):a.reset(c,b);d&&d(a,h)};b.error=c.Object._wrapError(b.error,a,b);(this.query||new c.Query(this.model)).find(b)},
create:function(b,a){var c=this,a=a?g.clone(a):{},b=this._prepareModel(b,a);if(!b)return!1;a.wait||c.add(b,a);var f=a.success;return a.success=function(h,g){a.wait&&c.add(h,a);f?f(h,g):h.trigger("sync",b,g,a)},b.save(null,a),b},parse:function(b){return b},chain:function(){return g(this.models).chain()},_reset:function(){this.length=0;this.models=[];this._byId={};this._byCid={}},_prepareModel:function(b,a){b instanceof c.Object?b.collection||(b.collection=this):(a.collection=this,b=new this.model(b,
a),b._validate(b.attributes,a)||(b=!1));return b},_removeReference:function(b){this===b.collection&&delete b.collection;b.off("all",this._onModelEvent,this)},_onModelEvent:function(b,a,c,f){if("add"!==b&&"remove"!==b||c===this)"destroy"===b&&this.remove(a,f),a&&"change:objectId"===b&&(delete this._byId[a.previous("objectId")],this._byId[a.id]=a),this.trigger.apply(this,arguments)}});g.each("forEach each map reduce reduceRight find detect filter select reject every all some any include contains invoke max min sortBy sortedIndex toArray size first initial rest last without indexOf shuffle lastIndexOf isEmpty groupBy".split(" "),
function(b){c.Collection.prototype[b]=function(){return g[b].apply(g,[this.models].concat(g.toArray(arguments)))}});c.Collection.extend=c._extend})(this);
(function(i){i.Parse=i.Parse||{};var c=i.Parse,g=c._;c.View=function(a){this.cid=g.uniqueId("view");this._configure(a||{});this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents()};var b=/^(\S+)\s*(.*)$/,a="model collection el id attributes className tagName".split(" ");g.extend(c.View.prototype,c.Events,{tagName:"div",$:function(a){return this.$el.find(a)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this},make:function(a,
b,h){a=document.createElement(a);return b&&c.$(a).attr(b),h&&c.$(a).html(h),a},setElement:function(a,b){return this.$el=c.$(a),this.el=this.$el[0],!1!==b&&this.delegateEvents(),this},delegateEvents:function(a){if(a=a||c._getValue(this,"events")){this.undelegateEvents();var f=this;c._each(a,function(c,i){g.isFunction(c)||(c=f[a[i]]);if(!c)throw Error('Event "'+a[i]+'" does not exist');var j=i.match(b),m=j[1],j=j[2],c=g.bind(c,f),m=m+(".delegateEvents"+f.cid);""===j?f.$el.bind(m,c):f.$el.delegate(j,
m,c)})}},undelegateEvents:function(){this.$el.unbind(".delegateEvents"+this.cid)},_configure:function(b){this.options&&(b=g.extend({},this.options,b));var c=this;g.each(a,function(a){b[a]&&(c[a]=b[a])});this.options=b},_ensureElement:function(){if(this.el)this.setElement(this.el,!1);else{var a=c._getValue(this,"attributes")||{};this.id&&(a.id=this.id);this.className&&(a["class"]=this.className);this.setElement(this.make(this.tagName,a),!1)}}});c.View.extend=c._extend})(this);
(function(i){i.Parse=i.Parse||{};var c=i.Parse,g=c._;c.User=c.Object.extend("_User",{_isCurrentUser:!1,_mergeMagicFields:function(b){b.sessionToken&&(this._sessionToken=b.sessionToken,delete b.sessionToken);c.User.__super__._mergeMagicFields.call(this,b)},_cleanupAuthData:function(){if(this.isCurrent()){var b=this.get("authData");b&&g.each(this.get("authData"),function(a,c){b[c]||delete b[c]})}},_synchronizeAllAuthData:function(){if(this.get("authData")){var b=this;g.each(this.get("authData"),function(a,
c){b._synchronizeAuthData(c)})}},_synchronizeAuthData:function(b){if(this.isCurrent()){var a;g.isString(b)?(a=b,b=c.User._authProviders[a]):a=b.getAuthType();var d=this.get("authData");d&&b&&(b.restoreAuthentication(d[a])||this._unlinkFrom(b))}},_handleSaveResult:function(b){b&&(this._isCurrentUser=!0);this._cleanupAuthData();this._synchronizeAllAuthData();delete this._serverData.password;this._rebuildEstimatedDataForKey("password");this._refreshCache();(b||this.isCurrent())&&c.User._saveCurrentUser(this)},
_linkWith:function(b,a){var d;g.isString(b)?(d=b,b=c.User._authProviders[b]):d=b.getAuthType();if(g.has(a,"authData")){var f=this.get("authData")||{};f[d]=a.authData;this.set("authData",f);d=g.clone(a);return d.success=function(b){b._handleSaveResult(!0);a.success&&a.success.apply(this,arguments)},this.save({authData:f},d)}var h=this;return b.authenticate({success:function(b,c){h._linkWith(b,{authData:c,success:a.success,error:a.error})},error:function(b,c){a.error&&a.error(h,c)}})},_unlinkFrom:function(b,
a){g.isString(b)?b=c.User._authProviders[b]:b.getAuthType();var d=g.clone(a),f=this;return d.authData=null,d.success=function(c){f._synchronizeAuthData(b);a.success&&a.success.apply(this,arguments)},this._linkWith(b,d)},_isLinked:function(b){var a;g.isString(b)?a=b:a=b.getAuthType();return!!(this.get("authData")||{})[a]},_logOutWithAll:function(){if(this.get("authData")){var b=this;g.each(this.get("authData"),function(a,c){b._logOutWith(c)})}},_logOutWith:function(b){this.isCurrent()&&(g.isString(b)&&
(b=c.User._authProviders[b]),b&&b.deauthenticate&&b.deauthenticate())},signUp:function(b,a){var d,f=b&&b.username||this.get("username");if(!f||""===f)return a&&a.error&&(d=new c.Error(c.Error.OTHER_CAUSE,"Cannot sign up user with an empty name."),a.error(this,d)),!1;f=b&&b.password||this.get("password");if(!f||""===f)return a&&a.error&&(d=new c.Error(c.Error.OTHER_CAUSE,"Cannot sign up user with an empty password."),a.error(this,d)),!1;d=g.clone(a);return d.success=function(b){b._handleSaveResult(!0);
a.success&&a.success.apply(this,arguments)},this.save(b,d)},logIn:function(b){var a=this,d=g.clone(b);d.success=function(c,g,i){g=a.parse(c,g,i);a._finishFetch(g);a._handleSaveResult(!0);b.success?b.success(a,c):a.trigger("sync",a,c,d)};d.error=c.Object._wrapError(b.error,a,d);c._request("login",null,null,"GET",this.toJSON(),d)},save:function(b,a,d){var f,h;g.isObject(b)||g.isNull(b)||g.isUndefined(b)?(f=b,h=a):(f={},f[b]=a,h=d);b=g.clone(h);return b.success=function(a){a._handleSaveResult(!1);h.success&&
h.success.apply(this,arguments)},c.Object.prototype.save.call(this,f,b)},fetch:function(b){var a=g.clone(b);return a.success=function(a){a._handleSaveResult(!1);b.success&&b.success.apply(this,arguments)},c.Object.prototype.fetch.call(this,a)},isCurrent:function(){return this._isCurrentUser},getUsername:function(){return this.get("username")},setUsername:function(b,a){return this.set("username",b,a)},setPassword:function(b,a){return this.set("password",b,a)},getEmail:function(){return this.get("email")},
setEmail:function(b,a){return this.set("email",b,a)}},{_currentUser:null,_currentUserMatchesDisk:!1,_CURRENT_USER_KEY:"currentUser",_authProviders:{},signUp:function(b,a,d,f){d=d||{};d.username=b;d.password=a;return c.Object._create("_User").signUp(d,f)},logIn:function(b,a,d){var f=c.Object._create("_User");f._finishFetch({username:b,password:a});f.logIn(d)},logOut:function(){null!==c.User._currentUser&&(c.User._currentUser._logOutWithAll(),c.User._currentUser._isCurrentUser=!1);c.User._currentUserMatchesDisk=
!0;c.User._currentUser=null;localStorage.removeItem(c._getParsePath(c.User._CURRENT_USER_KEY))},requestPasswordReset:function(b,a){var d={email:b};a.error=c.Query._wrapError(a.error,a);c._request("requestPasswordReset",null,null,"POST",d,a)},current:function(){if(c.User._currentUser||c.User._currentUserMatchesDisk)return c.User._currentUser;c.User._currentUserMatchesDisk=!0;var b=localStorage.getItem(c._getParsePath(c.User._CURRENT_USER_KEY));if(!b)return null;c.User._currentUser=new c.Object._create("_User");
c.User._currentUser._isCurrentUser=!0;b=JSON.parse(b);return c.User._currentUser.id=b._id,delete b._id,c.User._currentUser._sessionToken=b._sessionToken,delete b._sessionToken,c.User._currentUser.set(b),c.User._currentUser._synchronizeAllAuthData(),c.User._currentUser._refreshCache(),c.User._currentUser._dirty={},c.User._currentUser},_saveCurrentUser:function(b){c.User._currentUser!==b&&c.User.logOut();b._isCurrentUser=!0;c.User._currentUser=b;c.User._currentUserMatchesDisk=!0;var a=b.toJSON();a._id=
b.id;a._sessionToken=b._sessionToken;localStorage.setItem(c._getParsePath(c.User._CURRENT_USER_KEY),JSON.stringify(a))},_registerAuthenticationProvider:function(b){c.User._authProviders[b.getAuthType()]=b;c.User.current()&&c.User.current()._synchronizeAuthData(b.getAuthType())},_logInWith:function(b,a){return(new c.User)._linkWith(b,a)}})})(this);
(function(i){i.Parse=i.Parse||{};var c=i.Parse,g=c._;c.Query=function(b){g.isString(b)&&(b=c.Object._getSubclass(b));this.objectClass=b;this.className=b.prototype.className;this._where={};this._include=[];this._limit=-1;this._skip=0};c.Query.prototype={get:function(b,a){var d=a.success||function(){},f=a.error||function(){};this.equalTo("objectId",b);this.first({error:function(a){f(null,a)},success:function(a){a?d(a):f(null,new c.Error(c.Error.OBJECT_NOT_FOUND,"Object not found."))}})},toJSON:function(){var b=
{where:this._where};return 0<this._include.length&&(b.include=this._include.join(",")),0<=this._limit&&(b.limit=this._limit),0<this._skip&&(b.skip=this._skip),void 0!==this._order&&(b.order=this._order),b},find:function(b){var a=this,d=b.success||function(){},f={error:b.error,success:function(b){d(g.map(b.results,function(b){var c=new a.objectClass;return c._finishFetch(b,!0),c}))}},h=this.toJSON();f.error=c.Query._wrapError(b.error,f);c._request("classes",this.className,null,"GET",h,f)},count:function(b){var a=
b.success||function(){},d={error:b.error,success:function(b){a(b.count)}},f=this.toJSON();f.limit=0;f.count=1;d.error=c.Query._wrapError(b.error,d);c._request("classes",this.className,null,"GET",f,d)},first:function(b){var a=this,d=b.success||function(){},f={error:b.error,success:function(b){d(g.map(b.results,function(b){var c=new a.objectClass;return c._finishFetch(b,!0),c})[0])}},h=this.toJSON();h.limit=1;f.error=c.Query._wrapError(b.error,f);c._request("classes",this.className,null,"GET",h,f)},
collection:function(b,a){return a=a||{},new c.Collection(b,g.extend(a,{model:this.objectClass,query:this}))},skip:function(b){return this._skip=b,this},limit:function(b){return this._limit=b,this},equalTo:function(b,a){return this._where[b]=c._encode(a),this},_addCondition:function(b,a,d){return this._where[b]||(this._where[b]={}),this._where[b][a]=c._encode(d),this},notEqualTo:function(b,a){return this._addCondition(b,"$ne",a),this},lessThan:function(b,a){return this._addCondition(b,"$lt",a),this},
greaterThan:function(b,a){return this._addCondition(b,"$gt",a),this},lessThanOrEqualTo:function(b,a){return this._addCondition(b,"$lte",a),this},greaterThanOrEqualTo:function(b,a){return this._addCondition(b,"$gte",a),this},containedIn:function(b,a){return this._addCondition(b,"$in",a),this},notContainedIn:function(b,a){return this._addCondition(b,"$nin",a),this},exists:function(b){return this._addCondition(b,"$exists",!0),this},doesNotExist:function(b){return this._addCondition(b,"$exists",!1),this},
matches:function(b,a,c){return this._addCondition(b,"$regex",a),c||(c=""),a.ignoreCase&&(c+="i"),a.multiline&&(c+="m"),c&&c.length&&this._addCondition(b,"$options",c),this},matchesQuery:function(b,a){var c=a.toJSON();return c.className=a.className,this._addCondition(b,"$inQuery",c),this},doesNotMatchQuery:function(b,a){var c=a.toJSON();return c.className=a.className,this._addCondition(b,"$notInQuery",c),this},matchesKeyInQuery:function(b,a,c){var f=c.toJSON();return f.className=c.className,this._addCondition(b,
"$select",{key:a,query:f}),this},_quote:function(b){return"\\Q"+b.replace("\\E","\\E\\\\E\\Q")+"\\E"},contains:function(b,a){return this._addCondition(b,"$regex",this._quote(a)),this},startsWith:function(b,a){return this._addCondition(b,"$regex","^"+this._quote(a)),this},endsWith:function(b,a){return this._addCondition(b,"$regex",this._quote(a)+"$"),this},ascending:function(b){return this._order=b,this},descending:function(b){return this._order="-"+b,this},near:function(b,a){return a instanceof c.GeoPoint||
(a=new c.GeoPoint(a)),this._addCondition(b,"$nearSphere",a),this},withinRadians:function(b,a,c){return this.near(b,a),this._addCondition(b,"$maxDistance",c),this},withinMiles:function(b,a,c){return this.withinRadians(b,a,c/3958.8)},withinKilometers:function(b,a,c){return this.withinRadians(b,a,c/6371)},withinGeoBox:function(b,a,d){return a instanceof c.GeoPoint||(a=new c.GeoPoint(a)),d instanceof c.GeoPoint||(d=new c.GeoPoint(d)),this._addCondition(b,"$within",{$box:[a,d]}),this},include:function(b){return g.isArray(b)?
this._include=this._include.concat(b):this._include.push(b),this}};c.Query._wrapError=function(b,a){return function(d){if(b){var f=new c.Error(-1,d.responseText);d.responseText&&(d=JSON.parse(d.responseText))&&(f=new c.Error(d.code,d.error));b(f,a)}}}})(this);
(function(i){i.Parse=i.Parse||{};var c=i.Parse,g=!1,b,a={authenticate:function(a){var c=this;FB.login(function(b){b.authResponse?a.success&&a.success(c,{id:b.authResponse.userID,access_token:b.authResponse.accessToken,expiration_date:(new Date(1E3*b.authResponse.expiresIn+(new Date).getTime())).toJSON()}):a.error&&a.error(c,b)},{scope:b})},restoreAuthentication:function(a){var b;return a?b={userID:a.id,accessToken:a.access_token,expiresIn:(c._parseDate(a.expiration_date).getTime()-(new Date).getTime())/
1E3}:b={userID:null,accessToken:null,expiresIn:null},FB.Auth.setAuthResponse(b),a||FB.logout(),!0},getAuthType:function(){return"facebook"},deauthenticate:function(){this.restoreAuthentication(null)}};c.FacebookUtils={init:function(b){if("undefined"==typeof FB)throw"The Javascript Facebook SDK must be loaded before calling init.";FB.init(b);c.User._registerAuthenticationProvider(a);g=!0},isLinked:function(a){return a._isLinked("facebook")},logIn:function(a,f){if(!g)throw"You must initialize FacebookUtils before calling logIn.";
return b=a,c.User._logInWith("facebook",f)},link:function(a,c,h){if(!g)throw"You must initialize FacebookUtils before calling link.";return b=c,a._linkWith("facebook",h)},unlink:function(a,b){if(!g)throw"You must initialize FacebookUtils before calling unlink.";return a._unlinkFrom("facebook",b)}}})(this);
(function(i){i.Parse=i.Parse||{};var c=i.Parse,g=c._;c.History=function(){this.handlers=[];g.bindAll(this,"checkUrl")};var b=/^[#\/]/,a=/msie [\w.]+/;c.History.started=!1;g.extend(c.History.prototype,c.Events,{interval:50,getHash:function(a){return(a=(a?a.location:window.location).href.match(/#(.*)$/))?a[1]:""},getFragment:function(a,f){if(c._isNullOrUndefined(a))if(this._hasPushState||f){var a=window.location.pathname,g=window.location.search;g&&(a+=g)}else a=this.getHash();return a.indexOf(this.options.root)||
(a=a.substr(this.options.root.length)),a.replace(b,"")},start:function(d){if(c.History.started)throw Error("Parse.history has already been started");c.History.started=!0;this.options=g.extend({},{root:"/"},this.options,d);this._wantsHashChange=!1!==this.options.hashChange;this._wantsPushState=!!this.options.pushState;this._hasPushState=!(!this.options.pushState||!window.history||!window.history.pushState);var d=this.getFragment(),f=document.documentMode;(f=a.exec(navigator.userAgent.toLowerCase())&&
(!f||7>=f))&&(this.iframe=c.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(d));this._hasPushState?c.$(window).bind("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!f?c.$(window).bind("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=window.setInterval(this.checkUrl,this.interval));this.fragment=d;d=window.location;f=d.pathname===this.options.root;if(this._wantsHashChange&&this._wantsPushState&&
!this._hasPushState&&!f)return this.fragment=this.getFragment(null,!0),window.location.replace(this.options.root+"#"+this.fragment),!0;this._wantsPushState&&this._hasPushState&&f&&d.hash&&(this.fragment=this.getHash().replace(b,""),window.history.replaceState({},document.title,d.protocol+"//"+d.host+this.options.root+this.fragment));if(!this.options.silent)return this.loadUrl()},stop:function(){c.$(window).unbind("popstate",this.checkUrl).unbind("hashchange",this.checkUrl);window.clearInterval(this._checkUrlInterval);
c.History.started=!1},route:function(a,b){this.handlers.unshift({route:a,callback:b})},checkUrl:function(){var a=this.getFragment();a===this.fragment&&this.iframe&&(a=this.getFragment(this.getHash(this.iframe)));if(a===this.fragment)return!1;this.iframe&&this.navigate(a);this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(a){var b=this.fragment=this.getFragment(a);return g.any(this.handlers,function(a){if(a.route.test(b))return a.callback(b),!0})},navigate:function(a,f){if(!c.History.started)return!1;
if(!f||!0===f)f={trigger:f};var g=(a||"").replace(b,"");this.fragment!==g&&(this._hasPushState?(0!==g.indexOf(this.options.root)&&(g=this.options.root+g),this.fragment=g,window.history[f.replace?"replaceState":"pushState"]({},document.title,g)):this._wantsHashChange?(this.fragment=g,this._updateHash(window.location,g,f.replace),this.iframe&&g!==this.getFragment(this.getHash(this.iframe))&&(f.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,g,f.replace))):window.location.assign(this.options.root+
a),f.trigger&&this.loadUrl(a))},_updateHash:function(a,b,c){c?(c=a.toString().replace(/(javascript:|#).*$/,""),a.replace(c+"#"+b)):a.hash=b}})})(this);
(function(i){i.Parse=i.Parse||{};var c=i.Parse,g=c._;c.Router=function(a){a=a||{};a.routes&&(this.routes=a.routes);this._bindRoutes();this.initialize.apply(this,arguments)};var b=/:\w+/g,a=/\*\w+/g,d=/[\-\[\]{}()+?.,\\\^\$\|#\s]/g;g.extend(c.Router.prototype,c.Events,{initialize:function(){},route:function(a,b,d){return c.history=c.history||new c.History,g.isRegExp(a)||(a=this._routeToRegExp(a)),d||(d=this[b]),c.history.route(a,g.bind(function(g){g=this._extractParameters(a,g);d&&d.apply(this,g);
this.trigger.apply(this,["route:"+b].concat(g));c.history.trigger("route",this,b,g)},this)),this},navigate:function(a,b){c.history.navigate(a,b)},_bindRoutes:function(){if(this.routes){var a=[],b;for(b in this.routes)this.routes.hasOwnProperty(b)&&a.unshift([b,this.routes[b]]);b=0;for(var c=a.length;b<c;b++)this.route(a[b][0],a[b][1],this[a[b][1]])}},_routeToRegExp:function(c){return c=c.replace(d,"\\$&").replace(b,"([^/]+)").replace(a,"(.*?)"),RegExp("^"+c+"$")},_extractParameters:function(a,b){return a.exec(b).slice(1)}});
c.Router.extend=c._extend})(this);L.Control.FullScreen=L.Control.extend({options:{position:"topleft"},onAdd:function(i){var c,g;i.zoomControl?(g=i.zoomControl._container,c="-fullscreen last"):(g=L.DomUtil.create("div","leaflet-control-zoom"),c="-fullscreen");this._createButton("Full Screen","leaflet-control-zoom"+c,g,this.toogleFullScreen,i);return g},_createButton:function(i,c,g,b,a){c=L.DomUtil.create("a",c,g);c.href="#";c.title=i;L.DomEvent.addListener(c,"click",L.DomEvent.stopPropagation).addListener(c,"click",L.DomEvent.preventDefault).addListener(c,
"click",b,a);L.DomEvent.addListener(g,fullScreenApi.fullScreenEventName,L.DomEvent.stopPropagation).addListener(g,fullScreenApi.fullScreenEventName,L.DomEvent.preventDefault).addListener(g,fullScreenApi.fullScreenEventName,this._handleEscKey,a);L.DomEvent.addListener(document,fullScreenApi.fullScreenEventName,L.DomEvent.stopPropagation).addListener(document,fullScreenApi.fullScreenEventName,L.DomEvent.preventDefault).addListener(document,fullScreenApi.fullScreenEventName,this._handleEscKey,a);return c},
toogleFullScreen:function(){this._exitFired=!1;if(fullScreenApi.supportsFullScreen){var i=this._container;fullScreenApi.isFullScreen(i)?(fullScreenApi.cancelFullScreen(i),this.fire("exitFullscreen"),this._exitFired=!0):(fullScreenApi.requestFullScreen(i),this.fire("enterFullscreen"))}},_handleEscKey:function(){!fullScreenApi.isFullScreen(this)&&!this._exitFired&&(this.fire("exitFullscreen"),this._exitFired=!0)}});
(function(){var i={supportsFullScreen:!1,isFullScreen:function(){return!1},requestFullScreen:function(){},cancelFullScreen:function(){},fullScreenEventName:"",prefix:""},c=["webkit","moz","o","ms","khtml"];if("undefined"!=typeof document.cancelFullScreen)i.supportsFullScreen=!0;else for(var g=0,b=c.length;g<b;g++)if(i.prefix=c[g],"undefined"!=typeof document[i.prefix+"CancelFullScreen"]){i.supportsFullScreen=!0;break}i.supportsFullScreen&&(i.fullScreenEventName=i.prefix+"fullscreenchange",i.isFullScreen=
function(){switch(this.prefix){case "":return document.fullScreen;case "webkit":return document.webkitIsFullScreen;default:return document[this.prefix+"FullScreen"]}},i.requestFullScreen=function(a){return""===this.prefix?a.requestFullScreen():a[this.prefix+"RequestFullScreen"]()},i.cancelFullScreen=function(){return""===this.prefix?document.cancelFullScreen():document[this.prefix+"CancelFullScreen"]()});"undefined"!=typeof jQuery&&(jQuery.fn.requestFullScreen=function(){return this.each(function(){var a=
jQuery(this);i.supportsFullScreen&&i.requestFullScreen(a)})});window.fullScreenApi=i})();
